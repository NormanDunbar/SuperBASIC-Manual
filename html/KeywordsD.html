<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html xmlns:v="urn:schemas-microsoft-com:vml">
  <head>
    <meta http-equiv="content-type" content="text/html;
      charset=ISO-8859-1">
    <link rel="stylesheet" type="text/css" href="css/QLManualStyle.css" media="all" />
    <title>Sinclair QL SuperBASIC/SBASIC Reference Manual - Keywords D</title>
</head>
<body>
<div id="header">
  SBASIC/SuperBASIC Reference Manual Online (c) RWAP Software
  <br />
  The Online Guide to programming the Sinclair QL Home Computer in SuperBASIC
</div>
<div id="sideBar">
    <ul>
        <li><a href="Foreword.html">Foreword</a></li>
        <li><a href="Introduction.html">Introduction</a></li>
        <li><a href="Credits.html">Credits</a></li>        
        <li><a href="Structure.html">Structure</a></li>
        <li><a href="WritingPrograms.html">Writing Programs</a></li>
        <hr></hr>
        <li><a href="KeywordsA.html">Keywords - A</a></li>
        <li><a href="KeywordsB.html">Keywords - B</a></li>
        <li><a href="KeywordsC.html">Keywords - C</a></li>
        <li><a href="KeywordsD.html">Keywords - D</a></li>
        <li><a href="KeywordsE.html">Keywords - E</a></li>
        <li><a href="KeywordsF.html">Keywords - F</a></li>
        <li><a href="KeywordsG.html">Keywords - G</a></li>
        <li><a href="KeywordsH.html">Keywords - H</a></li>
        <li><a href="KeywordsI.html">Keywords - I</a></li>
        <li><a href="KeywordsJ.html">Keywords - J</a></li>
        <li><a href="KeywordsK.html">Keywords - K</a></li>
        <li><a href="KeywordsL.html">Keywords - L</a></li>
        <li><a href="KeywordsM.html">Keywords - M</a></li>
        <li><a href="KeywordsN.html">Keywords - N</a></li>
        <li><a href="KeywordsO.html">Keywords - O</a></li>
        <li><a href="KeywordsP.html">Keywords - P</a></li>
        <li><a href="KeywordsQ.html">Keywords - Q</a></li>
        <li><a href="KeywordsR.html">Keywords - R</a></li>
        <li><a href="KeywordsS.html">Keywords - S</a></li>
        <li><a href="KeywordsT.html">Keywords - T</a></li>
        <li><a href="KeywordsU.html">Keywords - U</a></li>
        <li><a href="KeywordsV.html">Keywords - V</a></li>
        <li><a href="KeywordsW.html">Keywords - W</a></li>
        <li><a href="KeywordsX.html">Keywords - X</a></li>
        <li><a href="KeywordsY.html">Keywords - Y</a></li>
        <li><a href="KeywordsZ.html">Keywords - Z</a></li>
        <li><a href="Keywords_.html">Keywords - Other</a></li>
        <hr></hr>
        <li><a href="AppendicesIntro.html">Appendices Introduction</a></li>
        <li><a href="Appendix01.html">Appendix 1 - Minerva</a></li>
        <li><a href="Appendix02.html">Appendix 2 - SMSQE</a></li>
        <li><a href="Appendix03.html">Appendix 3 - Emulators</a></li>
        <li><a href="Appendix04.html">Appendix 4 - THOR Computers</a></li>
        <li><a href="Appendix05.html">Appendix 5 - Expansion Boards</a></li>
        <li><a href="Appendix06.html">Appendix 6 - Compatability</a></li>
        <li><a href="Appendix07.html">Appendix 7 - Multiple BASICs</a></li>
        <li><a href="Appendix08.html">Appendix 8 - Error Messages</a></li>
        <li><a href="Appendix09.html">Appendix 9 - Character Set / Keyboard</a></li>
        <li><a href="Appendix10.html">Appendix 10 - Fonts</a></li>
        <li><a href="Appendix11.html">Appendix 11 - Mathematics</a></li>
        <li><a href="Appendix12.html">Appendix 12 - Device Drivers</a></li>
        <li><a href="Appendix13.html">Appendix 13 - Extended Pointer Environment</a></li>
        <li><a href="Appendix14.html">Appendix 14 - Coercion</a></li>
        <li><a href="Appendix15.html">Appendix 15 - Mouse Drivers</a></li>
        <li><a href="Appendix16.html">Appendix 16 - The QL Display</a></li>
        <li><a href="Appendix17.html">Appendix 17 - Networks</a></li>
        <li><a href="Appendix18.html">Appendix 18 - Configuring Programs</a></li>
    </ul>
</div>
<div id="mainText">
<h1><a name="DATA"></a>DATA</h1><br>Syntax: <span style="font-style: italic;">DATA expression</span> <sup>*</sup>[<span style="font-style: italic;">,expression</span>]<sup>*
<br></sup>Location: <span style="font-style: italic;">QL ROM
<br></span><br>The QL allows a SuperBASIC program to store a set of data
<br>in the program itself, which can then be assigned to a given
<br>variable by the <span style="font-style: italic;">READ</span> command.  The <span style="font-style: italic;">DATA</span> statement marks these
<br>areas for use by <span style="font-style: italic;">READ</span>.
<br><br>The information which can be stored at a <span style="font-style: italic;">DATA</span> statement is
<br>basically  anything  which  can  be  stored  in  a  variable,
<br>including strings, variables, constants and expressions.
<br><br>Expressions will be calculated at the time that the item in
<br>question is <span style="font-style: italic;">READ</span>.
<br><br>Whilst a program is running, unless a <span style="font-style: italic;">READ</span> command is found,
<br><span style="font-style: italic;">DATA</span> statements are ignored.
<br><br><h3>Example:
<br></h3><span style="font-style: italic;">1000 DATA "QL User",100,x*1000+10
<br></span><h3><br>NOTE 1:
<br></h3><br>On Pre MG ROMs, if any values in a <span style="font-style: italic;">DATA</span> statement start with
<br>a bracket, then the other items on the line may be ignored.
<br>If you must specify items starting with brackets, use for
<br>example:
<br><br><span style="font-style: italic;">DATA 0+(...
<br></span><br>This is fixed by MG ROMs, Minerva and SMS.
<br><br><h3>NOTE 2:
<br></h3><br>Unless you have a Minerva ROM (v1.77 or later) or SMS, when
<br>you enter the <span style="font-style: italic;">DATA</span> statement, you will always need to type a
<br>space after the word <span style="font-style: italic;">DATA</span> as the parser will not automatically
<br>insert one.
<br><br>On later implementations a space is automatically inserted
<br>where the first <span style="font-style: italic;">DATA</span> expression is a string, eg.<span style="font-style: italic;"> DATA'Hello'</span>.
<br><br><h3>NOTE 3:
<br></h3><br>Entering a <span style="font-style: italic;">DATA</span> statement as a direct command from #0 has no
<br>effect.  Under SMS an error is reported 'DATA in command line
<br>has no meaning'.
<br><br><h3>NOTE 4:
<br></h3><br>Due to the way in which the interpreter works, it is always
<br>more efficient to place <span style="font-style: italic;">DATA</span> statements at the start of a
<br>program (the search function always starts at the first line
<br>of the program).
<br><br><h3>NOTE 5:
<br></h3><br>Various SuperBASIC compilers (such as Turbo) do not support
<br>expressions in <span style="font-style: italic;">DATA</span> statements.
<br><br><h3>NOTE 6:
<br></h3><br>There appears to be no real check on the parameters given
<br>for <span style="font-style: italic;">DATA</span>, so the following line can be entered, but will in fact
<br>cause an error when you try to <span style="font-style: italic;">READ</span> it:
<br><br><span style="font-style: italic;">10 DATA 1000,PRINT,10
<br></span><br>SMS's improved interpreter does do more checks than earlier
<br>implementations and will prevent you from entering the line:
<br><br><span style="font-style: italic;">10 DATA 1,1,2a,3
<br></span><br>which other implementations allow (but give an error when
<br>they try to <span style="font-style: italic;">READ</span> the line).
<br><br><h3>NOTE 7:
<br></h3><br>SMS may complain if you create numerous DATA statements
<br>inside a <span style="font-style: italic;">DEFine PROCedure</span> or <span style="font-style: italic;">DEFine FuNction</span> struture.
<br><br><h3>CROSS-REFERENCE:<br></h3><br><a style="font-style: italic;" href="KeywordsR.html#RESTORE">RESTORE</a> allows you to set the current <a style="font-style: italic;" href="KeywordsD.html#DATA">DATA</a> pointer.
<br><br><a style="font-style: italic;" href="KeywordsR.html#READ">READ</a> will assign the value at the current <a style="font-style: italic;" href="KeywordsD.html#DATA">DATA</a> pointer to the
<br>given variable.
<br><br><a style="font-style: italic;" href="KeywordsE.html#EOF">EOF</a> will return the value one if there are no more <a style="font-style: italic;" href="KeywordsD.html#DATA">DATA
</a>statements in the current program.
<br><hr style="width: 100%; height: 2px;"><h1><a name="DATAD$"></a>DATAD$</h1><br>Syntax: <span style="font-style: italic;">DATAD$
<br></span>Location: <span style="font-style: italic;">Toolkit II
<br></span><br>This function always contains the current default data
<br>device, which is an unofficial QDOS standard and supported by
<br>all Toolkit II extensions, original SuperBASIC commands and
<br>most good software.
<br><br>The default device means that if no other device is stated,
<br>if appropriate, this device will be used. The default data
<br>device will also be consulted if a device name is supplied but
<br>the given file cannot be found on that device.  For example,
<br>assuming that <span style="font-style: italic;">DATAD$='flp2_'</span>, if you enter <span style="font-style: italic;">VIEW ram1_example_txt</span> and the
<br>file <span style="font-style: italic;">example_txt</span> is not present on <span style="font-style: italic;">ram1_</span>, the command will then try
<br><span style="font-style: italic;">flp2_ram1_example_txt</span>.
<br><br>This  idea  can  be  extended  to  use  prefixes  as
<br>sub-directories. Sub-directories are separated by underscores,
<br><span style="font-style: italic;">DATAD$</span> always ends with an underscore.
<br><br><h3>Example:
<br></h3><br>TK2DIR reads all files from the current default data device
<br><br>via a pipe, strips off any network sub-directory prefix and
<br><br>then writes the remainder of the filenames into the string
<br><br>array passed by parameter.
<br><span style="font-style: italic;">100 DEFine PROCedure TK2DIR (Verz$)
<br>110  LOCal e,n,sd$,sd,us
<br>120  sd$=DATAD$: us="_" INSTR sd$
<br>130  IF us=3 AND LEN(sd$)>3 and sd$(1)="n" THEN
<br>140   IF sd$(2) INSTR "12345678":sd$=sd$(4 TO):us="_" INSTR sd$
<br>160  END IF
<br>170  OPEN#4,pipe_10000: STAT#4: WDIR#4
<br>180  e=FILE_OPEN(#3,pipe_,CHANID(#4)): CLOSE#4
<br>200  INPUT#3,Verz$(0)
<br>210  FOR n=1 TO DIMN(Verz$)
<br>220    IF EOF(#3) THEN EXIT n
<br>230    INPUT#3,Verz$(n)
<br>240    Verz$(n)=Verz$(n)(us+1 TO)
<br>250  END FOR n
<br>260  CLOSE#3
<br>270 END DEFine TK2DIR
<br></span><br><span style="font-style: italic;">DIM file$(20,30)
<br><br>TK2DIR file$
<br><br>CLS: PRINT file$
<br></span><br>Here only the first 20 files will be read into file$.
<br><br>NB. This would require substantial amendment to make it
<br><br>search sub-directories also.
<br><br><h3>CROSS-REFERENCE:<br></h3><br><a style="font-style: italic;" href="KeywordsD.html#DATA_USE">DATA_USE</a> defines the default device; <a style="font-style: italic;" href="KeywordsD.html#DUP">DUP</a>, <a style="font-style: italic;" href="KeywordsD.html#DDOWN">DDOWN</a> and <a style="font-style: italic;" href="KeywordsD.html#DNEXT">DNEXT</a> allow
<br>you to move around the sub-directory tree.
<br><br><a style="font-style: italic;" href="KeywordsP.html#PROGD$">PROGD$</a> returns the default program device.
<br><br><a style="font-style: italic;" href="KeywordsD.html#DLIST">DLIST</a> prints all default devices.
<br><hr style="width: 100%; height: 2px;"><h1><a name="DATAREG"></a>DATAREG</h1><br>Syntax: <span style="font-style: italic;">DATAREG </span>[<span style="font-style: italic;">number</span>]<span style="font-style: italic;">number=0...3
<br></span>Location: <span style="font-style: italic;">TRAPS (DIY Toolkit Vol T)
<br></span><br>This function returns the value of the Machine code data
<br>register <span style="font-style: italic;">number</span> (default 0) following the completion of a <span style="font-style: italic;">MTRAP</span>,
<br><span style="font-style: italic;">QTRAP</span> or <span style="font-style: italic;">BTRAP</span> command.
<br><br>Because the default data register <span style="font-style: italic;">number</span> is 0:
<br><br><span style="font-style: italic;">PRINT DATAREG
<br></span><br>will be 0 if no error occured during the TRAP call or else
<br>the relevant error code.
<br><br><span style="font-style: italic;">Number</span> will let you read the value of the relevant data
<br>register D0, D1, D2 or D3.
<br><br><h3>CROSS-REFERENCE:<br></h3><br><a style="font-style: italic;" href="KeywordsA.html#ADDREG">ADDREG</a> allows you to read machine code address registers -
<br>see this for an example of <a style="font-style: italic;" href="KeywordsD.html#DATREG">DATREG</a>.
<br><br>See <a style="font-style: italic;" href="KeywordsM.html#MTRAP">MTRAP</a>, <a style="font-style: italic;" href="KeywordsQ.html#QTRAP">QTRAP</a> and <a style="font-style: italic;" href="KeywordsB.html#BTRAP">BTRAP</a>.
<br><hr style="width: 100%; height: 2px;"><h1><a name="DATASPACE"></a>DATASPACE</h1><br>Syntax: <span style="font-style: italic;">DATASPACE (file$)
<br></span>Location: <span style="font-style: italic;">Turbo Toolkit
<br></span><br>This function returns the amount of dataspace which has
<br>been set aside for the given <span style="font-style: italic;">file$</span>.  It is therefore similar to
<br><span style="font-style: italic;">FDAT</span> and <span style="font-style: italic;">FILE_DAT</span>.  Default devices are not supported, however
<br>errors are not reported.
<br><br>The following error values may also be returned by the
<br>function:
<br><br>-2The file is not executable
<br><br>-3 or -6 Insufficient memory to open file
<br><br>-7File does not exist
<br><br>-9Device or file is being written to by something
<br>else.
<br><br>-12The device is valid, but the filename is not
<br><br>-16Bad or changed medium error
<br><br><h3>Example:
<br></h3><br><span style="font-style: italic;">PRINT DATASPACE('win1_start_QD_exe')
<br></span><br><h3>CROSS-REFERENCE:<br></h3><br><a style="font-style: italic;" href="KeywordsD.html#DATA_AREA">DATA_AREA</a> allows you to set the dataspace for a compiled
<br>program.
<br><br>See also <a style="font-style: italic;" href="KeywordsF.html#FDAT">FDAT</a>.
<br><hr style="width: 100%; height: 2px;"><h1><a name="DATA_AREA"></a>DATA_AREA</h1><br>Syntax: <span style="font-style: italic;">DATA_AREA size</span> <span style="font-style: italic;">size=0...850
<br></span>Location: <span style="font-style: italic;">Turbo Toolkit
<br></span><br>This command is only used by the Turbo compiler and should
<br>be located at the start of your program before any active
<br>program lines.
<br><br>The command specifies how much dataspace (<span style="font-style: italic;">size</span> kilobytes)
<br>should be specified for the compiled program.  This dataspace
<br>is used by a task for stack space and a temporary store whilst
<br>it is running.
<br><br><h3>Example:
<br></h3><br><span style="font-style: italic;">10 DATA_AREA 32
<br></span><br><h3>NOTE:
<br></h3><br>This setting will override a previous <span style="font-style: italic;">TURBO_objdat</span> directive in
<br>the same program.  It will also be overridden by a later
<br><span style="font-style: italic;">TURBO_objdat</span> directive in the same program.
<br><br><h3>CROSS-REFERENCE:<br></h3><br><a style="font-style: italic;" href="KeywordsD.html#DATASPACE">DATASPACE</a> allows you to find out how much dataspace has been
<br>set aside for a program.
<br><br>See <a style="font-style: italic;" href="KeywordsC.html#COMPILED">COMPILED</a> and <a style="font-style: italic;" href="KeywordsT.html#TURBO_objfil">TURBO_objfil</a> for other compiler directives.
<br><br><a style="font-style: italic;" href="KeywordsT.html#TURBO_objdat">TURBO_objdat</a> is exactly the same.
<br><hr style="width: 100%; height: 2px;"><h1><a name="DATA_USE"></a>DATA_USE</h1><br>Syntax: <span style="font-style: italic;">DATA_USE default_device
<br></span>Location: <span style="font-style: italic;">Toolkit II, THOR XVI
<br></span><br>If you have Toolkit II installed, all of the additional
<br>extensions connected with file or device handling and all
<br>original SuperBASIC commands use the default device if no
<br>other device name is specified.  On a THOR XVI, some of the
<br>commands support default devices without Toolkit II.
<br><br>The effect of the default devices would make <span style="font-style: italic;">LOAD proggy_bas
<br></span>work as <span style="font-style: italic;">LOAD flp1_proggy_bas</span> (assuming that flp1_ is the default data
<br>device). The  actual  effect  depends on  the  command  being
<br>executed, but generally the file will be looked for in three
<br>steps:
<br><br>(1)  Does  the  given  file  include  a  valid  device?:
<br>proggy_bas does not, ram1_proggy_bas does (ram1_). If not, the
<br>parameter is assumed to be a filename and Toolkit II looks for
<br>a device on which it can find it; so
<br><br>(2) Add the default data device to the filename. If that
<br>does not work, then:
<br><br>(3) Add the default program device (<span style="font-style: italic;">PROGD$</span>) and try again.
<br><br>The default program device is defined by <span style="font-style: italic;">PROG_USE</span>, <span style="font-style: italic;">DATA_USE
<br></span>defines  the  default  data  device.  See  <span style="font-style: italic;">PROG_USE</span>  as  to  the
<br>difference between the two defaults.
<br><br>The last two steps add the default devices to the filename.
<br>These defaults can be interpreted as sub-directories. Here, a
<br>sub-directory means  that  where  a prefix  is  separated  by
<br>underscores, this means that the file concerned is held in the
<br>sub-directory specified by that prefix.
<br><br>Thus, win1_QUILL_readme_doc could be readme_doc on a hard
<br>disk in the sub-directory QUILL or doc in the sub-subdirectory
<br>readme  of  QUILL.  Sub-directories  can  be  nested  but  the
<br>complete filename, including prefix must not be longer than 41
<br>characters (note that if you are using a network device, for
<br>example n1_win1_proggy_bas,  the maximum  permitted  filename
<br>length is reduced to 39 in current versions of the QL device
<br>drivers).
<br><br><h3>Examples:
<br></h3><span style="font-style: italic;">DATA_USE flp1_QUILL (or flp1_QUILL_)
<br>DATA_USE MDV2_
<br>DATA_USE win1_Psion_ARCHIVE
<br>DATA_USE n2_ram1_
<br>DATA_USE mdv3_games_arcade_invaders_
<br></span><br><h3>NOTE 1:
<br></h3><br>If there is no underscore at the end of <span style="font-style: italic;">DATA_USE</span>'s parameter,
<br>it will be added automatically.
<br><br><h3>NOTE 2:
<br></h3><br>A few programs do work with these sub-directories (if
<br>Toolkit II is present), but most do not. To make any program
<br>work with them, you can fool them so that they believe that
<br>for instance FLP1_games_BOOT is FLP1_BOOT or BOOT (default
<br>device FLP1_games):
<br><br>See the <span style="font-style: italic;">PTH_</span>... and <span style="font-style: italic;">DEV_</span>... commands.
<br><br><h3>NOTE 3:
<br></h3><br>Toolkit II sub-directories should not be  mixed up with
<br>wild cards.  <span style="font-style: italic;">DATA_USE flp1__bas</span> makes <span style="font-style: italic;">WDIR</span> list all BASIC programs on
<br>floppy 1, but after <span style="font-style: italic;">PROG_USE flp1__bas</span>, <span style="font-style: italic;">SAVE test</span> will not save the
<br>current program as <span style="font-style: italic;">flp1_test_bas</span> but as <span style="font-style: italic;">flp1__bas_test</span>.
<br><br><h3>NOTE 4:
<br></h3><br>The default device is the current sub-directory on level-2
<br>drivers.
<br><br><h3>NOTE 5:
<br></h3><br>If you wish to turn off this feature, you can assign a null
<br>string ("") to <span style="font-style: italic;">DATA_USE</span>.
<br><br><h3>NOTE 6:
<br></h3><br>The default devices cannot exceed 32 characters (plus a
<br>final underscore) - any attempt to assign a longer string will
<br>result in the error 'Bad Parameter' (error -15).
<br><br><h3>CROSS-REFERENCE:<br></h3><br><a style="font-style: italic;" href="KeywordsD.html#DATAD$">DATAD$</a> contains the default data device, <a style="font-style: italic;" href="KeywordsD.html#DLIST">DLIST</a> lists all
<br>default devices.
<br><br><a style="font-style: italic;" href="KeywordsD.html#DDOWN">DDOWN</a>, <a style="font-style: italic;" href="KeywordsD.html#DUP">DUP</a> and <a style="font-style: italic;" href="KeywordsD.html#DNEXT">DNEXT</a> allow you to skip from sub-directory to
<br>sub-directory, climb up the tree and much more.
<br><br><a style="font-style: italic;" href="KeywordsP.html#PROG_USE">PROG_USE</a> changes the default program device, and <a style="font-style: italic;" href="KeywordsS.html#SPL_USE">SPL_USE</a> /<a style="font-style: italic;" href="KeywordsD.html#DEST_USE">DEST_USE
</a>the default destination device.
<br><br>See also <a style="font-style: italic;" href="KeywordsD.html#DEV_USE">DEV_USE</a> and <a style="font-style: italic;" href="KeywordsP.html#PTH_ADD">PTH_ADD</a> for path search.
<br><hr style="width: 100%; height: 2px;"><h1><a name="DATE"></a>DATE</h1><br>Syntax: <span style="font-style: italic;">DATE
<br></span><br>or <span style="font-style: italic;">DATE (year,month,day,hour,minute,second)(Minerva &amp; NewDate)
<br><br></span>or <span style="font-style: italic;">DATE (year,month,day,hour,minute </span>[<span style="font-style: italic;">,second</span>]<span style="font-style: italic;">)(SMS v2.57+)
<br><br></span>Location: <span style="font-style: italic;">QL ROM, NewDate
<br></span><br>The function <span style="font-style: italic;">DATE</span> returns the current date and time as the
<br>number of seconds since midnight on 1st January 1961.
<br><br>For example, <span style="font-style: italic;">PRINT DATE$(DATE)</span> is exactly the same as <span style="font-style: italic;">PRINT DATE$</span>.
<br><br>The NewDate version of this command is exactly the same as
<br>Minerva's implementation.
<br><br><h3>NOTE:
<br></h3><br>Due to the way in which the system clock is implemented on
<br>the QL (it is stored as a 32-bit unsigned number), early
<br>versions of this function have problems with dates after
<br>3.14:07 on 19th January 2029 (this would result in a number of
<br>seconds which needs to be stored in all 32 bits). Although the
<br><span style="font-style: italic;">SDATE</span> and <span style="font-style: italic;">DATE$</span> functions treat the number correctly, the <span style="font-style: italic;">DATE
<br></span>function ignores the most significant bit, meaning that it
<br>returns the wrong value for dates later than this.
<br><br>The NewDate version of this function, as well as Minerva
<br>ROMs and under SMS, <span style="font-style: italic;">DATE</span> treats the figure as a 32-bit signed
<br>number. Although this allows the line <span style="font-style: italic;">PRINT DATE$(DATE)</span> to work
<br>correctly for all dates between 0.0:00 on 1st Jan 1961 and
<br>6.28:15 on 6th Feb 2097, note that any dates after 3.14:07 on
<br>19th January 2029 are returned as negative numbers, with
<br>earlier dates giving the largest negative number.
<br><br><h3>MINERVA NOTE:
<br></h3><br><span style="font-style: italic;">DATE</span> can accept the same six parameters accepted by <span style="font-style: italic;">SDATE</span>.
<br>This enables you (for instance) to find out the day on a given
<br>date without having to alter the QL clock:
<br><span style="font-style: italic;">PRINT DAY$(DATE(1968,6,25,1,1,0))
<br></span><br>This does also enable you to easily set the update date on
<br>a given file without altering the QL clock:
<br><span style="font-style: italic;">SET_FUPDT \flp2_test_file,DATE(1990,11,1,0,0,0)
<br></span><br><h3>SMS NOTE:
<br></h3><br>As from v2.57, <span style="font-style: italic;">DATE</span> has been brought up to the same standard
<br>as on Minerva.  However, the seconds do not have to be
<br>specified and will default to zero if omitted.
<br><br><h3>CROSS-REFERENCE:<br></h3><br><a style="font-style: italic;" href="KeywordsS.html#SDATE">SDATE</a> will alter the QL clock.
<br><br><a style="font-style: italic;" href="KeywordsD.html#DAY$">DAY$</a> returns the day on the given date, <a style="font-style: italic;" href="KeywordsD.html#DATE$">DATE$</a> will return the
<br>current date.
<br><br><a style="font-style: italic;" href="KeywordsT.html#T_ON">T_ON</a> and <a style="font-style: italic;" href="KeywordsT.html#T_START">T_START</a> can be used for accurate stop-watches for
<br>timing programs.
<br><hr style="width: 100%; height: 2px;"><h1><a name="DATE$"></a>DATE$</h1><br>Syntax: <span style="font-style: italic;">DATE$</span> [<span style="font-style: italic;">(date)</span>]
<br><br>or <span style="font-style: italic;">DATE$ (year,month,day,hour,minute </span>[<span style="font-style: italic;">,second</span>]<span style="font-style: italic;">)(SMS v2.57+ only)
<br></span>Location: <span style="font-style: italic;">QL ROM
<br></span><br><span style="font-style: italic;">DATE$</span> holds the current system date and time as a string in
<br>the following format:  yyyy mmm dd hh:mm:ss
<br><br>1991 May 06 18:18:44 (example)
<br><br> |   |   |  |  |  |
<br><br> |   |   |  |  |  \---- 19 TO 21  (seconds)
<br><br> |   |   |  |  \------- 16 TO 17  (minutes)
<br><br> |   |   |  \---------- 13 TO 14  (hour, 24h)
<br><br> |   |   \------------- 10 TO 12  (day)
<br><br> |   \----------------- 6 TO 8    (month as string)
<br><br> \--------------------- 1 TO 4    (year)
<br><br>If a parameter is used then <span style="font-style: italic;">DATE$</span> should return the date and
<br>time the given number of seconds after 1/1/1961, <span style="font-style: italic;">DATE$(DATE)</span> is
<br>identical to <span style="font-style: italic;">DATE$</span> for any date before 3.14:07 on 19th Jan 2029
<br>(see <span style="font-style: italic;">ADATE</span>). However, for times after this date, the number of
<br>seconds since 1/1/1961 is represented by a negative number,
<br>calculated by number of seconds - 2147483648. This means that
<br>to calculate a specified date after 3.14:06 on 19th Jan 2029,
<br>the following short function is required (for non-Minerva ROMs
<br>and non-SMS machines only):
<br><span style="font-style: italic;">100 DEFine FuNction DATE20$(seconds)
<br>110   offset='2147483648'
<br>120   RETurn DATE$(seconds-offset)
<br>130 END DEFine
<br></span><br>This function is not needed on Minerva ROMs, with the
<br>NewDate version of <span style="font-style: italic;">DATE</span> or under SMS - see <span style="font-style: italic;">DATE</span> for a full
<br>explanation.
<br><br><h3>Example 1:
<br></h3><br>It may be useful to read the different parts of the date
<br><br>from <span style="font-style: italic;">DATE$</span> and reformat them for use in letters.
<br><span style="font-style: italic;">100 D$=DATE$
<br>110 year=D$(1 TO 4): day=D$(10 TO 12):D$=D$(6 TO 8)
<br>120 month=(D$ INSTR "..JanFebMarAprMayJunJulAugSepOctNovDec")/3
<br>130 DIM month$(12,9): RESTORE 150
<br>140 FOR m=1 TO 12: READ month$(m)
<br>150 DATA "January","February","March","April","May","June","July"
<br>160 DATA "August","September","October","November","December"
<br>170 ALTKEY "d",month$(month)&amp;" "&amp;day&amp;", "&amp;year
<br></span><br><h3>
<br></h3><br><h3>Example 2:
<br></h3><br>How to find the number of days between two dates:
<br><span style="font-style: italic;">100 date1=DATE(2032,3,30,10,0,0)
<br>110 date2=DATE(2000,3,30,10,0,0)
<br>120 PRINT DAYS_DIFF(date2,date1)
<br>130 :
<br>140 DEFine FuNction DAYS_DIFF(dy1,dy2)
<br>150 LOCal offset,base_date,diff
<br>160 offset='2147483648'
<br>170 base_date=DATE(2029,1,19,3,14,7)
<br>180 IF (date1>=0 AND date2>=0) OR (date1<0 AND date2<0)
<br>190   IF date1>=date2:diff=date1-date2:ELSE diff=date2-date1
<br>240 ELSE
<br>250   IF date1<0
<br>260     diff=(base_date-date2)+(date1+offset
<br>270   ELSE
<br>280     diff=(base_date-date1)+(date2+offset)
<br>290   END IF
<br>300 END IF
<br>310 seconds_per_day=24*60*60
<br>320 RETurn INT(diff/seconds_per_day)
<br>330 END DEFine
<br></span><br><h3>NOTE 1:
<br></h3><br>Parts of string functions cannot be obtained by slicing
<br>them directly. Expressions such as <span style="font-style: italic;">DATE$(DATE)(1 TO 4)</span> are only valid
<br>on Minerva ROMs or under SMS. On other ROMs, the value of the
<br>function has to be copied to a variable before being sliced
<br>(as demonstrated in example 1).
<br><br><h3>NOTE 2:
<br></h3><br>The QL's system clock is limited in the range of dates it
<br>can cover - see <span style="font-style: italic;">ADATE</span>.
<br><br><h3>MINERVA NOTE:
<br></h3><br>Although on Minerva (v1.77 and later), <span style="font-style: italic;">DATE$</span> can now be
<br>directly sliced to extract the year for instance. It is
<br>however, necessary to tell the operating system that you are
<br>not actually providing a parameter to be converted into a
<br>date. This is achieved by using the following format to slice
<br><span style="font-style: italic;">DATE$</span>:
<br><br><span style="font-style: italic;">DATE$ </span>[<span style="font-style: italic;">(</span>[<span style="font-style: italic;">seconds</span>]<span style="font-style: italic;">) </span>[<span style="font-style: italic;">(</span>[<span style="font-style: italic;">start</span>]<span style="font-style: italic;"> TO </span>[<span style="font-style: italic;">end</span>]<span style="font-style: italic;">)</span>]]
<br><br>The following are therefore all valid on Minerva:
<br><br><span style="font-style: italic;">PRINT DATE$
<br><br>PRINT DATE$(DATE+86400)
<br><br>TIMER$=DATE$()(13 TO )
<br><br>YEAR$=(DATE$)(1 TO 4)
<br><br>YEAR$=DATE$(1E9)( TO 4)
<br></span><br>Only the first two examples will work on other ROMs.
<br><br><h3>SMS NOTE:
<br></h3><br><span style="font-style: italic;">DATE$</span> works mainly as per Minerva, however from v2.57+, you
<br>can also supply five or six parameters to <span style="font-style: italic;">DATE$</span> in common with
<br><span style="font-style: italic;">DATE</span> and <span style="font-style: italic;">SDATE</span>.
<br><br><h3>CROSS-REFERENCE:<br></h3><br>Use <a style="font-style: italic;" href="KeywordsS.html#SDATE">SDATE</a> and <a style="font-style: italic;" href="KeywordsA.html#ADATE">ADATE</a> to set and alter the system time and date.
<br><br><a style="font-style: italic;" href="KeywordsD.html#DATE">DATE</a> holds the current date as a floating point number, <a style="font-style: italic;" href="KeywordsD.html#DAY$">DAY$
</a>holds the weekday as a short string.
<br><hr style="width: 100%; height: 2px;"><h1><a name="DAY$"></a>DAY$</h1><br>Syntax: <span style="font-style: italic;">DAY$</span> [<span style="font-style: italic;">(date)</span>]
<br><br>or <span style="font-style: italic;">DAY$ (year,month,day,hour,minute </span>[<span style="font-style: italic;">,second</span>]<span style="font-style: italic;">)</span> <span style="font-style: italic;">(SMS v2.57+ only)
<br></span>Location: <span style="font-style: italic;">QL ROM
<br></span><br><span style="font-style: italic;">DAY$</span> holds the current day as a three character string:
<br><br>Sun   Sunday
<br><br>Mon   Monday
<br><br>Tue   Tuesday
<br><br>Wed   Wednesday
<br><br>Thu   Thursday
<br><br>Fri   Friday
<br><br>Sat   Saturday
<br><br>If you provide a parameter, <span style="font-style: italic;">DAY$</span> will return the day of the
<br>given date  (which  is  stated in  seconds  after  1/1/1961).
<br><span style="font-style: italic;">DAY$(DATE) = DAY$</span>.
<br><br><h3>NOTE:
<br></h3><br>As with <span style="font-style: italic;">DATE$</span>, you cannot slice <span style="font-style: italic;">DAY$</span> unless you have a Minerva
<br>ROM (version 1.77 or later) or SMS - see <span style="font-style: italic;">DATE$</span> for further
<br>details.
<br><br><h3>SMS NOTE:
<br></h3><br>In common with <span style="font-style: italic;">DATE$</span>, from v2.57, <span style="font-style: italic;">DAY$</span> will now accept five or
<br>six parameters as with<span style="font-style: italic;"> SDATE</span> and <span style="font-style: italic;">DATE</span>.  You can also slice <span style="font-style: italic;">DAY$
<br></span>(like on Minerva) - see <span style="font-style: italic;">DATE$</span>.
<br><br><h3>CROSS-REFERENCE:<br></h3><br><a style="font-style: italic;" href="KeywordsT.html#TRA">TRA</a> and <a style="font-style: italic;" href="KeywordsS.html#SET_LANGUAGE">SET_LANGUAGE</a> allow you to re-define the abbreviations
<br>used for the different days.
<br><br><a style="font-style: italic;" href="KeywordsD.html#DATE">DATE</a>  holds  the  current  system  date  (in  seconds  after
<br>1/1/1961) as a floating point number, <a style="font-style: italic;" href="KeywordsD.html#DATE$">DATE$</a> as a string.
<br><hr style="width: 100%; height: 2px;"><h1><a name="DBL"></a>DBL</h1><br>Syntax: <span style="font-style: italic;">DBL
<br></span>Location: <span style="font-style: italic;">Beuletools
<br></span><br>This function returns the control codes needed to switch on
<br>emphasised mode on an EPSON compatible printer:
<br><br><span style="font-style: italic;">DBL=CHR$(27)&amp;"E"</span>.
<br><br><h3>CROSS-REFERENCE:<br></h3><br><a style="font-style: italic;" href="KeywordsN.html#NORM">NORM</a>, <a style="font-style: italic;" href="KeywordsB.html#BLD">BLD</a>, <a style="font-style: italic;" href="KeywordsE.html#EL">EL</a>, <a style="font-style: italic;" href="KeywordsE.html#ENL">ENL</a>, <a style="font-style: italic;" href="KeywordsP.html#PRO">PRO</a>, <a style="font-style: italic;" href="KeywordsS.html#SI">SI</a>, <a style="font-style: italic;" href="KeywordsN.html#NRM">NRM</a>, <a style="font-style: italic;" href="KeywordsU.html#UNL">UNL</a>, <a style="font-style: italic;" href="KeywordsA.html#ALT">ALT</a>, <a style="font-style: italic;" href="KeywordsE.html#ESC">ESC</a>, <a style="font-style: italic;" href="KeywordsF.html#FF">FF</a>, <a style="font-style: italic;" href="KeywordsL.html#LMAR">LMAR</a>, <a style="font-style: italic;" href="KeywordsR.html#RMAR">RMAR</a>, <a style="font-style: italic;" href="KeywordsP.html#PAGDIS">PAGDIS</a>,
<br><a style="font-style: italic;" href="KeywordsP.html#PAGLEN">PAGLEN</a>.
<br><hr style="width: 100%; height: 2px;"><h1><a name="DDOWN"></a>DDOWN</h1><br>Syntax: <span style="font-style: italic;">DDOWN subdirectory
<br></span>Location: <span style="font-style: italic;">Toolkit II
<br></span><br>This command adds the specified subdirectory to the default
<br>data device as a suffix. If the default program device is the
<br>same as the default data device, then this will also be
<br>altered by <span style="font-style: italic;">DDOWN</span>. If the default destination device is a
<br>directory device (ie. if it ends with an underscore), <span style="font-style: italic;">DDOWN</span> also
<br>alters this (whether or not it points to another drive).
<br><br>win1_
<br><br>|
<br><br>+--------+-------+
<br><br>|        |        |
<br><br>C    BASIC   Quill
<br><br>|                 |
<br><br>+---+---+       +-----+-----+
<br><br>|        |       |           |
<br><br>include objects letters  translations
<br><br>     |
<br><br>    secret
<br><br>The above could be a directory tree on a hard disk.  <span style="font-style: italic;">DATA_USE
<br>win1_</span> defines win1_ as the default directory device, so WDIR
<br>will list all of the files on win1_.  <span style="font-style: italic;">DDOWN C</span> will move into the
<br>C sub-directory, ie. <span style="font-style: italic;">DATAD$</span> is now win1_C_.  <span style="font-style: italic;">DDOWN include</span> will make
<br>WDIR list all of the files on the hard disk which are prefixed
<br>by C_include_ (eg. win1_C_include_math_h)
<br><br><h3>NOTE 1:
<br></h3><br><span style="font-style: italic;">DDOWN</span> does not check if there are any files with the given
<br>prefix which exist.
<br><br><h3>NOTE 2:
<br></h3><br><span style="font-style: italic;">DDOWN</span> breaks with error -17 (error in expression) if the
<br>parameter is a resident keyword. So append an underscore to
<br>the directory name, eg. <span style="font-style: italic;">DDOWN NEW_</span>, or specify the parameter
<br>between quote marks (eg. <span style="font-style: italic;">DDOWN 'NEW'</span>).
<br><br><h3>NOTE 3:
<br></h3><br>The default devices cannot exceed 32 characters (plus a
<br>final underscore) - any attempt to extend them beyond this
<br>will result in the error 'Bad Parameter' (error -15).
<br><br><h3>CROSS-REFERENCE:<br></h3><br><a style="font-style: italic;" href="KeywordsD.html#DUP">DUP</a> moves up the  tree, <a style="font-style: italic;" href="KeywordsD.html#DNEXT">DNEXT</a> skips from branch to branch.
<br><br><a style="font-style: italic;" href="KeywordsD.html#DATAD$">DATAD$</a> and <a style="font-style: italic;" href="KeywordsD.html#DLIST">DLIST</a> can be used to find out about the current
<br>sub-directory and default devices respectively.
<br><hr style="width: 100%; height: 2px;"><h1><a name="DEALLOCATE"></a>DEALLOCATE</h1><br>Syntax: <span style="font-style: italic;">DEALLOCATE address
<br></span>Location: <span style="font-style: italic;">Turbo Toolkit
<br></span><br>This procedure is very similar to <span style="font-style: italic;">RECHP</span> in that it cancels a
<br>reservation of common heap memory.  However, the specified
<br><span style="font-style: italic;">address</span> must be an area of memory which had previously been set
<br>aside with <span style="font-style: italic;">ALLOCATION</span>.
<br><br><h3>WARNING:
<br></h3><br>Prior to v3d27 this command could crash the system if the
<br>specified address had already been deallocated, was an odd
<br>address, or had not been set aside with <span style="font-style: italic;">ALLOCATION</span>.
<br><br><h3>CROSS-REFERENCE:<br></h3><br>See <a style="font-style: italic;" href="KeywordsA.html#ALLOCATION">ALLOCATION</a> and <a style="font-style: italic;" href="KeywordsR.html#RECHP">RECHP</a>.
<br><hr style="width: 100%; height: 2px;"><h1><a name="DEBUG"></a>DEBUG</h1><br>Syntax: <span style="font-style: italic;">DEBUG
<br></span>Location: <span style="font-style: italic;">Turbo Toolkit (v3.20+)
<br></span><br>This is a compiler directive intended to precede a <span style="font-style: italic;">DEFine
<br>PROCedure</span> or <span style="font-style: italic;">DEFine FuNction</span> routine which is used for debugging a
<br>program.  The routine can be included or excluded from the
<br>program during compilation using the <span style="font-style: italic;">DEBUG_LEVEL</span> directive.
<br><br>Current versions of the TURBO parser do not support this.
<br><br><h3>CROSS-REFERENCE:<br></h3><br>See <a style="font-style: italic;" href="KeywordsD.html#DEBUG_LEVEL">DEBUG_LEVEL</a>.
<br><hr style="width: 100%; height: 2px;"><h1><a name="DEBUG_LEVEL"></a>DEBUG_LEVEL</h1><br>Syntax: <span style="font-style: italic;">DEBUG_LEVEL level
<br></span>Location: <span style="font-style: italic;">Turbo Toolkit (v3.20+)
<br></span><br>It is currently uncertain how this directive is used within
<br>TURBO compiled programs.
<br><br><h3>CROSS-REFERENCE:<br></h3><br>See <a style="font-style: italic;" href="KeywordsD.html#DEBUG">DEBUG</a> and <a style="font-style: italic;" href="KeywordsT.html#TURBO_xx">TURBO_xx</a>.
<br><hr style="width: 100%; height: 2px;"><h1><a name="DEFAULT"></a>DEFAULT</h1><br>Syntax: <span style="font-style: italic;">DEFAULT (expression, default_value)
<br></span>Location: <span style="font-style: italic;">BTool
<br></span><br>The function <span style="font-style: italic;">DEFAULT</span> usually simply returns the result of the
<br>given <span style="font-style: italic;">expression</span>, unless the <span style="font-style: italic;">expression</span> contains undefined variables
<br>or does not produce a floating point number. In either of
<br>these latter cases <span style="font-style: italic;">DEFAULT</span> will return the given <span style="font-style: italic;">default_value</span>.
<br><br><h3>Example:
<br></h3><br><span style="font-style: italic;">WRITE</span> simply <span style="font-style: italic;">PRINT</span>s a text to a given channel. If the channel
<br><br>ch was not a valid number for any reason then #1 is used:
<br><span style="font-style: italic;">100 DEFine PROCedure WRITE (ch, text$)
<br>110  ch = DEFAULT(ch, 1)
<br>120  PRINT#ch,text$
<br>130 END DEFine WRITE
<br></span><br><h3>CROSS-REFERENCE:<br></h3><br><a style="font-style: italic;" href="KeywordsT.html#TYPE">TYPE</a>.
<br><br><a style="font-style: italic;" href="KeywordsD.html#DEFAULT$">DEFAULT$</a> and <a style="font-style: italic;" href="KeywordsD.html#DEFAULT%">DEFAULT%</a> work exactly like <a style="font-style: italic;" href="KeywordsD.html#DEFAULT">DEFAULT</a> for string and
<br>integer expressions.
<br><hr style="width: 100%; height: 2px;"><h1><a name="DEFAULT%"></a>DEFAULT%</h1><br>Syntax: <span style="font-style: italic;">DEFAULT% (expression%, default_value%)
<br></span>Location: <span style="font-style: italic;">BTool
<br></span><br>See <span style="font-style: italic;">DEFAULT</span> !
<br><hr style="width: 100%; height: 2px;"><h1><a name="DEFAULT$"></a>DEFAULT$</h1><br>Syntax: <span style="font-style: italic;">DEFAULT$ (expression$, default_value$)
<br></span>Location: <span style="font-style: italic;">BTool
<br></span><br>See <span style="font-style: italic;">DEFAULT</span> !
<br><hr style="width: 100%; height: 2px;"><h1><a name="DEFAULT_DEVICE"></a>DEFAULT_DEVICE</h1><br>Syntax: <span style="font-style: italic;">DEFAULT_DEVICE devicename$
<br></span>Location: <span style="font-style: italic;">Turbo Toolkit
<br></span><br>This command can be used in a similar way to <span style="font-style: italic;">PROG_USE</span> and
<br><span style="font-style: italic;">DATA_USE</span>.  It sets the default device (up to 31 characters), for
<br>the following Turbo Toolkit commands:
<br><br><span style="font-style: italic;">CHARGE</span>,
<br><br><span style="font-style: italic;">EXECUTE</span>, <span style="font-style: italic;">EXECUTE_A</span>, <span style="font-style: italic;">EXECUTE_W
<br></span><br><span style="font-style: italic;">LINK_LOAD</span>, <span style="font-style: italic;">LINK_LOAD_A</span>, <span style="font-style: italic;">LINK_LOAD_W
<br></span><br>It has no effect on any other commands.
<br><br><h3>Example:
<br></h3><br>For a series of linked programs, you may want to use the
<br><br>following in a boot file:
<br><span style="font-style: italic;"><br>DEFAULT_DEVICE win1_PROGS_
<br><br></span>Each program could call another by uwing:
<br><span style="font-style: italic;"><br>EXECUTE_W program2_task
<br><br></span><h3>NOTE 1:
<br></h3><br>Prior to v3d27, this command only supported 5 characters
<br>(although prior to v2.00  no error was reported if more than 5
<br>characters  were  used  -  the  command  simply  ignored  the
<br>additional characters).
<br><br><h3>NOTE 2:
<br></h3><br>As from v1.26, you do not need to pass the device name as a
<br>string, for example:
<br><br><span style="font-style: italic;">DEFAULT_DEVICE flp1_
<br></span><br><h3>CROSS-REFERENCE:<br></h3><br><a style="font-style: italic;" href="KeywordsP.html#PROG_USE">PROG_USE</a>.
<br><hr style="width: 100%; height: 2px;"><h1><a name="DEFAULT_SCR"></a>DEFAULT_SCR</h1><br>Syntax: <span style="font-style: italic;">DEFAULT_SCR
<br></span>Location: <span style="font-style: italic;">Fn (v1.02 or later)
<br></span><br>This function is really only useful on a Minerva ROM
<br>(although it will work quite happily on any other ROM). It is
<br>sometimes useful when writing programs which are to run in
<br>Minerva's dual screen mode to discover which is the default
<br>screen.
<br><br>This is made necessary because all new windows which are
<br>opened, and all <span style="font-style: italic;">MODE</span> commands operate on the current default
<br>screen. This therefore means that if a program is badly
<br>written, it is possible that whilst the program is running the
<br>default screen is switched, giving the result that some of its
<br>windows are opened on scr0 and some on scr1.
<br><br><span style="font-style: italic;">PRINT DEFAULT_SCR
<br></span><br>will return 0 or 1 depending whether the default screen is
<br>scr0 or scr1.
<br><br>If Minerva is not in dual screen mode, or if Minerva is not
<br>present, 0 will be returned.
<br><br><h3>Example:
<br></h3><br>A program to change the <span style="font-style: italic;">MODE</span> of the current program safely
<br><br>(ie. it will only alter the <span style="font-style: italic;">MODE</span> of the screen in which the
<br><br>program is running):
<br><span style="font-style: italic;">100 This_JOB=DEFAULT_SCR
<br>110 SET_MODE 8
<br>120 :
<br>200 DEFine PROCedure SET_MODE (alp)
<br>210  IF RMODE(This_JOB)=alp:RETurn
<br>220  IF This_JOB=DEFAULT_SCR:MODE alp:RETurn
<br>230  MODE 64+32,-1:MODE alp:MODE 64+32,-1
<br>240 END DEFine
<br></span><br><h3>CROSS-REFERENCE:<br></h3><br><a style="font-style: italic;" href="KeywordsM.html#MODE">MODE</a> alters the mode of the current screen and job and can
<br>be used to alter the current default screen, <a style="font-style: italic;" href="KeywordsR.html#RMODE">RMODE</a> returns the
<br>mode of the given screen.
<br><hr style="width: 100%; height: 2px;"><h1><a name="DEFine"></a>DEFine ...</h1><br>Syntax: <span style="font-style: italic;">DEFine</span> ....
Location: <span style="font-style: italic;">QL ROM
<br></span><br>This keyword forms part of the structures: <span style="font-style: italic;">DEFine PROCedure</span>,
<br><span style="font-style: italic;">DEFine FuNction</span> and <span style="font-style: italic;">END DEFine</span>. As such, it cannot be used on its own
<br>within a program - this will cause a 'bad line' error, except
<br>under SMS where it causes an error 'Incorrect Procedure or
<br>Function Definition'.
<br><br><h3>CROSS-REFERENCE:<br></h3><br>Please refer to the individual structure descriptions for
<br>more details.
<br><hr style="width: 100%; height: 2px;"><h1><a name="DEFine%20FuNction"></a>DEFine FuNction</h1><br>Syntax: <span style="font-style: italic;">DEFine FuNction name</span>[<span style="font-style: italic;">$</span> | <span style="font-style: italic;">%</span>] [<span style="font-style: italic;">(item </span><sup>*</sup>[<span style="font-style: italic;">,item</span><sup>i</sup>]<sup>*</sup> <span style="font-style: italic;">)</span>]
Location: <span style="font-style: italic;">QL ROM
<br></span><br>This  command  marks  the  beginning  of  the  SuperBASIC
<br>structure which is used to surround lines of SuperBASIC code
<br>which forms an equivalent to a machine code function, which
<br>can be called from within SuperBASIC and will return a value
<br>dependent upon the code contained within the structure.
<br><br>The syntax of the SuperBASIC structure can take two forms:
<br><hr style="width: 100%; height: 2px;"><span style="font-style: italic;">DEFine FuNction name</span>[<span style="font-style: italic;">$ </span>|<span style="font-style: italic;"> %</span>]<span style="font-style: italic;"> </span>[<span style="font-style: italic;">(item</span><sup>*</sup>[<span style="font-style: italic;">,item</span><sup>i</sup>]<sup>*</sup><span style="font-style: italic;">)</span>]: <span style="font-style: italic;">statement</span><sup> *</sup>[<span style="font-style: italic;">:statement</span>]<sup>*</sup>:<span style="font-style: italic;">RETurn value<br></span><br>or
<br><span style="font-style: italic;">DEFine FuNction name</span>[<span style="font-style: italic;">$ </span>|<span style="font-style: italic;"> %</span>] [<span style="font-style: italic;">(item </span><sup>*</sup>[<span style="font-style: italic;">,item</span><sup>i</sup>]<sup>*</sup><span style="font-style: italic;"> )</span>]
<br><sup>*</sup>[<span style="font-style: italic;">LOCal var </span><sup>*</sup>[<span style="font-style: italic;">,var</span><sup>i</sup>]<sup>*</sup>]<sup>*
<br></sup><sup>*</sup>[<span style="font-style: italic;">statements</span>]<sup>*
<br></sup><span style="font-style: italic;">RETurn value
<br>END DEFine</span> [<span style="font-style: italic;">name</span>]
<br><br>When the specified function <span style="font-style: italic;">name</span> is called, the interpreter
<br>will search the SuperBASIC program for the related <span style="font-style: italic;">DEFine FuNction
<br></span>statement. If a related <span style="font-style: italic;">DEFine FuNction</span> cannot be found, then the
<br>interpreter will search for a machine code function of that
<br>name.
<br><br>If the definition of <span style="font-style: italic;">name</span> cannot be found, then the error
<br>'Not Found' will be reported if <span style="font-style: italic;">name</span> was defined in the past,
<br>but the definition line has since been deleted. If <span style="font-style: italic;">name</span> has
<br>never been defined in the current SuperBASIC program, then it
<br>will be treated as a normal variable and relevant error
<br>messages reported.  Under SMS in both instances the value 0
<br>will be returned (<span style="font-style: italic;">name</span> is treated as an undefined variable).
<br><br>The method of searching for a <span style="font-style: italic;">FuNction</span> means that if a
<br>SuperBASIC <span style="font-style: italic;">FuNction</span> is defined with the same name as a machine
<br>code one, the machine code one will no longer be available,
<br>and when the SuperBASIC <span style="font-style: italic;">FuNction</span> is removed (for example with
<br><span style="font-style: italic;">NEW</span>), that keyword will no longer have any effect.
<br><br>If entered as a direct command, even the in-line structure
<br>will not have any effect unless it is also called on the same
<br>line, as the interpreter must jump to the relevant <span style="font-style: italic;">DEFine FuNction
<br></span>statement when the function is called.
<br><br>If a <span style="font-style: italic;">DEFine FuNction</span> statement appears in a program, if the code
<br>is not called, program flow will continue from the statement
<br>following the next <span style="font-style: italic;">END DEFine</span> - it is however good practice to
<br>keep all definition structures towards the end of a program,
<br>and not to place the structure blocks in the middle of program
<br>code, as this makes it very difficult to follow the flow of
<br>programs.
<br><br>It is also good programming practice to make FuNctions
<br>self-contained and not to jump out of them using <span style="font-style: italic;">GO TO</span>s or <span style="font-style: italic;">GO SUB</span>s
<br>(they can of course call other <span style="font-style: italic;">FuNction</span>s and <span style="font-style: italic;">PROCedure</span>s).
<br><br>To call the <span style="font-style: italic;">DEFine FuNction</span>, you merely need to include its name
<br>in an expression. If however any parameters are listed in the
<br>definition,  you  will  need  to  pass  the  same  number  of
<br>parameters in brackets after the name of the <span style="font-style: italic;">FuNction</span>, separated
<br>by any valid SuperBASIC separator {ie. comma (,), semicolon
<br>(;), backslash (\), exclamation mark (!) or TO }.
<br><br>You can also place a hash (#) before the parameters if you
<br>so wish to indicate that it is a channel number. If not enough
<br>parameters are supplied, the program will report 'Error in
<br>Expression' when the missing parameter is used, except under
<br>SMS  where  the  missing  parameters  are  treated  as  unset
<br>variables and will therefore have the value 0 (if a numeric
<br>variable) or  else  contain  an empty  string  (if  a  string
<br>variable).
<br><br>If however, too many parameters are passed, the extra
<br>parameters are ignored.
<br><br>Parameters are passed by reference which means that the
<br>list of items in the <span style="font-style: italic;">DEFine FuNction</span> statement are deemed <span style="font-style: italic;">LOCal</span> to
<br>that definition - this means that any previous values of the
<br>items are stored whilst the definition block is active. What
<br>is more, the type of each item does not actually matter - they
<br>assume the type of the passed parameter. For example, the
<br>following short program will work without any problems:
<br><span style="font-style: italic;">10 a$=QUERY$('What is your name')
<br>20 DEFine FuNction QUERY$(x)
<br>30   INPUT (x)!b$
<br>40   RETurn b$
<br>50 END DEFine
<br></span><br>Note though that the name of the <span style="font-style: italic;">FuNction</span> must end with the
<br>correct variable type, ie. <span style="font-style: italic;">$</span> if a string is to be returned, or
<br><span style="font-style: italic;">%</span> if an integer is to be returned (although see note 7 below).
<br><br>One of the results of passing variables by reference is
<br>that if the item is altered within the definition block, if a
<br>variable is passed as a parameter, the variable itself will
<br>also be altered (although see note 4). This can be shown with
<br>the following short program:
<br><span style="font-style: italic;">100 x=10
<br>110 y=Square(x)
<br>120 PRINT x;'^2=';y
<br>130 DEFine FuNction Square(za)
<br>140   za=za*za
<br>150   RETurn za
<br>160 END DEFine
<br></span><br>This can be avoided by either assigning the item to a
<br>temporary variable  and  then using  the  temporary  variable
<br>instead (see the example below), or by passing the variable as
<br>an expression, by placing it inside brackets; for example by
<br>replacing line 110 with the following:
<br><span style="font-style: italic;">110 y=Square((x))
<br></span><br><h3>
<br></h3><br>Having passed the necessary parameters to the Function, you
<br>can then use each item inside the definition block as normal.
<br><br><h3>Example:
<br></h3><br>A short program to calculate the length of the hypotenuse
<br><br>in a triangle, given the length of its two other sides:
<br><span style="font-style: italic;">100 MODE 4: WINDOW 448,200,32,16: SCALE 100,0,0: PAPER 0
<br>105 CLS: INK 7
<br>110 AT 2,25: UNDER 1: PRINT'Pythagoras calculator': UNDER 0
<br>120 INPUT \\'Enter length of base of triangle:'!base
<br>130 INPUT \\'Enter height of triangle:'!height
<br>140 hypotenuse=Pythag(base,height)
<br>150 INK 4: LINE 50,20 TO 100,20 TO 100,70 TO 50,20
<br>160 INK 7: AT 16,35-LEN(base): PRINT base
<br>170 AT 11,46: PRINT height
<br>180 AT 11,31-LEN(hypotenuse): PRINT hypotenuse
<br>190 :
<br>1000 DEFine FuNction Pythag(x,y)
<br>1010  LOCal x1,y1
<br>1020  x1=x*x:y1=y*y
<br>1030  RETurn SQRT(x1+y1)
<br>1040 END DEFine
<br></span><br>See what happens if you replace lines 1000 to 1040 with the
<br><br>following:
<br><span style="font-style: italic;">1000 DEFine FuNction Pythag(x,y)
<br>1010 x=x*x:y=y*y
<br>1020 RETurn SQRT(x*y)
<br>1030 END DEFine
<br></span><br><h3>NOTE 1:
<br></h3><br>A <span style="font-style: italic;">FuNction</span> must return a value under all circumstances. If
<br>the <span style="font-style: italic;">END DEFine</span> is reached without a value having been returned
<br>then SuperBASIC will report an 'error in expression' (-17),
<br>specifying the error as having occured at the line containing
<br>the <span style="font-style: italic;">END DEFine</span>.  Under SMS the error 'RETurn not in PROCedure or
<br>FuNction' will be reported instead.
<br><br><h3>NOTE 2:
<br></h3><br>On pre JS ROMs, you could not define new <span style="font-style: italic;">FuNctions</span> with names
<br>which had already been used in the same program.
<br><br><h3>NOTE 3:
<br></h3><br>On pre MG ROMs, any more than nine parameters may upset the
<br>program, corrupting it by replacing names with <span style="font-style: italic;">PRINT</span> towards the
<br>end  of  a  program.  This  can  however  be  circumvented  by
<br>increasing the size of the Name Table by 8 bytes for each name
<br>(plus a little more for luck), using the line:
<br><br><span style="font-style: italic;">CALL PEEK_W(282)+36,N
<br></span><br><h3>NOTE 4:
<br></h3><br>Although a sub-set of a simple string is an expression and
<br>therefore will not be altered within a function, a sub-set of
<br>a <span style="font-style: italic;">DIM</span>ensioned string is not treated as an expression and will
<br>therefore be altered!!
<br><br><h3>NOTE 5:
<br></h3><br>Recursive <span style="font-style: italic;">FuNction</span>s (ie. <span style="font-style: italic;">FuNction</span>s which call themselves, or
<br>call another <span style="font-style: italic;">PROCedure</span> or <span style="font-style: italic;">FuNction</span> which in turn calls the original
<br><span style="font-style: italic;">FuNction</span>) are allowed (up to 32767 recursions under Minerva).
<br>They do however gobble up memory at an amazing rate and can
<br>cause problems in compiled SuperBASIC due to the fact that
<br>they need an ever-increasing amount of stack space.  They
<br>should be avoided wherever possible because they are also very
<br>slow.  On SMS, if you try to use recursive functions too much,
<br>you may  end  up  with the  rather  esoteric  error  'program
<br>structures nested too deeply, my brain hurts'!  It is however,
<br>more likely that you will end up with an 'Out of Error' memory
<br>and not be able to do anything else (not even <span style="font-style: italic;">NEW</span>).
<br><br><h3>NOTE 6:
<br></h3><br>The <span style="font-style: italic;">LOCal</span> statement (if used) must appear as the next
<br>statement following <span style="font-style: italic;">DEFine FuNction</span>, otherwise an error will be
<br>reported.  Under SMS if this is not the case, the error
<br>'Misplaced LOCal' will be reported.
<br><br><h3>NOTE 7:
<br></h3><br>SMS and QLiberator do not seem to mind if you do not end
<br>the <span style="font-style: italic;">FuNction</span> name with a $ symbol when a string is to be returned
<br>and the <span style="font-style: italic;">FuNction</span> will work perfectly well in the compiled version
<br>of the program.  However, this should be avoided as the
<br>program will not work on other QL ROMs and also cannot be
<br>compiled with TURBO.
<br><br>For example, take the following program, which works under
<br>SMS or when QLiberated.  For other ROMs and TURBO, rename the
<br>function <span style="font-style: italic;">GETSUBDIR$</span>:
<br><br><span style="font-style: italic;">100 file$='n1_win2_test_bas'
<br><br>110 test$=GETSUBDIR(file$)
<br><br>295 :
<br><br>300 DEFine FuNction GETSUBDIR(s$)
<br><br>310 IF s$(LEN(s$))&lt;&gt;'_':s$=s$&amp;'_'
<br><br>320 IF LEN(s$)=5:IF s$(4) INSTR '1234567890':RETurn ''
<br><br>322 REPeat t_loop
<br><br>325   root=1
<br><br>330   FOR x=1 TO LEN(s$)
<br><br>340     IF s$(x)='_'
<br><br>350       IF x=3:IF s$(2) INSTR '1234567890':root=3
<br><br>360       IF x=5:IF s$(4) INSTR '1234567890':root=5
<br><br>370       IF x>5:IF root=1:s$=PROGD$ &amp; s$:NEXT t_loop
<br><br>380       IF x=8:IF root=3:root=8
<br><br>390     END IF
<br><br>400   NEXT x
<br><br>410   IF root=1:s$=PROGD$ &amp; s$:NEXT t_loop
<br><br>415   as$=s$
<br><br>420   IF root=3:s$=s$(1 TO 3) &amp; PROGD$
<br><br>425   IF root=3:IF LEN(as$)>3:s$=s$&amp;as$(4 TO):NEXT t_loop:ELSE EXIT t_loop
<br><br>430   END FOR x
<br><br>435   EXIT t_loop
<br><br>440 END REPeat t_loop
<br><br>445 as$=s$
<br><br>460 RETurn s$(1 to root)
<br><br>470 END DEFine
<br></span><br><h3>
<br></h3><br><h3>NOTE 8:
<br></h3><br>Do not try to <span style="font-style: italic;">DEFine</span> one <span style="font-style: italic;">FuNction</span> inside another - although
<br>this is actually allowed under most implementations, compilers
<br>presume that an <span style="font-style: italic;">END DEFine</span> should be placed before the start of
<br>the next <span style="font-style: italic;">DEFine FuNction</span> and it makes programs very difficult to
<br>follow.  Under SMS the error 'Defines may not be within other
<br>clauses' will be reported when you try to <span style="font-style: italic;">RUN</span> the program.
<br><br><h3>NOTE 9:
<br></h3><br>On Minerva pre v1.96, if you try to link in machine code
<br>procedures or functions from inside a <span style="font-style: italic;">DEFine PROCedure</span> or <span style="font-style: italic;">DEFine FuNction
<br></span>block, problems could occur after a <span style="font-style: italic;">CLEAR</span> command.
<br><br><h3>WARNING 1:
<br></h3><br>On most ROMs (at least on JM, MGx, AH and Minerva up to
<br>v1.97), a single line recursive <span style="font-style: italic;">FuNction</span> will not respond to the
<br>break key. For example:
<br><span style="font-style: italic;">10 DEFine FuNction Root(a): a=2^Root(a)
<br></span><br>The solution for all ROMs? - insert an additional colon (:)
<br><span style="font-style: italic;">10 DEFine FuNction Root(a)::a=2^Root(a)
<br></span><br>This is fixed on SMS v2.59+.
<br><br><h3>WARNING 2:
<br></h3><br>All ROMs also suffer from this problem on multiple line
<br>recursive FuNctions, where there is no active program line
<br>between the definition line and the line which calls the
<br><span style="font-style: italic;">FuNction</span>. For example:
<br><span style="font-style: italic;">10 DEFine FuNction Root(a)
<br>20  a = 2^Root(a)
<br>30 END DEFine
<br></span><br>The solution here is to insert another active program line
<br>at line 15 - for example:
<br><span style="font-style: italic;">15 :
<br></span><br>or
<br><span style="font-style: italic;">15 PRINT
<br></span><br>Do however note that a <span style="font-style: italic;">REMark</span>, <span style="font-style: italic;">DATA</span> or <span style="font-style: italic;">LOCal</span> line at line 15
<br>will not be sufficient as these are not active commands.
<br><br>Again, this is fixed under SMS v2.59.
<br><br><h3>WARNING 3:
<br></h3><br>Except under SMS, if you assign the same name to a <span style="font-style: italic;">FuNction
<br></span>as a resident command, not only will you no longer be able to
<br>use the resident command, but it may crash the system!
<br><br><h3>SMS NOTES:
<br></h3><br>In v2.59+, if you fail to create a SuperBASIC function
<br>correctly, the error <span style="font-style: italic;">INCOMPLETE DEFine</span> appears (for example if you
<br>omit the <span style="font-style: italic;">END DEFine</span>).
<br><br>Prior to v2.89 SMS would only allow a single line <span style="font-style: italic;">DEFine
<br>FuNction</span> if <span style="font-style: italic;">END DEFine</span> appeared on the same line.  However, although
<br>v2.89 would allow a single-line <span style="font-style: italic;">DEFine FuNction</span> without an <span style="font-style: italic;">END DEFine</span> ,
<br>it would report an error if the <span style="font-style: italic;">END DEFine</span> existed!!  Thankfully,
<br>v2.90+ fixes this problem, allowing both.
<br><br><h3>CROSS-REFERENCE:<br></h3><br><a style="font-style: italic;" href="KeywordsE.html#END DEFine">END DEFine</a>  tells  the  interpreter  where  the  end  of  the definition block can be found.
<br><br><a style="font-style: italic;" href="KeywordsR.html#RETurn">RETurn</a> allows you to return the result of the Function.
<br><br><a style="font-style: italic;" href="KeywordsD.html#DEFine PROCedure">DEFine PROCedure</a> is very similar.
<br><br><a style="font-style: italic;" href="KeywordsL.html#LOCal">LOCal</a> allows you to assign temporary variables with the same
<br>name as variables used outside the definition block.
<br><br><a style="font-style: italic;" href="KeywordsP.html#PARUSE">PARUSE</a> and <a style="font-style: italic;" href="KeywordsP.html#PARTYP">PARTYP</a> allow you to examine the type of the
<br>parameters which are passed to the definition block.
<br><hr style="width: 100%; height: 2px;"><h1><a name="DEFine%20PROCedure"></a>DEFine PROCedure</h1><br>Syntax: <span style="font-style: italic;">DEFine PROCedure name </span>[<span style="font-style: italic;">(item </span><sup>*</sup>[<span style="font-style: italic;">,item</span><sup>i</sup>]<sup>*</sup><span style="font-style: italic;"> )</span>]
Location: <span style="font-style: italic;">QL ROM
<br></span><br>This  command  marks  the  beginning  of  the  SuperBASIC
<br>structure which is used to surround lines of SuperBASIC code
<br>which  forms  an  equivalent  to  a  machine  code  SuperBASIC
<br>procedure, which can be called from within SuperBASIC as a
<br>sub-routine. This forms a powerful alternative to <span style="font-style: italic;">GO SUB</span> and
<br>helps to make SuperBASIC programs very easy to read and
<br>de-bug.
<br><br>The syntax of the SuperBASIC structure can take two forms:
<br><span style="font-style: italic;">DEFine PROCedure name </span>[<span style="font-style: italic;">(item </span><sup>*</sup>[<span style="font-style: italic;">,item</span><sup>i</sup>]<sup>*</sup><span style="font-style: italic;"> )</span>]<span style="font-style: italic;">: statement </span><sup>*</sup>[<span style="font-style: italic;">:statement</span>]<sup>*
<br></sup><br>or
<br><span style="font-style: italic;">DEFine PROCedure name </span>[<span style="font-style: italic;">(item </span><sup>*</sup>[<span style="font-style: italic;">,item</span><sup>i</sup>]<sup>*</sup><span style="font-style: italic;"> )</span>]
<br><sup>*</sup>[<span style="font-style: italic;">LOCal var </span><sup>*</sup>[<span style="font-style: italic;">,var</span><sup>i</sup>]<sup>*</sup> ]<sup>*
<br></sup><sup>*</sup>[<span style="font-style: italic;">statements</span>]<sup>*
<br></sup>[<span style="font-style: italic;">RETurn</span>]
<br><span style="font-style: italic;">END DEFine </span>[<span style="font-style: italic;">name</span>]
<br><br>When  the  specified  procedure  name  is  called,  the
<br>interpreter then  searches  the SuperBASIC  program  for  the
<br>related <span style="font-style: italic;">DEFine PROCedure</span> statement. If this cannot be found, then
<br>the interpreter will look for a machine code procedure of that
<br>name. If the definition of name cannot be found, then the
<br>error 'Not Found' will be reported if name was defined in the
<br>past, but the definition line has since been deleted.
<br><br>If name has never been defined in the current SuperBASIC
<br>program, then the 'Bad Name' error will be reported.
<br><br>As with <span style="font-style: italic;">FuNction</span>s, the method of searching means that a
<br>machine code <span style="font-style: italic;">PROCedure</span> can be overwritten with a SuperBASIC
<br>definition and then later lost.
<br><br>Parameters and items are treated in the same manner as with
<br><span style="font-style: italic;">DEFine  FuNction</span>.  However,  please  note  that  calling  parameters
<br>should  not appear in brackets after the name (unless you
<br>intend to pass them otherwise than by reference!).
<br><br>When  called,  all  of  the  SuperBASIC  code  within  the
<br>definition block will be executed until either an <span style="font-style: italic;">END DEFine</span> or
<br><span style="font-style: italic;">RETurn</span> is found, in which case execution will return to the
<br>statement after the calling statement. In contrast however, to
<br><span style="font-style: italic;">DEFine FuNction</span>, there is no need for a <span style="font-style: italic;">PROCedure</span> definition block to
<br>contain a <span style="font-style: italic;">RETurn </span>statement.
<br><br>Strictly a <span style="font-style: italic;">PROCedure</span> cannot return a value - however due to
<br>the nature of the parameters being passed by reference (see
<br><span style="font-style: italic;">DEFine FuNction</span>), this is possible.
<br><br><h3>Example:
<br></h3><br>A simple demonstration program which highlights the fact
<br><br>that a <span style="font-style: italic;">PROCedure</span> or <span style="font-style: italic;">FuNction</span> can actually be recursive (ie. call
<br><br>itself),  and  also  highlights  the  effect  of  passing
<br><br>parameters by reference - keep an eye on the values in #0:
<br><span style="font-style: italic;">100 radius=50:height=125:CLS:CLS#0
<br>110 Rndom_circle radius,(height),100
<br>120 AT #0,0,0:PRINT#0,radius,height,100
<br>130 DEFine PROCedure Rndom_circle (x,y,z)
<br>140   INK RND(7):FILL RND(1)
<br>150   CIRCLE RND (y),RND(z),x
<br>160   FILL 0
<br>170   AT #0,0,0:PRINT#0,x,y,z:PAUSE
<br>180   x=x-RND(5):y=y-1:z=z+1
<br>190   IF x<1:RETurn
<br>200   Rndom_circle (x),y,z
<br>210 END DEFine
<br></span><br><h3>NOTE 1:
<br></h3><br>On pre JS ROMs, you could not define new <span style="font-style: italic;">PROCedure</span>s with names
<br>which had already been used in the same program.
<br><br><h3>NOTE 2:
<br></h3><br>On pre MG ROMs, any more than nine parameters may upset the
<br>program, corrupting it by replacing names with <span style="font-style: italic;">PRINT</span> towards the
<br>end  of  a  program.  This  can  however  be  circumvented  by
<br>increasing the size of the Name Table by 8 bytes for each name
<br>(plus a little more for luck), using the line:
<br><br><span style="font-style: italic;">CALL PEEK_W(282)+36,N
<br></span><br><h3>NOTE 3:
<br></h3><br>Recursive <span style="font-style: italic;">PROCedure</span>s (ie. <span style="font-style: italic;">PROCedure</span>s which call themselves, or
<br>call another <span style="font-style: italic;">PROCedure</span> or <span style="font-style: italic;">FuNction</span> which in turn calls the original
<br><span style="font-style: italic;">PROCedure</span>) are allowed (up to 32767 recursions on Minerva). They
<br>do however gobble up memory at an amazing rate and can cause
<br>problems in compiled SuperBASIC due to the fact that they need
<br>an ever-increasing amount of stack space.  They should be
<br>avoided wherever  possible.    On  SMS, if  you  try  to  use
<br>recursive functions too much, you may end up with the error
<br>'program structures nested too deeply, my brain hurts'!  It is
<br>however, more likely that you will end up with an 'Out of
<br>Memory' error and not be able to do anything else (not even
<br><span style="font-style: italic;">NEW</span>).
<br><br><h3>NOTE 4:
<br></h3><br>The <span style="font-style: italic;">LOCal</span> statement (if used) must appear as the next
<br>statement following <span style="font-style: italic;">DEFine PROCedure</span>, otherwise an error will be
<br>reported.  Under SMS if this is not the case, the error
<br>'Misplaced LOCal' will be reported.
<br><br><h3>NOTE 5:
<br></h3><br>Do not try to <span style="font-style: italic;">DEFine</span> one <span style="font-style: italic;">PROCedure</span> inside another - although
<br>this is actually allowed under most implementations, compilers
<br>presume that an <span style="font-style: italic;">END DEFine</span> should be placed before the start of
<br>the next <span style="font-style: italic;">DEFine PROCedure</span> and it makes programs very difficult to
<br>follow.  Under SMS the error 'Defines may not be within other
<br>clauses' will be reported when you try to <span style="font-style: italic;">RUN</span> the program.
<br><br><h3>WARNING 1:
<br></h3><br>As with <span style="font-style: italic;">DEFine FuNction</span> problems do exist with recursive <span style="font-style: italic;">PROCedure</span>s
<br>which prevent the Break key from working.
<br><br>These problems are fixed by SMS v2.59+
<br><br><h3>WARNING 2:
<br></h3><br>Except under SMS, if you assign the same name to a <span style="font-style: italic;">PROCedure
<br></span>as a resident command, not only will you no longer be able to
<br>use the resident command, but it may crash the system!
<br><br><h3>SMS NOTES:
<br></h3><br>From v2.59, as with <span style="font-style: italic;">DEFine FuNction</span>, SMS insists that all
<br><span style="font-style: italic;">PROCedure</span>s have an <span style="font-style: italic;">END DEFine</span> statement, even if they are on a single
<br>line.  If this does not exist, or there is something else
<br>wrong  with  the  syntax,  then  the  error  <span style="font-style: italic;">'Incomplete  DEFine</span>  is
<br>reported.
<br><br>The same problems exist in versions prior to v2.90 as with
<br><span style="font-style: italic;">DEFine FuNction</span> for in-line code.
<br><br><h3>CROSS-REFERENCE:<br></h3><br>Please see <a style="font-style: italic;" href="KeywordsD.html#DEFine FuNction">DEFine FuNction</a>!
<br><br>Also see <a style="font-style: italic;" href="KeywordsE.html#END DEFine">END DEFine</a>.
<br><br>Look at the example for <a style="font-style: italic;" href="KeywordsS.html#SWAP">SWAP</a> which provides a more practical
<br>use of recursive <a style="font-style: italic;" href="KeywordsP.html#PROCedure">PROCedure</a>s.
<br><hr style="width: 100%; height: 2px;"><h1><a name="DEFINED"></a>DEFINED</h1><br>Syntax: <span style="font-style: italic;">DEFINED (anything)
<br></span>Location: <span style="font-style: italic;">BTool
<br></span><br>SuperBASIC is different from other BASIC dialects in that
<br>it does not assign a default value to newly introduced but
<br>still unset variables (except on SMS which assigns the value
<br>Zero to an unset numeric variable and an empty string to an
<br>unset string).
<br><br>This makes it possible for a program to detect if a
<br>variable  has  been  properly  initialised  -  an  'error  in
<br>expression'  (-17)  is  reported  if  you  try  to  carry  out
<br>operations on unset variables.
<br><br>The function <span style="font-style: italic;">DEFINED</span> takes any parameter, no matter what type
<br>it is, provided that it is a constant or a variable. <span style="font-style: italic;">DEFINED
<br></span>returns 0 if the parameter was a variable but unset and 1 for
<br>defined variables and constant expressions.
<br><br><h3>NOTE:
<br></h3><br>This function does not work on SMS
<br><br><h3>CROSS-REFERENCE:<br></h3><br><a style="font-style: italic;" href="KeywordsC.html#CLEAR">CLEAR</a> makes all variables undefined.
<br><a href="KeywordsP.html#PRINT">PRINT</a> writes asterisks if unset variables are required to be printed.
<br><a href="KeywordsT.html#TYPE">TYPE</a> returns 1, 2 or 3 for undefined variables.
<br><br>See also <a style="font-style: italic;" href="KeywordsU.html#UNSET">UNSET</a>.
<br><hr style="width: 100%; height: 2px;"><h1><a name="DEG"></a>DEG</h1><br>Syntax: <span style="font-style: italic;">DEG (angle)
<br></span>Location: <span style="font-style: italic;">QL ROM
<br></span><br>This function is used to convert an <span style="font-style: italic;">angle</span> in radians into an
<br><span style="font-style: italic;">angle</span> in degrees (which is the system more readily used by
<br>humans).
<br><br>Although this will work for any value of <span style="font-style: italic;">angle</span>, due to the
<br>very nature of angles, <span style="font-style: italic;">angle</span> should be in the range 0...2&pi;,
<br>which will return a value in the range 0...360.
<br><br><h3>CROSS-REFERENCE:<br></h3><br>See <a style="font-style: italic;" href="KeywordsR.html#RAD">RAD</a> and the Mathematics section of the Appendix.
<br><hr style="width: 100%; height: 2px;"><h1><a name="DELETE"></a>DELETE</h1><br>Syntax: <span style="font-style: italic;">DELETE file
<br></span><br>or <span style="font-style: italic;">DELETE file</span> <sup>*</sup>[<span style="font-style: italic;">,file</span><sup>i</sup>]<sup>*</sup>  <span style="font-style: italic;">(THOR XVI)
<br></span>Location: <span style="font-style: italic;">QL ROM, Toolkit II
<br></span><br>The command<span style="font-style: italic;"> DELETE</span> removes the stated <span style="font-style: italic;">file</span> from a medium (it
<br>actually only deletes its entry from the directory map, which
<br>thus allows these files to be recovered if necessary, with a
<br>utility such as the Public Domain RETTUNGE_exe, provided that
<br>nothing has been written to the disk since it was deleted).
<br><br>The filename must include the name of the medium, unless
<br>you have Toolkit II installed, which alters the command so
<br>that the default data device is recognised (see <span style="font-style: italic;">DATAD$</span>).
<br><br>The command does not report an error if a file was not
<br>found! However, if an invalid device is used and Toolkit II is
<br>not present, an error will be reported.
<br><br>The THOR XVI variant of this command follows the original
<br>proposal for this command, allowing you to delete several
<br>files at the same time by listing each filename, eg:
<br><span style="font-style: italic;">DELETE flp1_boot,flp1_main_bas
<br></span><br>This latter syntax is accepted on non-Minerva systems, but
<br>only the first file will be deleted. If Toolkit II is present,
<br>error -15 (bad parameter) is reported.
<br><br><h3>Example:
<br></h3><br><span style="font-style: italic;">DELETE mdv2_PROG_bak
<br><br>DELETE PROG_bak
<br></span><br><h3>CROSS-REFERENCE:<br></h3><br><a style="font-style: italic;" href="KeywordsW.html#WDEL">WDEL</a> deletes several files interactively.
<br><br><a style="font-style: italic;" href="KeywordsW.html#WDEL_F">WDEL_F</a>, <a style="font-style: italic;" href="KeywordsW.html#WDIR">WDIR</a> and <a style="font-style: italic;" href="KeywordsT.html#TTEDELETE">TTEDELETE</a> are also worth a look.
<br><hr style="width: 100%; height: 2px;"><h1><a name="DEL_DEFB"></a>DEL_DEFB</h1><br>Syntax:<span style="font-style: italic;"> DEL_DEFB
<br></span>Location: <span style="font-style: italic;">Toolkit II
<br></span><br>QDOS stores information concerning devices and files (and
<br>in relation to files, even their contents) in areas of memory
<br>known as 'slave blocks' (memory permitting).
<br><br>These slave blocks can be very useful, since when the
<br>computer tries to access the same device (or file) again, the
<br>access is much quicker, since the relevent details can be
<br>loaded from memory, rather than the device - the computer only
<br>need look at the device to make certain that it is the same
<br>device (or disk) as was previously used.
<br><br>There are three problems with the use of these slave
<br>blocks:
<br><br>-The initial device access is slowed down as all
<br>of the information is effectively read twice -
<br>once into memory and once into the program.
<br><br>-Some disk drives do not support a means of
<br>checking if a disk has been amended on a second
<br>computer since the last access - meaning that the
<br>old version of the information stored in the
<br>slave blocks can be loaded instead
<br><br>-On some hard-disks, the hard-disk itself may not
<br>have been altered (you may need to use a command
<br>such as <span style="font-style: italic;">WIN_FLUSH</span>).
<br><br>The command <span style="font-style: italic;">DEL_DEFB</span> can assist with the second of these
<br>problems, by deleting all of the slave blocks from memory.
<br><br>Another problem which can be assisted by <span style="font-style: italic;">DEL_DEFB</span> is 'heap
<br>fragmentation'.  To keep memory tidy, there is an internal
<br>list which says where to find which pieces of information.
<br>These lists reserve memory and can lead to the phenomenon
<br>known   as   heap   fragmentation.   The   following   example
<br>demonstrates this:
<br><span style="font-style: italic;">PRINT FREE_MEM
<br>a=ALCHP(10000)
<br>b=ALCHP(10000)
<br>PRINT FREE_MEM
<br>RECHP a
<br>PRINT FREE_MEM
<br></span><br>First, we noted how much memory is free and then we
<br>reserved 20000 bytes of memory in two steps. So there are now
<br>20000 bytes of free memory less. Now, we release the first
<br>10000 bytes and look again at the free memory: it has not
<br>actually  increased  as  much  as  you  would  have  thought!
<br>Actually, the memory isn't lost.  <span style="font-style: italic;">FREE_MEM</span> returns the  largest
<br>piece of free memory in RAM. A further <span style="font-style: italic;">ALCHP(10000)</span> would not
<br>reduce <span style="font-style: italic;">FREE_MEM</span> in the above example.
<br><br>Maybe an illustration would make memory management clearer:
<br><br>free memory|-------------------------|
<br><br><span style="font-style: italic;">ALCHP(10000)</span>|######|------------------|
<br><br><span style="font-style: italic;">ALCHP(10000)</span>|######|######|-----------|
<br><br>release first block|======|######|-----------|
<br><br>-- : free memory (returned by <span style="font-style: italic;">FREE_MEM</span>)
<br><br>## : reserved memory
<br><br>== : free memory (used for ramdisks)
<br><br>The above-mentioned internal list allocates a small piece
<br>of memory which may reduce the largest piece of free RAM
<br>available to certain operations which draw large chunks of
<br>memory at a time, causing them to fail (out of memory), even
<br>though there would be enough memory had the 'drive definition
<br>blocks' not fragmented it.
<br><br>The command <span style="font-style: italic;">DEL_DEFB</span> clears these blocks, thus helping to
<br>relieve the heap fragmentation.
<br><br><h3>NOTE:
<br></h3><br>Because <span style="font-style: italic;">DEL_DEFB</span> deletes the slave blocks, future device
<br>accesses will be slowed!
<br><br><h3>WARNING:
<br></h3><br>Do not use <span style="font-style: italic;">DEL_DEFB</span> if any channels are open to a file.
<br><br><h3>CROSS-REFERENCE:<br></h3><br><a style="font-style: italic;" href="KeywordsR.html#RECHP">RECHP</a>, <a style="font-style: italic;" href="KeywordsC.html#CLCHP">CLCHP</a>, <a style="font-style: italic;" href="KeywordsR.html#RELEASE">RELEASE</a>, <a style="font-style: italic;" href="KeywordsF.html#FREE_MEM">FREE_MEM</a>, <a style="font-style: italic;" href="KeywordsF.html#FREE">FREE</a>.
<br><br>Dynamic RAM disks use effectively all of the free memory.
<br><br><a style="font-style: italic;" href="KeywordsF.html#FORMAT">FORMAT</a> lists other ways of causing heap fragmentation.
<br><hr style="width: 100%; height: 2px;"><h1><a name="DESPR"></a>DESPR</h1><br>Syntax: <span style="font-style: italic;">DESPR (bytes)
<br></span>Location: <span style="font-style: italic;">DESPR
<br></span><br>The function <span style="font-style: italic;">DESPR</span> uses an un-documented system call to try
<br>and  release  a  given  number  of  bytes  from  the  resident
<br>procedure memory on the QL. It is unknown how the ROM tries to
<br>decide which bytes to release.
<br><br><h3>WARNING:
<br></h3><br>The system call used only works properly on Minerva ROMs
<br>and can crash some versions of the QL. This function should
<br>not be used!!
<br><br><h3>CROSS-REFERENCE:<br></h3><br>Use <a style="font-style: italic;" href="KeywordsR.html#RESPR">RESPR</a> to allocate resident procedure memory, and do not
<br>try to release it at a later stage. Use <a style="font-style: italic;" href="KeywordsA.html#ALCHP">ALCHP</a> and <a style="font-style: italic;" href="KeywordsR.html#RECHP">RECHP</a> to
<br>allocate areas of memory which may be later released.
<br><hr style="width: 100%; height: 2px;"><h1><a name="DESTD$"></a>DESTD$</h1><br>Syntax: <span style="font-style: italic;">DESTD$
<br></span>Location: <span style="font-style: italic;">Toolkit II
<br></span><br>This  function  always  contains  the  current  default
<br>destination device, which is an unofficial QDOS standard and
<br>supported by the Toolkit II variants of <span style="font-style: italic;">COPY</span>, <span style="font-style: italic;">WCOPY</span>, <span style="font-style: italic;">WREN</span>, and <span style="font-style: italic;">SPL</span>.
<br>When Toolkit II is initiated, <span style="font-style: italic;">DESTD$='SER'</span>.
<br><br>The default device means that if no other device is stated
<br>for the destination file, this device will be used. The
<br>default destination device will also be consulted if a device
<br>name is supplied but the given file cannot be found on that
<br>device. For example, assuming that <span style="font-style: italic;">DESTD$='flp2_'</span> and <span style="font-style: italic;">DATAD$='ram1_'</span>, if
<br>you enter <span style="font-style: italic;">COPY example_txt</span>, then the file ram1_example_txt will be
<br>copied to flp2_example_txt.
<br><br>This  idea  can  be  extended  to  use  prefixes  as
<br>sub-directories.      Sub-directories   are   separated   by
<br>underscores,  <span style="font-style: italic;">DESTD$</span> always ends with an underscore.
<br><br><h3>CROSS-REFERENCE:<br></h3><br><a style="font-style: italic;" href="KeywordsD.html#DEST_USE">DEST_USE</a> and <a style="font-style: italic;" href="KeywordsS.html#SPL_USE">SPL_USE</a> both define the default destination device<a style="font-style: italic;" href="Keywords..html#.">.
<a href="KeywordsD.html#DUP">DUP</a>, <a style="font-style: italic;" href="KeywordsD.html#DDOWN">DDOWN</a> and <a style="font-style: italic;" href="KeywordsD.html#DNEXT">DNEXT</a> allow you to move around the sub-directory tree.
<br><br><a style="font-style: italic;" href="KeywordsP.html#PROGD$">PROGD$</a> returns the default program device, <a style="font-style: italic;" href="KeywordsD.html#DATAD$">DATAD$</a> returns the default data device.
<br><br><a style="font-style: italic;" href="KeywordsD.html#DLIST">DLIST</a> prints all default devices.
<br><hr style="width: 100%; height: 2px;"><h1><a name="DEST_USE"></a>DEST_USE</h1><br>Syntax: <span style="font-style: italic;">DEST_USE name
<br></span>Location: <span style="font-style: italic;">Toolkit II
<br></span><br>This command sets the current default destination device to
<br>the named directory device. An underscore will be added to the
<br>end of the name if one is not supplied. If you supply name as
<br>an empty string, this will turn off the default destination
<br>directory.
<br><br><h3>Example:
<br></h3><br><span style="font-style: italic;">DEST_USE win1_Quill
<br></span><br><h3>NOTE 1:
<br></h3><br><span style="font-style: italic;">DEST_USE</span> will overwrite the default set with <span style="font-style: italic;">SPL_USE</span>.
<br><br><h3>NOTE 2:
<br></h3><br>The default devices cannot exceed 32 characters (plus a
<br>final underscore) - any attempt to assign a longer string will
<br>result in the error 'Bad Parameter' (error -15).
<br><br><h3>CROSS-REFERENCE:<br></h3><br>Please see <a style="font-style: italic;" href="KeywordsD.html#DESTD$">DESTD$</a> and <a style="font-style: italic;" href="KeywordsS.html#SPL_USE">SPL_USE</a>.
<br><hr style="width: 100%; height: 2px;"><h1><a name="DEMO"></a>DEMO</h1><br>Syntax: <span style="font-style: italic;">DEMO n
<br></span>Location: <span style="font-style: italic;">Shape Toolkit
<br></span><br>As the name suggests, this is only a demonstration. Try the
<br>command <span style="font-style: italic;">DEMO 1</span> and see what happens. Use only odd parameters if
<br>you want the screen to be restored to its previous status when
<br>the demonstration finishes.
<br><br><h3>CROSS-REFERENCE:<br></h3><br>The function <a style="font-style: italic;" href="KeywordsO.html#ODD ">ODD </a>checks if a number is odd or even.
<br><hr style="width: 100%; height: 2px;"><h1><a name="DET"></a>DET</h1><br>Syntax: <span style="font-style: italic;">DET</span> [<span style="font-style: italic;">array</span>]
Location: <span style="font-style: italic;">Math Package
<br></span><br>The function<span style="font-style: italic;"> DET</span> returns the determinant of a square matrix,
<br>meaning that the array (or the part passed) must have two
<br>dimensions of equal size, otherwise <span style="font-style: italic;">DET</span> breaks with error -15
<br>(bad parameter). The array needs to be a floating point array,
<br>any other type (including integer arrays) will also produce
<br>error -15.If no parameter is given, <span style="font-style: italic;">DET</span> will use the array that
<br>has been supplied to the previously executed <span style="font-style: italic;">MATINV</span> command as
<br>its source. If however, this command has not yet been used, <span style="font-style: italic;">DET
<br></span>without a parameter will stop with the error -7 (not found).
<br><br>You may ask what a determinant is? Briefly speaking, it
<br>represents  a  square  matrix  by  a  single  number  so  that
<br>important characteristics of the matrix can be deduced from
<br>it, eg. the matrix cannot be inverted if the determinant is
<br>zero.
<br><br><h3>Example:
<br></h3><br>We will try to approach the eigenvalues of a matrix and
<br><br>list them all (the so-called "spectrum" of a matrix). Due
<br><br>to approximation errors and the simple algorithm employed,
<br><br>there can be more output values than there should be. This
<br><br>can be improved by increasing  estep in line 130, but at
<br><br>the cost of speed. The range of expected eigenvalues (eval1
<br><br>to eval2) is adapted to the chosen matrix whose random
<br><br>elements only range between 0 and 1. There is no limit for
<br><br>the positive size n of the matrix,  n=0 is allowed but does
<br><br>not make sense because CHARPOLY becomes constant:
<br><span style="font-style: italic;">100 CLEAR: RANDOMISE 10: PRINT "Eigenvalues:"
<br>110 n=2: DIM matrix(n,n), one(n,n)
<br>120 MATRND matrix: MATIDN one
<br>130 :
<br>140 eval1=-1: eval2=1: esteps=200
<br>150 eprec<(eval2-eval1)/estep)
<br>160 c1=CHARPOLY(matrix,eval1): count%=0
<br>170 FOR eval=eval1+eprec TO eval2 STEP eprec
<br>180   c2=CHARPOLY(matrix,eval)
<br>190   IF SGN(c1)&lt;&gt;SGN(c2) THEN PRINT eval
<br>200   c1=c2: count%=count%+1
<br>210   AT#0,0,0: PRINT#0,INT(100*count%/esteps);"%"
<br>220 END FOR eval
<br>230 PRINT "absolute fault:"!eprec
<br>240 :
<br>250 DEFine FuNction CHARPOLY(matrix,lambda)
<br>260  LOCal diff(n,n),i
<br>270  FOR i=1 TO n: one(i,i)=lambda
<br>280  MATSUB diff,matrix,one
<br>290  RETurn DET(diff)
<br>300 END DEFine CHARPOLY
<br></span><br>In practice, a Newton iteration algorithm (or better) would
<br><br>be used.
<br><br><h3>CROSS-REFERENCE:<br></h3><br><a style="font-style: italic;" href="KeywordsM.html#MATINV">MATINV</a> co-operates closely with <a style="font-style: italic;" href="KeywordsD.html#DET">DET</a>, so that for each of them
<br>a matrix parameter can be omitted if the other function has
<br>been called before; <a style="font-style: italic;" href="KeywordsM.html#MATINV">MATINV</a> calls <a style="font-style: italic;" href="KeywordsD.html#DET">DET</a> internally.
<br><br>In the example, we used the <a style="font-style: italic;" href="KeywordsM.html#MATRND">MATRND</a>, <a style="font-style: italic;" href="KeywordsM.html#MATIDN">MATIDN</a>, <a style="font-style: italic;" href="KeywordsS.html#SGN">SGN</a> and <a style="font-style: italic;" href="KeywordsM.html#MATSUB
">MATSUB
</a>keywords which are all part of the same Toolkit.
<br><hr style="width: 100%; height: 2px;"><h1><a name="DEVICE_SPACE"></a>DEVICE_SPACE</h1><br>Syntax: <span style="font-style: italic;">DEVICE_SPACE (</span>[<span style="font-style: italic;">#</span>]<span style="font-style: italic;">channel)
<br></span>Location: <span style="font-style: italic;">Turbo Toolkit
<br></span><br>This function returns the number of unused bytes on the
<br>medium (disk, hard disk or microdrive) to which the specified
<br>channel is open.
<br><br>The channel must relate to an open file on a directory
<br>device (otherwise junk figures may be returned).
<br><br><h3>Example:
<br></h3><br>A short routine which saves an area of memory to disk, with
<br><br>error checking.
<br><br><span style="font-style: italic;">100 OPEN #3,'CON_448X200A32X16'
<br><br>110 CLS #3
<br><br>120 FILE$='FLP1_MEMORY_BIN'
<br><br>130 FILE_SIZE=20000:ADDR=ALCHP(FILE_SIZE)
<br><br>140 REPEAT LOOP
<br><br>150   INPUT #3,'ENTER FILENAME TO SAVE MEMORY TO : [DEFAULT=';(FILE$);']';F$
<br><br>160   IF F$='':F$=FILE$:ELSE FILE$=F$
<br><br>170   OPEN_STATE=DEVICE_STATUS(2,FILE$)
<br><br>180   IF OPEN_STATE=-20:PRINT #3,'DEVICE IS READ ONLY':NEXT LOOP
<br><br>190   IF OPEN_STATE=-11:PRINT #3,'DEVICE IS FULL':NEXT LOOP
<br><br>200   IF OPEN_STATE=-8
<br><br>210     INPUT #3,'DO YOU WANT TO DELETE EXISTING FILE ? (Y/N)';A$
<br><br>220     IF A$=='Y'
<br><br>230       CH=FOP_IN(FILE$)
<br><br>240     ELSE
<br><br>250       PRINT #3;'ENTER NEW FILENAME':PAUSE 100
<br><br>260       NEXT LOOP
<br><br>270     END IF
<br><br>275   ELSE
<br><br>277     CH=FOP_NEW(FILE$)
<br><br>280   END IF
<br><br>300   IF CH<0:REPORT #3:NEXT LOOP
<br><br>305   FREE_SPACE=DEVICE_SPACE(#CH)
<br><br>307   IF OPEN_STATE=-8:FREE_SPACE=FREE_SPACE+FLEN(#CH)
<br><br>310   IF FREE_SPACE>=FILE_SIZE:PRINT#3,'SAVING FILE':EXIT LOOP
<br><br>320   PRINT #3;'NOT ENOUGH ROOM ON DEVICE'
<br><br>330   CLOSE #CH
<br><br>335   IF OPEN_STATE&lt;&gt;-8:DELETE FILE$
<br><br>340 END REPEAT LOOP
<br><br>350 CLOSE #CH
<br><br>355 DELETE FILE$
<br><br>360 SBYTES FILE$,ADDR,FILE_SIZE
<br></span><br><h3>
<br></h3><br><h3>NOTE:
<br></h3><br>Current versions of this fuction have difficulty returning
<br>the amount of space on large capacity drives, such as hard
<br>disks.  It assumes that a sector contains 512 bytes and will
<br>only cope with a maximum of 65535 sectors.
<br><br><h3>CROSS-REFERENCE:<br></h3><br>See  <a style="font-style: italic;" href="KeywordsF.html#FOPEN">FOPEN</a>  and  <a style="font-style: italic;" href="KeywordsD.html#DEVICE_STATUS">DEVICE_STATUS</a>  for  more  details  on  accessing
<br>directory devices.  <a style="font-style: italic;" href="KeywordsD.html#DEV_TYPE">DEV_TYPE</a> finds out what type of device a
<br>channel is looking at.
<br><hr style="width: 100%; height: 2px;"><h1><a name="DEVICE_STATUS"></a>DEVICE_STATUS</h1><br>Syntax: <span style="font-style: italic;">DEVICE_STATUS (</span>[<span style="font-style: italic;">open_type,</span>]<span style="font-style: italic;"> filename$)
<br></span>Location: <span style="font-style: italic;">Turbo Toolkit
<br></span><br>This function returns a value representing the current
<br>status of the device to which the specified <span style="font-style: italic;">filename$</span> points and
<br>can be used to check if an error will be generated when you
<br>try to access the given file.
<br><br>The <span style="font-style: italic;">open_type</span> defaults to 2 and can take the following values:
<br><br>-1Use for <span style="font-style: italic;">OPEN</span> or <span style="font-style: italic;">OPEN_NEW
<br></span><br>0Use for <span style="font-style: italic;">OPEN
<br></span><br>1Use for <span style="font-style: italic;">OPEN_IN
<br></span><br>2Use for <span style="font-style: italic;">OPEN_NEW
<br></span><br>If an <span style="font-style: italic;">open_type</span> of 2 is specified, then the function will try
<br>to create the file and return an error code if this is not
<br>possible.  The temporary file is deleted in all cases.  If an
<br><span style="font-style: italic;">open_type</span> of 0 is specified then the function will try to open
<br>the file for exclusive two way access and report any errors.
<br>However, if an <span style="font-style: italic;">open_type</span> of 1 is specified the function opens the
<br>specified file for read only access, which means that it does
<br>not care if a channel is already open to the file from another
<br>program.
<br><br>Finally, if an <span style="font-style: italic;">open_type</span> of -1 is specified, the function will
<br>first of all try to open a channel to the file, returning -8
<br>if it already exists and can therefore be read.  If it does
<br>not  already  exist,  the  function  will  tryo  to  create  a
<br>temporary file and then read back from it to check that the
<br>device can be written to and read from, reporting any errors
<br>which are found.  Any temporary file is then deleted by the
<br>function.  This enables IN USE and bad or changed medium
<br>errors can be detected!
<br><br>If the open is successful the amount of free space on the
<br>drive is returned akin to <span style="font-style: italic;">DEVICE_SPACE</span>, otherwise a standard QDOS
<br>error code is returned.
<br><br><h3>NOTE 1:
<br></h3><br>Current versions of this fuction have difficulty returning
<br>the amount of space on large capacity drives, such as hard
<br>disks.  It assumes that a sector contains 512 bytes and will
<br>only cope with a maximum of 65535 sectors.
<br><br><h3>NOTE 2:
<br></h3><br>Due to a bug in the QL's hardware, it is impossible to
<br>check if a microdrive is read only.  In this instance, you
<br>will get a bad or changed medium error code (-16).
<br><br><h3>CROSS-REFERENCE:<br></h3><br>See <a style="font-style: italic;" href="KeywordsD.html#DEVICE_SPACE">DEVICE_SPACE</a> for an example.
<br><hr style="width: 100%; height: 2px;"><h1><a name="DEVLIST"></a>DEVLIST</h1><br>Syntax: <span style="font-style: italic;">DEVLIST </span>[<span style="font-style: italic;">#channel</span>]
Location: <span style="font-style: italic;">TinyToolkit
<br></span><br>This command lists all directory devices recognised by the
<br>system to the specified <span style="font-style: italic;">channel</span>. A directory device is one which
<br>contains files. The default list <span style="font-style: italic;">channel</span> is #1.
<br><br><h3>NOTE:
<br></h3><br>If device names appear in the listing more than once, this
<br>means that  more  than  one device  driver  is  loaded.  This
<br>normally happens with ramdisks ("RAM").
<br><br><h3>CROSS-REFERENCE:<br></h3><br>Directory devices may be renamed with <a style="font-style: italic;" href="KeywordsC.html#CHANGE">CHANGE</a> (this will have
<br>a corresponding effect on <a style="font-style: italic;" href="KeywordsD.html#DEVLIST">DEVLIST</a>), whilst any device can be
<br>renamed using <a style="font-style: italic;" href="KeywordsQ.html#QRD">QRD</a> (this will have no effect on <a style="font-style: italic;" href="KeywordsD.html#DEVLIST">DEVLIST</a>).
<br><br>Compare <a style="font-style: italic;" href="KeywordsD.html#DLIST">DLIST</a>.
<br><hr style="width: 100%; height: 2px;"><h1><a name="DEVTYPE"></a>DEVTYPE</h1><br>Syntax: <span style="font-style: italic;">DEVTYPE</span> [<span style="font-style: italic;">(#channel)</span>]
Location: <span style="font-style: italic;">SMS
<br></span><br>This function returns a value to indicate the type of
<br>device the specified channel (default #0) is connected to.
<br><br>At present, you should only look at the first three bits of
<br>the return value, ie:
<br><br><span style="font-style: italic;">x%=DEVTYPE(#channel)
<br><br>x%=x% &amp;&amp; 3
<br></span><br>The value returned is:
<br><br>0 - a purely serial device
<br><br>1 - a screen device
<br><br>2 - a file system device (ie. it supports file positioning)
<br><br>Any other values indicate that there is something wrong
<br>with the channel (if the value is >2) otherwise, a negative
<br>value means that the channel is not open.
<br><br><h3>NOTE:
<br></h3><br>Prior to v2.71, <span style="font-style: italic;">DEVTYPE</span> would return 'End of File' error if
<br>the specified channel was attached to a file and the file
<br>pointer was at the end of the file.
<br><br><h3>CROSS-REFERENCE:<br></h3><br><a style="font-style: italic;" href="KeywordsO.html#OPEN">OPEN</a>, <a style="font-style: italic;" href="KeywordsO.html#OPEN_IN">OPEN_IN</a>, <a style="font-style: italic;" href="KeywordsO.html#OPEN_NEW">OPEN_NEW</a> and <a style="font-style: italic;" href="KeywordsO.html#OPEN_OVER">OPEN_OVER</a> allow you to open channels.
<br><hr style="width: 100%; height: 2px;"><h1><a name="DEV_LIST"></a>DEV_LIST</h1><br>Syntax: <span style="font-style: italic;">DEV_LIST</span> [<span style="font-style: italic;">#channel</span>]
Location: <span style="font-style: italic;">DEV device, GOLD CARD, ST/QL, SMS
<br></span><br>This command lists all <span style="font-style: italic;">DEV_USE</span> definitions to the given
<br><span style="font-style: italic;">channel</span>, default #1.
<br><br>You can also use a public domain utility, DEV Manager, to
<br>set and list DEV definitions on a per-program basis.
<br><br><h3>Example:
<br></h3><span style="font-style: italic;">DEV_LIST</span> for example 4a of <span style="font-style: italic;">DEV_USE</span> prints:
<br><span style="font-style: italic;">DEV1_ FLP2_SOURCES_ -> DEV4_DEV2_ FLP1_COMPILER_ -> DEV3_DEV3_ FLP1_COMPILER_UTILS_ ->
<br>DEV4_DEV4_ RAM1_ -> DEV5_ DEV5_ FLP1_SOURCES_OTHER_ -> DEV1_
<br></span><br><h3>CROSS-REFERENCE:<br></h3><br><a style="font-style: italic;" href="KeywordsD.html#DEV_USE">DEV_USE</a>, <a style="font-style: italic;" href="KeywordsD.html#DEV_USE$">DEV_USE$</a>, <a style="font-style: italic;" href="KeywordsD.html#DEV_NEXT
">DEV_NEXT
</a><br>Compare <a style="font-style: italic;" href="KeywordsD.html#DEVLIST">DEVLIST</a> and <a style="font-style: italic;" href="KeywordsD.html#DLIST">DLIST</a>.
<br><hr style="width: 100%; height: 2px;"><h1><a name="DEV_NEXT"></a>DEV_NEXT</h1><br>Syntax: <span style="font-style: italic;">DEV_NEXT (n)</span>     <span style="font-style: italic;">n</span>=1..8
Location: <span style="font-style: italic;">DEV device, GOLD CARD, ST/QL, SMS
<br></span><br>The function <span style="font-style: italic;">DEV_NEXT</span> returns the number of the next <span style="font-style: italic;">DEV</span>ice
<br>where a given <span style="font-style: italic;">DEV</span> will look on next if a file was not found. If
<br>a <span style="font-style: italic;">DEV</span> is not defined or has the search option disabled,
<br><span style="font-style: italic;">DEV_NEXT</span> returns zero (0), otherwise an integer from 1 to 8 will
<br>be returned.
<br><br><h3>Example:
<br></h3><br>A program which lists a search path:
<br><span style="font-style: italic;">100 INPUT "Which DEV device (1..8)?"!n
<br>110 IF n<1 OR n>8 THEN RUN
<br>120 DIM checked%(8)
<br>130 REPeat SPate
<br>140   IF NOT DEV_NEXT(n) OR checked%(n): EXIT SPate
<br>150   PRINT DEV_USE$(n)
<br>160   checked%(n)=1
<br>170   n=DEV_NEXT(n)
<br>180 END REPeat SPate
<br></span><br>If you understood this example, then you will know exactly
<br>how the <span style="font-style: italic;">DEV</span> device works.
<br><br><h3>CROSS-REFERENCE:<br></h3><br><a style="font-style: italic;" href="KeywordsD.html#DEV_USE$">DEV_USE$</a>, <a style="font-style: italic;" href="KeywordsD.html#DEV_LIST">DEV_LIST</a>, <a style="font-style: italic;" href="KeywordsD.html#DEV_USE
">DEV_USE
</a><br><h3>
<br></h3><hr style="width: 100%; height: 2px;"><h1><a name="DEV_USE"></a>DEV_USE</h1><br>Syntax: <span style="font-style: italic;">DEV_USE n,drive </span>[<span style="font-style: italic;">,next_dev</span>]   <span style="font-style: italic;"> n</span>=1..8
<br><br>or <span style="font-style: italic;">DEV_USE</span> [<span style="font-style: italic;">n</span>](SMS v2.70+ only)
<br><br>or <span style="font-style: italic;">DEV_USE</span> [<span style="font-style: italic;">drivetype</span>]
Location: <span style="font-style: italic;">DEV device, GOLD CARD, ST/QL, SMS
<br></span><br>The <span style="font-style: italic;">DEV</span> device is a universal method of driving devices
<br>(MDV, FLP, WIN, MOS, ROM), and thus allows old software to
<br>recognise  default  devices/  sub-directories  as  well  as
<br>simplifying  the  use  of  them.  It  also  introduces  fully
<br>programmable search paths to QDOS.
<br><br>There are eight separate <span style="font-style: italic;">DEV</span> drives available, DEV1_ to
<br>DEV8_, each of which can point to a real drive and directory
<br>defined with <span style="font-style: italic;">DEV_USE</span>.
<br><br>The first parameter of the command is the number of the <span style="font-style: italic;">DEV
<br></span>device  to  be  defined,  the  second  specifies  what  DEVn_
<br>represents. There is no default and nothing is predefined, but
<br><span style="font-style: italic;">DEV_USE</span> permits only valid drives and directories. Any default
<br>devices (<span style="font-style: italic;">DATAD$</span>, <span style="font-style: italic;">PROGD$</span> etc) are not recognised so the full
<br>directory name (including the drive name) must be stated.
<br><br>There is one special second parameter, the empty string,
<br>which removes the definition of the given <span style="font-style: italic;">DEV</span> device; there is
<br>no error reported if it was not defined.
<br><br>The second syntax also allows you to remove a definition by
<br>simply passing the number of the <span style="font-style: italic;">DEV</span> device to delete.
<br><br><h3>Example 1:
<br></h3><span style="font-style: italic;">DEV_USE 1,flp1_
<br>DEV_USE 2,flp1_SUBDIR_
<br>DEV_USE 3,flp1_SUBDIR
<br>DEV_USE 4
<br></span><br>Each time that DEV1_ is accessed, the actual drive which
<br>will be accessed is FLP1_, eg. <span style="font-style: italic;">DIR DEV1_</span> lists a directory of
<br>FLP1_. However,  <span style="font-style: italic;">LOAD  DEV2_BOOT</span> will  load  FLP1_SUBDIR_BOOT  but
<br>especially  note  that  <span style="font-style: italic;">LOAD  DEV3_BOOT</span>  would  try  to  load
<br>FLP1_SUBDIRBOOT (that's not a typing error). You can therefore
<br>see the importance of specifying the underscore!
<br><br>Whereas <span style="font-style: italic;">DATA_USE</span> always adds an underscore to the supplied
<br>parameter if there one was not specified, <span style="font-style: italic;">DEV_USE</span> does not.
<br>Please pay attention to this difference!
<br><br><span style="font-style: italic;">DEV_USE</span>'s third parameter is optional and ranges from 0 to 8.
<br>This is used to specify another <span style="font-style: italic;">DEV</span> device which should be
<br>tried if DEVn_ was accessed for a given file, but the file was
<br>not present on that <span style="font-style: italic;">DEV</span> device. In all other cases: if the
<br>drive in general is currently inaccessible (eg. open for
<br>direct sector read/write), the file is damaged or already in
<br>use, the <span style="font-style: italic;">DEV</span> device will stop with the appropriate error
<br>message, and behave as normal in such situations.
<br><br><h3>Example 2:
<br></h3><span style="font-style: italic;">DEV_USE 1,flp1_,2
<br>DEV_USE 2,flp1_TEST_
<br></span><br><span style="font-style: italic;">VIEW DEV1_Prog_bas</span> will first try to show FLP1_Prog_bas and if it
<br>did not find that file, it will then try  DEV2_Prog_bas which
<br>is actually FLP1_TEST_Prog_bas. If this also fails, <span style="font-style: italic;">VIEW</span> stops
<br>with a 'Not Found' error. You might notice that this could
<br>lead to an endless search if DEV2_ was told to jump back to
<br>DEV1_ if flp1_TEST_Prog_bas also did not exist:
<br><br><h3>Example 3:
<br></h3><span style="font-style: italic;">DEV_USE 1,flp1_,2
<br>DEV_USE 2,flp1_TEST_,1
<br></span><br>Luckily, this is no problem - the <span style="font-style: italic;">DEV</span> device never circles
<br>back to a <span style="font-style: italic;">DEV</span> which has already been tried. So, using the
<br>definition  given  for  example  3,  <span style="font-style: italic;">VIEW  DEV1_Prog_bas</span>  looks  for
<br>FLP1_Prog_bas, then FLP1_TEST_Prog_bas and breaks with 'Not
<br>Found' because DEV1_ has already been tested. That's why a <span style="font-style: italic;">DEV
<br></span>device cannot point to another <span style="font-style: italic;">DEV</span> device, <span style="font-style: italic;">DEV_USE 1,DEV2_</span> is
<br>illegal.
<br><br>It is advisable to give seldom used drives and directories
<br>a lower search priority because it naturally takes a little
<br>time to  scan  through  a directory  for  a  file.  Preferred
<br>directories and fast RAM disks (which take next to no time to
<br>check for a file) should be checked before the less often-used
<br>directories are looked at.
<br><br><h3>Example 4a:
<br></h3><span style="font-style: italic;">DEV_USE 1,flp2_SOURCES_,4
<br>DEV_USE 2,flp1_COMPILER_,3
<br>DEV_USE 3,flp1_COMPILER_UTILS_,4
<br>DEV_USE 4,ram1_,5
<br>DEV_USE 5,flp2_SOURCES_OTHER_,1
<br></span><br>The search path for DEV1_ is:-
<br><br>FLP2_SOURCES_    go to DEV4_
<br><br>RAM1_                   go to DEV5_
<br><br>FLP2_SOURCES_OTHER_     go  to  DEV1_,  we  already
<br>tried that, so stop
<br><br>The search path for DEV2_ is:-
<br><br>FLP1_COMPILER_go to DEV3_
<br><br>FLP1_COMPILER_UTILS_    go to DEV4_
<br><br>RAM1_                   go to DEV5_
<br><br>FLP2_SOURCES_OTHER_     go to DEV1_
<br><br>FLP2_SOURCES_    go  to  DEV4_  ,  already
<br>checked, so stop
<br><br>You see that the two search paths for DEV1_ and DEV2_ are
<br>connected in one way. This rather complicated example suggests
<br>that it would be useful to set the data and program device as
<br>follows:
<br><br><h3>Example 4b:
<br></h3><span style="font-style: italic;">DATA_USE DEV1_
<br>PROG_USE DEV2_
<br></span><br>Taking into account that Toolkit II tries the program
<br>device after failing to find a file on the data device, a <span style="font-style: italic;">VIEW
<br>TEXT</span> will first search through the DEV1_ list and then DEV2_
<br>(thus looking through all <span style="font-style: italic;">DEV</span>s) while <span style="font-style: italic;">EX PROG_exe</span> stops after
<br>checking DEV2_ and its connected <span style="font-style: italic;">DEV</span>s.
<br><br>All operations creating or deleting files will only check
<br>for the original <span style="font-style: italic;">DEV</span> definition and ignore the optional paths.
<br>This prevents files from being unintentionally deleted or
<br>overwritten.
<br><br>Given the settings of examples 4a and 4b, <span style="font-style: italic;">OPEN_IN #3,DEV1_TEXT
<br></span>will act as <span style="font-style: italic;">VIEW</span> did before whereas <span style="font-style: italic;">OPEN_NEW #3,DEV1_TEXT</span> creates
<br>FLP2_SOURCES_TEXT or reports an error/asks if you want to
<br>overwrite (if necessary).  <span style="font-style: italic;">DELETE</span> always behaves as an exception
<br>in that it does not report an error if a file was not found.
<br><br>You may have noticed that the third parameter allows a
<br>wider range than the <span style="font-style: italic;">DEV</span> number. A zero as the third parameter
<br>simply does the same as no third parameter.
<br><br>The third syntax of <span style="font-style: italic;">DEV_USE</span> is completely different from the
<br>first two. It is analogous to the <span style="font-style: italic;">FLP_USE</span>, <span style="font-style: italic;">RAM_USE</span> and <span style="font-style: italic;">NFS_USE
<br></span>commands and allows you to use a different three letter code
<br>for the <span style="font-style: italic;">DEV</span> device: <span style="font-style: italic;">DEV_USE</span> fry. DEV1_ is now called fry1_, DEV2_
<br>fry2_ and so on. However, you can also use existing devices:
<br><br><h3>Example 4c:
<br></h3><span style="font-style: italic;">DEV_USE FLP
<br></span><br>Now, things become really complex. With examples 4a and 4b
<br>still being valid, FLP1_ actually refers to FLP1_SOURCES_,
<br>searching through all the other DEV definitions as well in
<br>order  to  find  a  file.  The  definitions  of  DEV1_  as
<br>FLP1_SOURCES_ and DEVs as FLP do not collide. However, if you
<br>issued <span style="font-style: italic;">FLP_USE DEV</span>,  FLP1_ and DEV1_ are not known any more until
<br><span style="font-style: italic;">FLP_USE FLP</span> restores the default name for disk drives. Equally,
<br><span style="font-style: italic;">DEV_USE  DEV</span>  restores  the  DEV  name  (although  this  can  be
<br>abbreviated by a <span style="font-style: italic;">DEV_USE</span> without any parameters).
<br><br><h3>Example 5:
<br></h3><span style="font-style: italic;">DEV_USE
<br></span><br>DEV1_ refers to the true DEV1_ again, DEV2_, DEV3_, ...,
<br>too. Renaming DEV has been mainly implemented to convince
<br>existing software believing that a directory file always has
<br>five letters (eg.  MDV1_) to accept sub-directories of level-2
<br>drivers as directory files, too.
<br><br><h3>NOTE:
<br></h3><br>At  least up to v2.01, the <span style="font-style: italic;">DEV</span> device does not work fully on
<br>any machine. For example <span style="font-style: italic;">WSTAT</span> lists the file names but not the
<br>other information:
<br><span style="font-style: italic;">DEV_USE 1,FLP1_TEST_
<br>WSTAT DEV1_
<br></span><br><h3>CROSS-REFERENCE:<br></h3><br><a style="font-style: italic;" href="KeywordsD.html#DATA_USE">DATA_USE</a>, <a style="font-style: italic;" href="KeywordsP.html#PROG_USE">PROG_USE</a>,<a style="font-style: italic;" href="KeywordsD.html#DEV_USE$">DEV_USE$</a>, <a style="font-style: italic;" href="KeywordsD.html#DEV_NEXT">DEV_NEXT</a>.
<br><br><a style="font-style: italic;" href="KeywordsD.html#DEV_USEN">DEV_USEN</a> is the same as the third syntax on SMSQ/E.
<br><br><a style="font-style: italic;" href="KeywordsD.html#DEV_LIST">DEV_LIST</a> lists all DEV definitions.
<br><br><a style="font-style: italic;" href="KeywordsM.html#MAKE_DIR">MAKE_DIR</a> and the <a style="font-style: italic;" href="KeywordsD.html#DMEDIUM_">DMEDIUM_</a>xxx functions are also interesting.
<br><hr style="width: 100%; height: 2px;"><h1><a name="DEV_USEN"></a>DEV_USEN</h1><br>Syntax: <span style="font-style: italic;">DEV_USE</span>N [<span style="font-style: italic;">drivetype</span>]
Location: <span style="font-style: italic;">SMSQ/E
<br></span><br>This command is provided on SMSQ/E to allow you to alter
<br>the three letter reference used to access the <span style="font-style: italic;">DEV</span> devices.  If
<br>no parameter is specified, then the name reverts to <span style="font-style: italic;">DEV</span>.
<br><br><h3>Example:
<br></h3><span style="font-style: italic;">DEV_USE 2,'win1_progs_'
<br>DEV_USEN 'flp'
<br>DIR flp2_
<br></span><br>This will provide a directory of win1_progs_ - this can be
<br><br>reset with:
<br><span style="font-style: italic;">DEV_USEN
<br>DIR dev2_
<br></span><br><h3>CROSS-REFERENCE:<br></h3><br><a style="font-style: italic;" href="KeywordsD.html#DEV_USE">DEV_USE</a> allows you to do the same thing.
<br><br><a style="font-style: italic;" href="KeywordsF.html#FLP_USE">FLP_USE</a> allows you to alter the three letter description for
<br>floppy disks.
<br><hr style="width: 100%; height: 2px;"><h1><a name="DEV_USE$"></a>DEV_USE$</h1><br>Syntax: <span style="font-style: italic;">DEV_USE$ (n)</span>  where  <span style="font-style: italic;">n</span>=1..8
Location: <span style="font-style: italic;">DEV device, GOLD CARD, ST/QL, SMS
<br></span><br>The <span style="font-style: italic;">DEV_USE$</span> function returns the actual drive and directory
<br>for the number of a DEV device. If a device was not defined,
<br><span style="font-style: italic;">DEV_USE$</span> will return an empty string "", <span style="font-style: italic;">LEN(DEV_USE$(n))=0</span>.
<br><br><h3>Example:
<br></h3><br>A listing of all DEV definitions:
<br><span style="font-style: italic;">100 UNDER 1: PRINT "DEV";: UNDER 0
<br>110 PRINT "  ";: UNDER 1: PRINT "definition": UNDER 0
<br>120 found=0
<br>130 FOR n=1 TO 8
<br>140   IF LEN(DEV_USE$(n)) THEN
<br>150     PRINT n TO 5;DEV_USE$(n)
<br>160     found=1
<br>170   END IF
<br>180 END FOR n
<br>190 IF NOT found: PRINT "no DEVs defined"
<br></span><br><h3>CROSS-REFERENCE:<br></h3><br><a style="font-style: italic;" href="KeywordsD.html#DEV_NEXT">DEV_NEXT</a>, <a style="font-style: italic;" href="KeywordsD.html#DEV_LIST">DEV_LIST</a>,<a style="font-style: italic;" href="KeywordsD.html#DEV_USE">DEV_USE</a>.
<br><hr style="width: 100%; height: 2px;"><h1><a name="DIM"></a>DIM</h1><br>Syntax: <span style="font-style: italic;">DIM array (index1 </span><sup>*</sup>[<span style="font-style: italic;">index</span><sup>i</sup>]<sup>*</sup><span style="font-style: italic;"> ) </span><sup>*</sup>[<span style="font-style: italic;">,array</span><sup>j</sup><span style="font-style: italic;"> (index </span><sup>*</sup>[<span style="font-style: italic;">index</span><sup>j</sup>]<sup>*</sup><span style="font-style: italic;"> )</span>]<sup>*
<br></sup>Location: <span style="font-style: italic;">QL ROM
<br></span><br>The command <span style="font-style: italic;">DIM</span> allows you to set up one or more SuperBASIC
<br><span style="font-style: italic;">array</span>s which may be of string, integer or floating point type.
<br>Each <span style="font-style: italic;">index</span> must be an integer in the range 0...32767.
<br><br><h3>Numeric Arrays
<br></h3><br>Each <span style="font-style: italic;">index</span> defines the maximum number of elements (less one)
<br>in any one direction, which provides the following examples:
<br><span style="font-style: italic;">DIM a(10)
<br></span><br>sets up a floating-point array a containing 11 elements,
<br>a(0) to a(10);
<br><span style="font-style: italic;">DIM z%(10,10)
<br></span><br>sets up a two dimensional integer array z% containing 121
<br>elements, z%(0,0) to z%(10,10)
<br><br>Each element can hold a different number which can later be
<br>accessed by specific reference to each index. When the array
<br>is set up, each element is set to zero.
<br><br><h3>String Arrays
<br></h3><br>String arrays are peculiar and have various differences to
<br>both un-dimensioned strings and number arrays. In a string
<br>array, the final index contains the maximum length of a
<br>string, rounded up to the next even number (an attempt to
<br>assign a longer string to one of the array elements will
<br>result in a truncated string). For example:
<br><span style="font-style: italic;">DIM a$(10)
<br></span><br>sets up a one-dimensional string array <span style="font-style: italic;">a$</span> with a maximum of
<br>10 characters. This is similar to <span style="font-style: italic;">a$=FILL$(" ",10)</span>, except that a$
<br>now has a maximum length;
<br><span style="font-style: italic;">DIM z$(10,9)
<br></span><br>sets up a two-dimensional string array, which can hold 11
<br>strings (z$(0) to z$(10)), each up to 9 characters long.
<br><br>When a string array is set up with <span style="font-style: italic;">DIM</span> each entry is set to
<br>a nul string (""). The zero'th element of each string array
<br>contains the actual length of that string, for example:
<br><span style="font-style: italic;">DIM a$(10,10): a$(1)='Hello': PRINT a$(1,0)
<br></span><br>will return the value 5, as will <span style="font-style: italic;">PRINT LEN(a$(1))</span>.
<br><br>If <span style="font-style: italic;">a$</span> is undimensioned and <span style="font-style: italic;">a$='Hello World'</span>, <span style="font-style: italic;">PRINT a$(0)</span> does not
<br>generally work and will result in an 'Out of Range' error,
<br>except under SMS v2.60+ and Minerva where <span style="font-style: italic;">PRINT a$(0)</span> is the same
<br>as <span style="font-style: italic;">PRINT LEN(a$)</span>.
<br><br><h3>Sub-Sets of Arrays
<br></h3><br>Sub-sets of arrays can also be accessed, for example
<br><span style="font-style: italic;">PRINT z$(0 TO 2)
<br></span><br>will print the first three strings stored in the array z$.
<br><br><h3>Omitting Indices
<br></h3><br>This can be one of the most difficult parts of SuperBasic
<br>from the point of view of making programs compatible on all
<br>implementations of SuperBASIC and also making programs work
<br>the same under the interpreter and when compiled.  The ST/QL
<br>Emulators (with E-Init v1.27 or later) follow the same rules
<br>as SMS.
<br><br>If an index is omitted, SuperBASIC inserts a default index
<br>of:
<br><br><span style="font-style: italic;">0 TO DIMN (array,index_no)
<br></span><br>For example, if array is a two-dimensional array, array(1)
<br>is the same as using the form <span style="font-style: italic;">array (1,0 TO DIMN(array,2))</span>.
<br><br>Unfortunately, string arrays are slightly different when
<br>using the last index.  If the last index is omitted, this
<br>defaults to an index of:
<br><span style="font-style: italic;">1 TO LEN(array$(x))
<br></span><br>However, except on SMS, if a start descriptor is specified,
<br>but not an end one, the last index defaults once again to:
<br><span style="font-style: italic;">start_descriptor TO DIMN(array$,index_no)
<br></span><br>On SMS this defaults to <span style="font-style: italic;">start_descriptor TO LEN(array$(x)
<br></span><br>Even more oddly, except on SMS and Minerva, if a start
<br>descriptor is omitted, but an end descriptor specified, the
<br>index defaults to:<span style="font-style: italic;"> 0 TO end_descriptor
<br></span><br>normally resulting in an error.
<br><br>(On SMS and Minerva this defaults to <span style="font-style: italic;">1 TO end_descriptor</span>)
<br><br>However, except on SMS and Minerva, if neither a start nor
<br>end descriptor are specified, but the <span style="font-style: italic;">TO</span> itself is specified,
<br>this defaults to<span style="font-style: italic;"> 0 TO DIMN (array$,index_no)</span>, again normally causing an
<br>error.
<br><br>On SMS this defaults to <span style="font-style: italic;">1 TO LEN (Array$ (x)
<br></span><br>On Minerva this defaults to <span style="font-style: italic;">1 TO DIMN (array$,index_no)
<br></span><br>This creates the following result:
<br><span style="font-style: italic;">DIM a$(10):a$='Hello'
<br>INK 7:PAPER 0
<br>STRIP 2
<br>PRINT a$
<br></span><br>Prints 'Hello' - a$ (1 TO LEN(a$)
<br><br>(On all implementations)
<br><span style="font-style: italic;">PRINT a$(1 TO)
<br></span><br>Prints 'Hello     '       - a$(1 TO DIMN(a$,1))
<br><br>(except on SMS, where it prints 'Hello', unless the program
<br>is compiled with Qliberator in which case the original system
<br>is adopted).
<br><span style="font-style: italic;">PRINT a$(TO)
<br></span><br>Results in 'Out of Range' - a$(0 TO DIMN(a$,1))
<br><br>(except on SMS, where it prints 'Hello', and on Minerva
<br>where it prints 'Hello     '
<br><br>In both cases, if the program is compiled with Qliberator
<br>it still reports an error).
<br><span style="font-style: italic;">PRINT a$( TO 5)
<br></span><br>Results in 'Out of Range' - a$(0 TO 5)
<br><br>(again on SMS and Minerva it still prints 'Hello', unless
<br>the program is compiled with Qliberator, which reports an
<br>error).
<br><br><h3>Un-Dimensioned Strings
<br></h3><br>You  can  use  sub-sets  of  un-dimensioned  strings,  for
<br>example:
<br><br><span style="font-style: italic;">a$='Hello World':PRINT a$(1 TO 5)
<br></span><br>However, such subsets are always treated as expressions,
<br>which means that if such a subset was passed as a parameter to
<br>a <span style="font-style: italic;">FuNction</span> or <span style="font-style: italic;">PROCedure</span> (see <span style="font-style: italic;">DEFine FuNction</span>), it cannot be passed by
<br>reference  and  the  string  will  remain  unaltered  by  the
<br><span style="font-style: italic;">FuNction</span>/<span style="font-style: italic;">PROCedure</span>.  Compare this with a sub-set of a string array,
<br>which will be altered (this sub-set exists as a sub-array).
<br>Please see Example 3 below.
<br><br>The  handling  of  descriptors  is  also  different  with
<br>un-dimensioned  strings.  If  neither  a  start  nor  an  end
<br>descriptor are specified, this, like string arrays, defaults
<br>to:
<br><span style="font-style: italic;">1 TO LEN(string$)
<br></span><br>However, if the start descriptor is specified, but not the
<br>end descriptor, this defaults to:
<br><span style="font-style: italic;">start_descriptor TO LEN(string$)
<br></span><br>However, if the start descriptor is omitted (whether the
<br>end descriptor is specified or just TO is used), unless you
<br>have Minerva or SMS, this defaults to:
<br><span style="font-style: italic;">0 TO end_descriptor
<br></span><br>and
<br><span style="font-style: italic;">0 TO LEN(string$)
<br></span><br>respectively, both of which cause an 'out of range' error.
<br><br>On Minerva and SMS however, this defaults to:
<br><span style="font-style: italic;">1 TO end_descriptor
<br></span><br>and
<br><span style="font-style: italic;">1 TO LEN(string$)
<br></span><br>respectively, thus avoiding this error.
<br><br>This leads to the following result:
<br><br><span style="font-style: italic;">CLEAR: x$='Hello'
<br></span><br><span style="font-style: italic;">INK 7: PAPER 0: STRIP 2 PRINT x$
<br></span><br>This Prints 'Hello'
<br><span style="font-style: italic;">PRINT x$(1 TO)</span>This prints 'Hello'
<br><span style="font-style: italic;">PRINT x$(TO)            </span>This results in 'Out of Range'
<br>or 'Hello' on Minerva and SMS.
<br><span style="font-style: italic;">PRINT x$( TO 10)</span>This results in 'Out of Range'
<br>or 'Hello' on Minerva and SMS.
<br><br><h3>ERRORS
<br></h3><br>Due to the complexity of <span style="font-style: italic;">DIM</span>, we felt that it would be
<br>useful to explain some of the various errors which may be
<br>reported.  SMS has an improved Interpreter which reports more
<br>intelligible error codes, therefore those have been used:
<br><br><h3>'Only arrays may be dimensioned'
<br></h3><br>This occurs when you try to <span style="font-style: italic;">DIM</span> the name of a procedure or
<br>function.  It also occurs if you try to use <span style="font-style: italic;">DIM</span> on one of the
<br>parameters of a procedure or function and that parameter is
<br>not itself a dimensioned variable:
<br><span style="font-style: italic;">100 DIM x(10)
<br>110 c=1:test x,1
<br>130 DEFine PROCedure test (a,b)
<br>140 DIM b(10)
<br>150 END DEFine
<br></span><br>On other implementations, 'Bad Name' is reported in both
<br>instances.
<br><br><h3>'Procedure and function parameters may not be dimensioned'
<br></h3><br>This only happens as in the example above where you try to
<br><span style="font-style: italic;">DIM</span>ension a variable which is in fact one of the parameters
<br>from the <span style="font-style: italic;">DEFine PROCedure</span> or <span style="font-style: italic;">DEFine FuNction</span> line (eg. line 140).  Here,
<br>if you pass a dimensioned variable, eg: <span style="font-style: italic;">TEST 1,x</span>, you get this
<br>error under SMS.  Also see note 7.
<br><br>On other implementations no error is reported and the
<br>problems listed in Note 7 occur.
<br><br><h3>'SBASIC cannot put up with negative dimensions'
<br></h3><br>This occurs if you try to use a negative <span style="font-style: italic;">index</span>, for example:
<br><span style="font-style: italic;">DIM x(-10)
<br></span><br>On other implementations 'Out of Range' is reported.
<br><br><h3>'Dimensional overflow - you cannot be serious!'
<br></h3><br>Too many indices have been specified in the <span style="font-style: italic;">DIM</span> statement -
<br>refer to Appendix 8.
<br><br><h3>'Error in Expression'
<br></h3><br>SMS has either been unable to make any sense of the <span style="font-style: italic;">index</span>,
<br>or else it exceeds 32767.
<br><br>On other ROMs you will get the error 'Overflow' if <span style="font-style: italic;">index
<br></span>exceeds 32767.
<br><br><h3>'Unknown function or array'
<br></h3><br>This is generally reported of you try to use a Procedure
<br>name as the <span style="font-style: italic;">index</span>.
<br><br>Other implementations report 'Error in Expression'
<br><h3><br>Example 1:
<br></h3><br>A program which acts as a simple quiz program, but shows
<br><br>off some of the best features of using arrays - it is
<br><br>simplicity itself to add new questions and answers to this
<br><br>quiz (just amend <span style="font-style: italic;">quest</span> and <span style="font-style: italic;">target</span> and add the new questions
<br><br>and answers as <span style="font-style: italic;">DATA</span> at the end of the program):
<br><span style="font-style: italic;">100 MODE 8:WINDOW 512,256,0,0:PAPER 0:CLS
<br>110 WINDOW 448,200,32,16
<br>120 quest=5:target=5
<br>130 DIM question$(quest,50),option$(quest,3,25),answer(quest)
<br>140 RESTORE
<br>150 FOR i=0 TO quest-1
<br>160   READ question$(i)
<br>170   FOR j=1 TO 3:READ option$(i,j)
<br>180   READ answer(i)
<br>190 END FOR i
<br>200 REPeat main_loop
<br>210   score=0
<br>220   FOR i=1 TO 7,1:BORDER 10,i:PAUSE 2
<br>230   PAPER 6:CLS:INK 2:AT 3,10:UNDER 1:CSIZE 2,1
<br>240   PRINT 'QUIZ EXAMPLE':CSIZE 2,0:UNDER 0
<br>250   INK 0:AT 0,20:PRINT 'SCORE = ';score
<br>260   DIM asked(quest)
<br>270   REPeat loop
<br>280     opt=RND(1 TO quest)
<br>290     IF asked(opt)=1 THEN
<br>300       FOR j=1 TO quest
<br>310         IF asked(j)=0:opt=j:EXIT j
<br>320       NEXT j
<br>330         DIM asked(quest):NEXT loop
<br>340       END FOR j
<br>350     END IF
<br>360     asked(opt)=1
<br>370     AT 4,0:CLS 2
<br>380     ask_question(opt)
<br>390     reply=get_answer
<br>400     AT 16,0:PAPER 2:INK 7
<br>410     IF reply=answer(opt-1)
<br>420        PRINT 'Correct':score=score+1
<br>430     ELSE
<br>440        PRINT 'Wrong!':score=score-1
<br></span><br><h3>
<br></h3><span style="font-style: italic;">450     END IF
<br>460     PAPER 6:INK 0
<br>470     AT 0,20:PRINT 'SCORE = ';score
<br>480     PAUSE
<br>490     IF score=target OR score<0:EXIT loop
<br>500   END REPeat loop
<br>510   PAPER 0:CLS
<br>520   INK 2+2*(score=target):CSIZE 3,1
<br>530   IF score=target
<br>540     PRINT 'Congratulations'
<br>550   ELSE
<br>560     PRINT 'Oh Dear'
<br>570   END IF
<br>580   CSIZE 2,0:INK 7
<br>590   PRINT \\'Try again?? -----> y/n'
<br>600   REPeat keys
<br>610     key$=INKEY$(-1):IF key$ INSTR 'yn':EXIT keys
<br>620   END REPeat keys
<br>630   IF key$=='n':STOP
<br>640 END REPeat main_loop
<br>645 :
<br>650 DEFine PROCedure ask_question(no)
<br>660 LOCal i
<br>670 AT 6,0:start_word=1:end_word=1
<br>680 no=no-1
<br>690 REPeat quest_loop
<br>700   FOR char=start_word TO question$(no,0)
<br>710     IF question$(no,char)=' ':EXIT char
<br>720   END FOR char
<br>730   end_word=char
<br>740   PRINT !question$(no,start_word TO end_word)!
<br>750   IF end_word=question$(no,0):EXIT quest_loop
<br>760   start_word=end_word+1
<br>770 END REPeat quest_loop
<br>780 REPeat opt_loop
<br>790 PRINT \\
<br>800 FOR i=1 TO 3
<br>810   PRINT TO 5;i;' = ';option$(no,i)
<br>820 END FOR i
<br>830 END DEFine
<br>835 :
<br>840 DEFine FuNction get_answer
<br>850 REPeat keys
<br>860   key$=INKEY$(-1)
<br>870   IF key$ INSTR '123':RETurn key$
<br>880 END REPeat keys
<br>890 END DEFine
<br>895 :
<br>900 DATA 'The standard Sinclair QL has how much memory?'
<br>910 DATA '16K','128K','640K',2
<br>920 DATA "What was the name of Sinclair's first computer?"
<br>930 DATA 'Z80','ZX81','ZX80',3
<br>940 DATA 'Who is the main person responsible for QDOS?'
<br>950 DATA 'T.Tebby','J.Jones','C.Sinclair',1
<br>960 DATA "Which company created the QL's Gold Card?"
<br>970 DATA 'Miracle Ltd.','Digital Precision Ltd.','Mercury',1
<br>980 DATA 'Who is the main person responsible for SuperBASIC?'
<br>990 DATA 'T.Tebby','J.Jones','C.Sinclair',2
<br></span><br><h3>
<br></h3><br>Some  of  you  may  have  noticed  that  we  have  used  <span style="font-style: italic;">DIM
<br><br>option$(quest,3,25)</span> when we could have used <span style="font-style: italic;">DIM option$(quest,2,25)</span>. The
<br><br>reason for this is to make it easier to check the text -
<br><br>try <span style="font-style: italic;">PRINT option$</span> and you will see that each set of three
<br><br>options is separated by a blank string.
<br><br><h3>Example 2:
<br></h3><br>Take the two arrays set up with <span style="font-style: italic;">DIM x(2,3,4),x$(2,4,6)</span>.
<br><br>The following sub-arrays produce the following equivalents:
<br><span style="font-style: italic;">x(TO, TO 2, 1 TO) => x(0 TO 2,0 TO 2,1 TO 4)
<br>x$(1 TO 2, TO 2)  => x$(1 TO 2,0 TO 2,1 TO LEN(x$(..)))
<br>x$(TO 2, TO,1 TO) => x$(0 TO 2,0 TO 4,1 TO 6)
<br></span><br><h3>Example 3:
<br></h3><br>A short example of the use of sub-arrays and subsets of
<br><br>undimensioned strings:
<br><span style="font-style: italic;">100 DIM a$(11)
<br>110 a$='Hello World'
<br>120 b$='Great World'
<br>130 swap_array a$(1 TO 5),b$(1 TO 5)
<br>140 PRINT a$,b$
<br>150 :
<br>1000 DEFine PROCedure swap_array (a,b)
<br>1010  c$=b:b=a:a=c$
<br>1020 END DEFine
<br></span><br><h3>NOTE 1:
<br></h3><br>The Turbo compiler alters <span style="font-style: italic;">DIM</span> in compiled programs to enable
<br>you to  re-dimension  arrays without  losing  their  original
<br>contents.  You  may  therefore  need  to  physically  set  the
<br>contents of arrays to zero (or nul strings) to ensure that a
<br>program works properly when compiled.
<br><br><h3>NOTE 2:
<br></h3><br>On AH ROMs, a floating point array is limited to 384K size.
<br><br><h3>NOTE 3:
<br></h3><br>A variable cannot be used as both a simple variable and an
<br>array variable. It is set to an array variable as soon as the
<br>line containing the relevant <span style="font-style: italic;">DIM</span> statement is parsed. This
<br>means that if a line containing <span style="font-style: italic;">DIM var</span> has been entered,  the
<br>array <span style="font-style: italic;">var</span> cannot be used until such time as the program has <span style="font-style: italic;">RUN
<br></span>this line, and in any case, an attempt to use <span style="font-style: italic;">var</span> without array
<br>descriptors (eg.<span style="font-style: italic;"> var=1</span>) is likely to fail, either resulting in a
<br>'Bad Name' error or 'Error in Expression'.
<br><br><h3>NOTE 4:
<br></h3><br>You cannot assign one array to another. For example:
<br><br><span style="font-style: italic;">DIM a$ (3,10) , z$ (3,10) :z$=a$
<br></span><br>will report a 'Not Implemented' error. Compare
<br><span style="font-style: italic;"><br>z$ ( 1, 1 TO 10 )=a$ ( 1, 1 TO 10 )</span>.
<br><br><h3>NOTE 5:
<br></h3><br>The Turbo and Supercharge compilers insist that strings are
<br>all dimensioned as string arrays. They do however also alter
<br>the way in which string arrays work so that they operate more
<br>like un-dimensioned strings. Un-dimensioned strings may also
<br>upset Qliberated tasks!
<br><br><h3>NOTE 6:
<br></h3><br>On pre JS ROMs you cannot use one array as the array
<br>sub-script of another in the <span style="font-style: italic;">DIM</span> statement (other than as the
<br>first sub-script), for example:
<br><br><span style="font-style: italic;">DIM a(10):a(3)=10
<br><br>DIM a$(10,a(3))
<br></span><br>If  you  try  this,  you  will  find  that  previous  array
<br>sub-scripts are set to the value 0, ie. using the above
<br>example, <span style="font-style: italic;">a$(0)</span> would be acceptable, whereas <span style="font-style: italic;">a$(2)</span> would cause an
<br>error. This will work okay provided that the array is used as
<br>the first sub-script, otherwise use a temporary variable.
<br><br>For example:
<br><br><span style="font-style: italic;">subs=a(3):DIM a$(10,subs)
<br><br>DIM a$(a(3),10)
<br></span><br>would both work okay on all ROM versions.
<br><br><h3>NOTE 7:
<br></h3><br>There is a bug in SMS (at least up to v2.88) if you try to
<br><span style="font-style: italic;">DIM</span>ension a variable which has been used as a parameter for a
<br><span style="font-style: italic;">PROCedure</span> or <span style="font-style: italic;">FuNction</span> call.
<br><br>Take the example given above to demonstrate the error
<br>'procedure and function parameters may not be dimensioned'.
<br>Now use <span style="font-style: italic;">CLEAR : TEST a,b</span> - no error is reported (although line 140
<br>has no effect). <span style="font-style: italic;">PRINT a,b</span> is equivalent to <span style="font-style: italic;">PRINT a; </span>and any attempt
<br>to use <span style="font-style: italic;">b</span> (eg. <span style="font-style: italic;">x=b</span>) reports error in expression, even after <span style="font-style: italic;">CLEAR</span>.
<br><br>On other ROMs no error is reported. However, the variable
<br>passed as a parameter is not re-dimensioned, but some of its
<br>elements will no longer be the original value, but very small
<br>numbers and any attempt to assign another value to those
<br>elements which have been changed may in fact fail!!
<br><br><h3>NOTE 8:
<br></h3><br>Current versions of Qliberator treat all strings in the
<br>same way as on the original QL, therefore although a program
<br>may RUN fine under the SMS or Minerva intepreter, it may cause
<br>problems when compiled.
<br><br>The TURBO and SuperCHARGE compilers treat strings the same
<br>as SMS, except see Note 1 and Note 5.
<br><br><h3>MINERVA NOTE:
<br></h3><br>Minerva alters the way in which both dimensioned and
<br>undimensioned strings are handled so that <span style="font-style: italic;">PRINT a$( TO 10)</span> is now
<br>acceptable!  See above.
<br><br>Minerva also allows you to slice expressions and numbers.
<br><br>Lines such as <span style="font-style: italic;">PRINT 'abcd' (2 TO 3)</span> and <span style="font-style: italic;">a$=101010 (3)</span> will now work.
<br><br>Minerva v1.96+ allows multiple index lists (see SMS Notes).
<br><br><h3>SMS NOTES:
<br></h3><br>SMS  alters  the  way  in  which  both  undimensioned  and
<br>dimensioned strings are handled to make them more sensible
<br>(see above).  We now await a compiler which handles strings in
<br>the same way!
<br><br>SMS says that it no longer handles multiple index lists on
<br>assignments (which apparently were allowed on earlier ROM
<br>versions - did anyone ever use these?).  An example is the
<br>line:
<br><span style="font-style: italic;">100 DIM a$(3,4,5)
<br>110 a$(3,4)='Hello'
<br>120 a$(3,4)(2 TO 5)='ELLO'
<br></span><br>SMS will not let you type in line 120 reporting invalid
<br>syntax.  To overcome this you have to replace the line with:
<br><span style="font-style: italic;">120 a$(3,4,2 TO 5)='ELLO'
<br></span><br>In common with Minerva, SMS will now also allow you to
<br>slice expressions and numbers.
<br><br>There is a bug in current versions of SMS (at least up to
<br>v2.90) when passing string array sub-sets by reference, for
<br>example the following program:
<br><span style="font-style: italic;">5 DIM x$(11)
<br>10 x$='Hello World'
<br>15 PRINT x$
<br>20 change x$(1 TO 11)
<br>30 PRINT x$
<br>1000 DEFine PROCedure change (a$)
<br>1010 a$(1 TO 3)='EXT'
<br>1020 END DEFine
<br></span><br>At line 30, <span style="font-style: italic;">x$</span> is shown to be 'HeEXT World'??  It should be
<br><br>'EXTlo World' - try making line 20 read:<span style="font-style: italic;"> 20 change x$
<br></span><br>Although v2.90 fixes this problem, if you pass a sub-set of
<br>an undimensioned string, a worse problem is created - try
<br>deleting line 5 and adding line: <span style="font-style: italic;">1015 PRINT a$:PAUSE</span> before <span style="font-style: italic;">RUN</span>ning
<br>the program (you may need to use <span style="font-style: italic;">CLEAR</span> beforehand).
<br><br><h3>WARNING:
<br></h3><br><span style="font-style: italic;">DIM</span> and dimensioned variables can crash the system in
<br>certain instances - refer to A8.4 for details of the possible
<br>problems and more error messages which can be generated.
<br><br><h3>CROSS-REFERENCE:<br></h3><br><a style="font-style: italic;" href="KeywordsD.html#DIMN">DIMN</a> allows you to find out the maximum sizes of an array.
<br><br>Please see the Appendix on Compatability concerning String
<br>Lengths.
<br><br><a style="font-style: italic;" href="KeywordsL.html#LEN">LEN</a> allows you to find the length of a string.
<br><hr style="width: 100%; height: 2px;"><h1><a name="DIMN"></a>DIMN</h1><br>Syntax: <span style="font-style: italic;">DIMN (array </span>[<span style="font-style: italic;">,dimension</span>]<span style="font-style: italic;"> )
<br></span><br>or <span style="font-style: italic;">DIMN (array (dimension</span><sup>1</sup><span style="font-style: italic;"> </span><sup>*</sup>[<span style="font-style: italic;">,dimension</span><sup>i</sup>]<sup>*</sup><span style="font-style: italic;">)</span> )
Location: <span style="font-style: italic;">QL ROM
<br></span><br>This function allows you to investigate the size of the
<br>given index of a specified array.  The first syntax is the
<br>most common: it will return the specified <span style="font-style: italic;">dimension</span> (index) used
<br>in the original <span style="font-style: italic;">DIM</span> statement when the array was defined. If
<br>the index did not exist, then a result of zero is returned. If
<br><span style="font-style: italic;">dimension</span> is not specified, then the size of the first index is
<br>returned.
<br><br>The second syntax is somewhat obscure and has no practical
<br>advantages. This second syntax will not allow you to access
<br>the size of the first index. It works by reference to the
<br>array itself, for example,
<br><span style="font-style: italic;">PRINT DIMN(a$(1))
<br></span><br>will return the size of the second index, and
<br><span style="font-style: italic;">PRINT DIMN(a$(1,1))
<br></span><br>will return the size of the third index and so forth. Once
<br>the number of dimensions used within the <span style="font-style: italic;">DIMN</span> statement has
<br>reached the number used by the array, then the value 1 will be
<br>returned. If any more are specified, then the error 'Out of
<br>Range' will result.
<br><br><h3>Examples:
<br></h3><br>Take an array created with the statement:
<br><br><span style="font-style: italic;">DIM a$(10,12)
<br></span><br>the following results will be returned:
<br><br><span style="font-style: italic;">PRINT DIMN(a$)</span>Will return 10
<br><br><span style="font-style: italic;">PRINT DIMN(a$,1)</span>Will return 10
<br><br><span style="font-style: italic;">PRINT DIMN(a$,2)</span>Will return 12
<br><br><span style="font-style: italic;">PRINT DIMN(a$,3)</span>Will return 0
<br><br><span style="font-style: italic;">PRINT DIMN(a$(1))</span>Will return 12
<br><br><span style="font-style: italic;">PRINT DIMN(a$(1,1))</span>Will return 1
<br><br><span style="font-style: italic;">PRINT DIMN(a$(1,1,1))</span> Will cause 'Out of Range'
<br>error.
<br><br><h3>CROSS-REFERENCE:<br></h3><br><a style="font-style: italic;" href="KeywordsL.html#LEN">LEN</a> will return the actual length of characters held within
<br>a string.
<br><br><a style="font-style: italic;" href="KeywordsD.html#DIM">DIM</a> initialises an array.
<br><hr style="width: 100%; height: 2px;"><h1><a name="DIR"></a>DIR</h1><br>Syntax: <span style="font-style: italic;">DIR </span>[<span style="font-style: italic;">#channel,</span>]<span style="font-style: italic;"> device
<br></span><br>or <span style="font-style: italic;">DIR </span>[<span style="font-style: italic;">#channel,</span>] [<span style="font-style: italic;">device</span>] <span style="font-style: italic;">(Toolkit II)
<br></span><br>or <span style="font-style: italic;">DIR \file</span> [<span style="font-style: italic;">,device</span>]      <span style="font-style: italic;">(Toolkit II)
<br></span>Location: <span style="font-style: italic;">QL ROM, Toolkit II
<br></span><br>This command produces a listing to the specified <span style="font-style: italic;">channel
<br></span>(default #1) of all of the files contained on the given
<br>device. The listing gives the name of the <span style="font-style: italic;">device</span> (specified with
<br><span style="font-style: italic;">FORMAT</span>) followed by the number of available sectors/the number
<br>of usable sectors; followed by a list of the files in the
<br>order they appear on the disk.
<br><br>If you try to get a directory of a ram disk, eg. <span style="font-style: italic;">DIR RAM1_
<br></span>then the name of the device shown on screen will be RAM1.
<br><br>If Toolkit II is present, and <span style="font-style: italic;">#channel</span> is a window, a
<br>&lt;CTRL&gt;&lt;F5&gt; keystroke (pausing output) is generated at the end
<br>of each screen full of the listing.  You can however also use
<br>the third syntax to output the directory to the specified
<br>file.  If <span style="font-style: italic;">file</span> already exists, you will be given the option of
<br>overwriting it.  If <span style="font-style: italic;">file</span> doesn't include a device name, the data
<br>default directory is used.
<br><br>The Toolkit II variant also supports the default data
<br>directory, which will be used if no device name is given in
<br><span style="font-style: italic;">device</span>, or if the specified device name would result in the
<br>error 'Not Found'.
<br><br>If you have Level-2 or Level-3 device drivers, and there
<br>are any sub-directories (created with <span style="font-style: italic;">MAKE_DIR</span>) in the given
<br>directory, then if you have Toolkit II present, the names of
<br>these sub-directories will appear with the suffix ->. You can
<br>then list the contents of these sub-directories by using <span style="font-style: italic;">DIR
<br></span>with  the  original  device  name  plus  the  name  of  the
<br>sub-directory.
<br><br>Level-3 drivers take this one step further in that after
<br>the name of the disk in the specified <span style="font-style: italic;">device</span>, appears details of
<br>the type of disk being read, ie. MS-DOS or QDOS followed by
<br>SD, DD, HD or ED to confirm whether the disk is Single
<br>Density, Double Density, High Density or Extra Density.  RAM
<br>disks are listed as QDOS SD.
<br><br><h3>Example 1:
<br></h3><br>With a cartridge in the left hand microdrive slot, <span style="font-style: italic;">DIR mdv1_
<br></span><br>might produce the following listing in window #1:
<br><br>QUILL
<br><br>102/220 sectors
<br><br>boot
<br><br>QUILL
<br><br>install_exe
<br><br>printer_dat
<br><br><h3>Example 2:
<br></h3><br>If Level-2 device drivers are present, <span style="font-style: italic;">DIR flp1_</span> might produce
<br><br>the following:
<br><br>PSION DISK
<br><br>1000/2880 sectors
<br><br>QUILL ->
<br><br>ARCHIVE ->
<br><br>With Level-3 drivers, you would get the same output except
<br><br>the first line would become:
<br><br>PSION DISK QDOS HD
<br><br><span style="font-style: italic;">DIR 'flp1_QUILL'</span> would on both Level-2 and Level-3 drivers, then
<br>produce the following output:
<br><br>PSION DISK
<br><br>1000/2880 sectors
<br><br>QUILL_boot
<br><br>QUILL_QUILL
<br><br>QUILL_install_exe
<br><br>QUILL_printer_dat
<br><br><h3>NOTE 1:
<br></h3><br>With  the  Toolkit  II  variant,  the  &lt;CTRL&gt;&lt;F5&gt;  will  be
<br>generated even where the channel is a window which has been
<br>opened over the network (eg. n1_scr_200x200), which can cause
<br>problems as the slave machine will wait for a key to be
<br>pressed! This can be avoided if you have the command <span style="font-style: italic;">FIXPF
<br></span>(provided as part of the QPTR documentation), which will
<br>enable you to re-install the ROM variant of <span style="font-style: italic;">DIR</span>. Alternatively
<br>write the directory to a file and copy the file to the host
<br>machine, eg.
<br><span style="font-style: italic;"><br>DIR \ram1_tmp, flp1_SPL ram1_tmp TO n1_scr_200x200
<br></span><br>It is even more sophisticated to use a named pipe instead
<br>of the temporary file ram1_tmp for the same job:
<br><br><span style="font-style: italic;">SPL pipe_dir TO n1_scr_200x200
<br><br>DIR \pipe_dir_1000, flp1_
<br></span><br><h3>NOTE 2:
<br></h3><br>The THOR XVI retains the original QL ROM variant of this
<br>command, which does not support the default device, nor does
<br>it show sub-directory names.
<br><br><h3>NOTE 3:
<br></h3><br>Unless you have Toolkit II present, the Break key will not
<br>have any effect on <span style="font-style: italic;">DIR</span>. Press Break when the listing pauses at
<br>the end of a page under Toolkit II (Minerva v1.78+ is supposed
<br>to recognise the Break key, but it does not appear to work).
<br>The Break key is however recognised in Minerva v1.97 (at
<br>least!).
<br><br><h3>NOTE 4:
<br></h3><br>Prior to Toolkit II v2.25, <span style="font-style: italic;">DIR</span> of a Level-2 device driver
<br>could  cause  problems  when  used  inside  a  TURBO  compiled
<br>program.
<br><br><h3>NOTE 5:
<br></h3><br>If a directory contains a file with a null string as a name
<br>(eg. <span style="font-style: italic;">SAVE flp1_</span>), this file will not be listed on the directory
<br>listing.  This was used as a form of copy protection on some
<br>early QL software, but stops the program from working on a QL
<br>with Level-2 or Level-3 Device Drivers as they use this file
<br>to store the main directory!
<br><br><h3>NOTE 6:
<br></h3><br>On some versions of Toolkit II, the third variant could
<br>cause problems if you supply the name of an existing file to
<br>store the directory in, for example:
<br><br><span style="font-style: italic;">DIR \ram1_XDIR
<br></span><br>- if you said 'N' when asked if it was OK to Overwrite the
<br>existing file - the display would be sent to #0 and #0 would
<br>then be <span style="font-style: italic;">CLOSE</span>d!!  v2.49 of Toolkit II (and possibly earlier)
<br>does not cause any problems but does not report an error.
<br>v2.85 of SMSQ/E (and possibly  earlier) also has no problems
<br>but reports the error 'Already Exists'.
<br><br><h3>NOTE 7:
<br></h3><br>Some people try to divide up <span style="font-style: italic;">DIR</span>ectory listings by creating
<br>files such as : <span style="font-style: italic;">SAVE 'flp1_----------------'</span>.  However, <span style="font-style: italic;">DIR</span> will only
<br>list the files in the order in which they were created if you
<br>are using a virgin disk which has not had other files deleted
<br>from it already.
<br><br><h3>CROSS-REFERENCE:<br></h3><br><a style="font-style: italic;" href="KeywordsD.html#DATA_USE">DATA_USE</a> sets the current data default directory, <a style="font-style: italic;" href="KeywordsM.html#MAKE_DIR
">MAKE_DIR
</a>creates sub-directories, <a style="font-style: italic;" href="KeywordsW.html#WDIR">WDIR</a> allows wildcard names.
<br><hr style="width: 100%; height: 2px;"><h1><a name="DISCARD"></a>DISCARD</h1><br>Syntax: <span style="font-style: italic;">DISCARD </span>[<span style="font-style: italic;">adr</span>]
Location: <span style="font-style: italic;">Memory Toolkit (DIY Toolkit Vol H)
<br></span><br>This command removes memory which has been allocated with
<br><span style="font-style: italic;">RESERVE</span>  fairly  safely,  ensuring  that  the  memory  had  been
<br>allocated with <span style="font-style: italic;">RESERVE</span> and has not already been <span style="font-style: italic;">DISCARD</span>ed.
<br><br>If the <span style="font-style: italic;">adr</span> does not point to memory set aside with <span style="font-style: italic;">RESERVE</span> the
<br>error 'not found' is returned.
<br><br><h3>CROSS-REFERENCE:<br></h3><br>See <a style="font-style: italic;" href="KeywordsR.html#RESERVE">RESERVE</a> and <a style="font-style: italic;" href="KeywordsL.html#LINKUP">LINKUP</a>.
<br><br>Also see <a style="font-style: italic;" href="KeywordsC.html#CLCHP">CLCHP</a>, <a style="font-style: italic;" href="KeywordsR.html#RECHP">RECHP</a> and <a style="font-style: italic;" href="KeywordsD.html#DESPR">DESPR</a>.
<br><hr style="width: 100%; height: 2px;"><h1><a name="DISP_BLANK"></a>DISP_BLANK</h1><br>Syntax: <span style="font-style: italic;">DISP_BLANK </span>[<span style="font-style: italic;">xblank</span>][<span style="font-style: italic;">,yblank</span>]
Location: <span style="font-style: italic;">QVME (Level E-19 Drivers onwards), SMSQ/E for
<br>Atari ST &amp; TT (QVME cards only)
<br></span><br>The Atari range of computers can be attached to a wide
<br>range of monitors, some of which are able to display higher
<br>resolutions than  others.    A 17"  multi-sync  monitor,  for
<br>example, can display resolutions of up to 1024x1024 (depending
<br>on make).
<br><br>The QVME card is unable to detect the various parameters
<br>related to monitors and therefore allows you to set your own
<br>parameters either from SuperBASIC or by configuring SMSQ/E.
<br><br>This command is used for setting the margins between the
<br>currently displayed QL screen and the edges of the monitor.
<br>This difference is known as the overscan (pixels available on
<br>the monitor which are currently unused).
<br><br><span style="font-style: italic;">xblank</span> sets the number of horizontal pixels x2 from the edge
<br>of the monitor to the left hand side of the QL screen.  The
<br>standard value for a 512x256 screen is 128 pixels (a standard
<br>QL monitor linked to an Atari can display a screen 640x480)
<br>(640-512)/2=64 pixels from the left hand side of the monitor.
<br>If <span style="font-style: italic;">xblank</span> is omitted or 0, then the original value is left
<br>unaltered.
<br><br><span style="font-style: italic;">yblank</span> sets the number of lines x 0.5 from the top of the
<br>monitor to the top edge of the QL screen.  The standard value
<br>is 56, which gives a top margin of (480-256)/2=112 pixels from
<br>the top of the screen.  If <span style="font-style: italic;">yblank</span> is omitted or 0, then the
<br>original value is left unaltered.
<br><br><h3>NOTE 1:
<br></h3><br>If you use <span style="font-style: italic;">DISP_SIZE</span> to alter the size of the displayed QL
<br>screen, it will automatically adjust the parameters for the
<br>overscan.
<br><br><h3>NOTE 2:
<br></h3><br>If the <span style="font-style: italic;">y</span> parameter is used to alter the number of blank
<br>lines, this will override any setting of the line scan rate
<br>with <span style="font-style: italic;">DISP_RATE</span>.
<br><br><h3>CROSS-REFERENCE:<br></h3><br><a style="font-style: italic;" href="KeywordsD.html#DISP_SIZE">DISP_SIZE</a> allows you to pass these parameters at the same time
<br>as amending the size of the displayed QL screen.
<br><br><a style="font-style: italic;" href="KeywordsD.html#DISP_RATE">DISP_RATE</a> sets the frame and line scan rates for the display -
<br>if this command is used to adjust the line scan rate, this
<br>will alter the totoal number of lines.
<br><br>Both SMSQ/E and QVME include programs to allow you to try
<br>out the various settings for the <a style="font-style: italic;" href="KeywordsD.html#DISP_">DISP_</a>... commands.
<br><br><h3><br><hr style="width: 100%; height: 2px;">DISP_INVERSE<br></h3><br>Syntax: <span style="font-style: italic;">DISP_INVERSE status
<br></span>Location: <span style="font-style: italic;">SMSQ/E for Atari ST &amp; TT
<br></span><br>The Atari range of computers support a high resolution
<br>(640x400) monochrome display mode which can be supported under
<br>SMSQ/E and SMS2.  If SMSQ/E or SMS2 is running on an Atari ST
<br>connected to a monochrome monitor (or running on an Atari TT
<br>conected to such a monitor, without QVME), then it will
<br>automatically start  up  by loading  the  monochrome  display
<br>driver (if available) and set the QL into the monochrome
<br>640x400 display mode.
<br><br>The QL screen can then appear either as white ink on a
<br>black background or black ink on a white background.
<br><br><span style="font-style: italic;">DISP_INVERSE</span> allows you to invert the QL display, with <span style="font-style: italic;">status=0
<br></span>giving the default white on black and <span style="font-style: italic;">status=1</span> the black on white
<br>display.
<br><br><h3>NOTE:
<br></h3><br>This command is not available on SMS2.
<br><br><h3>CROSS-REFERENCE:<br></h3><br><a style="font-style: italic;" href="KeywordsD.html#DISP_TYPE">DISP_TYPE</a> allows you to find out if the monochrome display
<br>driver is running.
<br><br><a style="font-style: italic;" href="KeywordsI.html#INVERSE">INVERSE</a> allows you to print in inverse colours.
<br><hr style="width: 100%; height: 2px;"><h1><a name="DISP_RATE"></a>DISP_RATE</h1><br>Syntax: <span style="font-style: italic;">DISP_RATE </span>[<span style="font-style: italic;">frame_scan</span>][<span style="font-style: italic;">,line_scan</span>]
Location: <span style="font-style: italic;">QVME (Level E-19 Drivers onwards), SMSQ/E for
<br>Atari ST &amp; TT (QVME cards only)
<br></span><br>Due to the multitude of monitors which are available for
<br>the Atari ST range, it is necessary to be able to alter the
<br>horizontal and  vertical  scan  rates (default  =  50Hz,  the
<br>setting on standard QL monitors).
<br><br>The  first  parameter  specifies  the  frame  rate  (the
<br>horizontal scan rate), a setting of 70 (or more) will reduce
<br>flicker on most Atari monitors.  If omitted or 0, the original
<br>value is unchanged.
<br><br>The second parameter specifies the line rate (the vertical
<br>scan rate), although this is normally not required as it is
<br>equal to the frame rate multiplied by the total number of
<br>lines.  If this parameter is omitted or zero, the original is
<br>recalculated by reference to the number of lines and the frame
<br>rate.
<br><br>The total number of lines and line rate can be calculated
<br>by reference to the following program:
<br><span style="font-style: italic;">100 INPUT #0,'Enter y size of QL screen (DISP_SIZE) ';QLy
<br>110 INPUT #0,'Enter horizontal frame rate (DISP_RATE) ';Frate
<br>120 INPUT #0,'Enter vertical blank pixels setting (DISP_BLANK) ';Blanky
<br>130 Total_y=QLy+Blanky
<br>140 total_lines=Total_y*(Qly/QLy)
<br>150 PRINT 'The total number of displayed lines will be ';total_lines
<br>160 PRINT 'Line scan rate will be ';total_lines*Frate
<br></span><br>If you use <span style="font-style: italic;">DISP_RATE</span> to set the line scan rate, then using the
<br>total  number  of  lines  (and  hence  the  blank  lines)  are
<br>recalculated, using the following routine:
<br><span style="font-style: italic;">100 INPUT #0,'Enter y size of QL screen (DISP_SIZE) ';QLy
<br>110 INPUT #0,'Enter horizontal frame rate (DISP_RATE) ';Frate
<br>120 INPUT #0,'Enter vertical line scan rate (DISP_RATE) ';Lrate
<br>130 Total_y=INT(Lrate/Frate)
<br>140 PRINT 'Blank Lines for DISP_BLANK will be ';Total_y-QLy
<br></span><br><h3>CROSS-REFERENCE:<br></h3><br><a style="font-style: italic;" href="KeywordsD.html#DISP_SIZE">DISP_SIZE</a> allows you to pass these parameters at the same time
<br>as amending the size of the displayed QL screen.
<br><br><a style="font-style: italic;" href="KeywordsD.html#DISP_BLANK">DISP_BLANK</a> sets the number of horizontal and vertical blank
<br>pixels on the edge of the display.
<br><br>Both SMSQ/E and QVME include programs to allow you to try
<br>out the various settings for the <a style="font-style: italic;" href="KeywordsD.html#DISP_">DISP_</a>... commands.
<br><hr style="width: 100%; height: 2px;"><h1><a name="DISP_SIZE"></a>DISP_SIZE</h1><br>Syntax: <span style="font-style: italic;">DISP_SIZE </span>[<span style="font-style: italic;">width</span>][<span style="font-style: italic;">,height</span>][<span style="font-style: italic;">,frame_scan</span>][<span style="font-style: italic;">,line_scan</span>][<span style="font-style: italic;">,xblank</span>][<span style="font-style: italic;">,yblank</span>]
Location: <span style="font-style: italic;">QVME (Level E-19 Drivers onwards), SMSQ/E
<br></span><br>This command lets you alter the size of the QL screen being
<br>displayed.  The first two parameters allow you to specify the
<br>display width in pixels and the height in lines (the normal QL
<br>display is <span style="font-style: italic;">DISP_SIZE 512,256</span>).  The remaining four parameters are
<br>those which can be set using the <span style="font-style: italic;">DISP_RATE</span> and <span style="font-style: italic;">DISP_BLANK</span> commands
<br>respectively.
<br><br>The effect of the first two parameters depends upon the
<br>system it is being used on:
<br><br><h3>Extended Mode4 Emulator:
<br></h3><br>Any <span style="font-style: italic;">width</span> up to 512 will select the standard QL resolution.
<br><br>Any <span style="font-style: italic;">width</span> over 512 will select the extended resolution
<br>(768x280).
<br><br><h3>QVME, QXL and QPC:
<br></h3><br>The <span style="font-style: italic;">width</span> and <span style="font-style: italic;">height</span> of the display can only be altered in
<br>increments of 32 pixels and 8 lines respectively.  If <span style="font-style: italic;">width</span> is
<br>not a multiple of 32 or <span style="font-style: italic;">height</span> is not a multiple of 8, they are
<br>made into the nearest feasible size.
<br><br>The minimum size is 512x256 pixels.
<br><br><h3>NOTE 1:
<br></h3><br>If you try to use <span style="font-style: italic;">DISP_SIZE</span> to specify both the line rate and
<br>the number of blank lines, the line rate is ignored and
<br>calculated according to the internal formula (see <span style="font-style: italic;">DISP_RATE</span>).
<br><br><h3>NOTE 2:
<br></h3><br><span style="font-style: italic;">DISP_SIZE</span> will not work if you have already used the <span style="font-style: italic;">A_OLDSCR
<br></span>command.
<br><br><h3>NOTE 3:
<br></h3><br>Some combinations of Super Gold Card and AURORA may cause
<br>the internal QL clock to run too quickly unless you follow
<br><span style="font-style: italic;">DISP_SIZE</span> by <span style="font-style: italic;">PROT_DATE 0</span>.
<br><br><h3>NOTE 4:
<br></h3><br>This command has no effect if your implementation of the QL
<br>does not support higher resolution displays.
<br><br><h3>NOTE 5:
<br></h3><br>Using higher resolution displays will affect the location
<br>of the start of the screen (see <span style="font-style: italic;">SCR_BASE</span>) - using <span style="font-style: italic;">DISP_SIZE 512,256</span> to
<br>set the display size back to the normal QL resolution will not
<br>set the base of the screen back to 131072 (the normal screen
<br>base on a standard QL).  See <span style="font-style: italic;">A_OLDSCR</span>.
<br><br><h3>NOTE 6:
<br></h3><br>Be careful when reducing screen resolution size - windows
<br>are not resized and therefore you may not be able to see all
<br>of a program's windows, or the SuperBASIC cursor!!
<br><br><h3>CROSS-REFERENCE:<br></h3><br>All of these parameters can be configured in SMSQ/E so that
<br>they are available immediately on start-up. See <a style="font-style: italic;" href="KeywordsD.html#DISP_RATE">DISP_RATE</a> and
<br><a style="font-style: italic;" href="KeywordsD.html#DISP_BLANK">DISP_BLANK</a>.
<br><hr style="width: 100%; height: 2px;"><h1><a name="DISP_TYPE"></a>DISP_TYPE</h1><br>Syntax: <span style="font-style: italic;">DISP_TYPE
<br></span>Location: <span style="font-style: italic;">SMSQ/E
<br></span><br>This function returns a number which allows you to find out
<br>the type of display driver which is currently being used.
<br><br>The values returned are:
<br><br>0Original ST QL Emulator, QL Hardware (either of these
<br>two may support MODE 8) plus QXL and QPC.  All of these
<br>(except the original ST QL emulator) may support higher
<br>resolutions.
<br><br>1Extended Mode 4 Emulator (either 512x256 or 768x280
<br>pixel screen)
<br><br>2QVME Mode 4 Emulator
<br><br>4Monochrome display (only two colours)
<br><br><h3>CROSS-REFERENCE:<br></h3><br>See <a style="font-style: italic;" href="KeywordsD.html#DISP_INVERSE">DISP_INVERSE</a>.
<br><br><a style="font-style: italic;" href="KeywordsM.html#MACHINE">MACHINE</a> and <a style="font-style: italic;" href="KeywordsP.html#PROCESSOR">PROCESSOR</a> allow you to find out more about the
<br>hardware which a program is being run on.
<br><hr style="width: 100%; height: 2px;"><h1><a name="DISP_UPDATE"></a>DISP_UPDATE</h1><br>Syntax: <span style="font-style: italic;">DISP_UDPATE x,y
<br></span><br>Location <span style="font-style: italic;">QXL (SMSQ only)
<br></span><br>This is an undocumented command and it is uncertain what
<br>its parameters do - it affects the rate at which the screen is
<br>updated on the QXL.  The higher <span style="font-style: italic;">x</span> and <span style="font-style: italic;">y</span>, the faster that the
<br>screen is updated (and hence the smoother the graphics),
<br>although this also slows down the other parts of the QXL.
<br><br>If <span style="font-style: italic;">x</span> and <span style="font-style: italic;">y</span> are equal to 0, the screen is only updated when
<br>you press a key - this allows the QXL to perform complex maths
<br>routines very quickly (so long as they do not access the
<br>screen).
<br><br><h3>NOTE 1:
<br></h3><br>Prior to SMSQ/E v2.65 if you used <span style="font-style: italic;">DISP_UPDATE</span> with a parameter
<br>larger than 1 in <span style="font-style: italic;">MODE 8</span>, this could cause problems on screen.
<br><br><h3>NOTE 2:
<br></h3><br>Using parameters smaller than 0 could lock up some versions
<br>of QXL.
<br><br><span style="font-style: italic;">SCR_PRIORITY</span> is similar under Amiga QDOS.
<br><hr style="width: 100%; height: 2px;"><h1><a name="DIV"></a>DIV</h1><br>Syntax: <span style="font-style: italic;">x DIV y
<br></span>Location: <span style="font-style: italic;">QL ROM
<br></span><br>This operator returns the integer part of <span style="font-style: italic;">x</span> divided by <span style="font-style: italic;">y</span>.
<br>If <span style="font-style: italic;">x</span> or <span style="font-style: italic;">y</span> is not an integer, then the given value is rounded to
<br>the nearest integer (compare <span style="font-style: italic;">INT</span>).
<br><br>On non-SMS implementations the answer and both parameters
<br>must lie within the range -32768...32767.  On SMS, the answer
<br>and both parameters can lie anywhere within roughly -2e9...2e9
<br>(32-bit numbers).
<br><br>The result of the operation is always rounded down to the
<br>next integer ie. <span style="font-style: italic;">x DIV y=INT(x/y)</span>.  Although this leads to some
<br>unexpected results with negative numbers this is so that the
<br>formula:
<br><span style="font-style: italic;">x=y*(x DIV y)+(x MOD y)
<br></span><br>is always true
<br><br>If you wish to use 32-bit numbers on non SMS systems, you
<br>will need to use the formula:
<br><br><span style="font-style: italic;">PRINT INT(x/y)</span> instead of
<br><br><span style="font-style: italic;">PRINT x DIV y
<br></span><br>if either <span style="font-style: italic;">x</span> or <span style="font-style: italic;">y</span> is outside of the specified range.
<br><br><h3>Examples:
<br></h3><span style="font-style: italic;">PRINT 13 DIV 5
<br></span><br>gives the result 2 (13 divided by 5 is 2.6)
<br><span style="font-style: italic;">PRINT 13.4 DIV 1.5
<br></span><br>gives the result 6 (<span style="font-style: italic;">13 DIV 2</span>).
<br><span style="font-style: italic;">PRINT -13 DIV 5
<br></span><br>gives the result -3
<br><br><h3>NOTE:
<br></h3><br><span style="font-style: italic;">DIV</span> has problems with the value -32768:
<br><br><span style="font-style: italic;">PRINT -32768 DIV -1
<br></span><br>gives the result -32768 on most implementations. On Minerva
<br>v1.76 (or  later)  it  gives the  correct  result,  being  an
<br>overflow error (the answer is +32768 which cannot be stored as
<br>a short integer variable).
<br><br>On SMS v2.75+, it returns the value +32768 as <span style="font-style: italic;">DIV</span> can handle
<br>the larger numbers!!
<br><br><h3>CROSS-REFERENCE:<br></h3><br><a style="font-style: italic;" href="KeywordsM.html#MOD">MOD</a> returns the modulus of x divided by y.
<br><br>Also please see the alternative version of <a style="font-style: italic;" href="KeywordsD.html#DIV">DIV</a>.
<br><hr style="width: 100%; height: 2px;"><h1><a name="DIV"></a>DIV</h1><br>Syntax: <span style="font-style: italic;">DIV (x,y)
<br></span>Location: <span style="font-style: italic;">Math Package
<br></span><br>This function returns x/y as an integer in the same way as
<br>the ROM based <span style="font-style: italic;">DIV</span> operator. However, this version is not
<br>limited to 16-bit integers (-32768..32767). It will happily
<br>handle 32-bit integer numbers (<span style="font-style: italic;">-INTMAX..INTMAX</span>, roughly -1E9..1E9).
<br>Division by zero is not defined and will produce an overflow
<br>message.
<br><br><h3>Example:
<br></h3><span style="font-style: italic;">PRINT -40000 DIV 3
<br></span><br>will produce an error on a standard QL ROM. Instead, you
<br><br>can now use:
<br><span style="font-style: italic;">PRINT DIV(-40000,3)
<br></span><br>which gives the correct result.
<br><br><h3>NOTE 1:
<br></h3><br>Both variants of <span style="font-style: italic;">DIV</span> can be used in the same program,
<br>although the Turbo and Supercharge compilers will not accept
<br>this version.
<br><br><h3>NOTE 2:
<br></h3><br>If you try to use a program compiled under Turbo or
<br>Supercharge after loading the Math Package, if the program
<br>uses the normal SuperBASIC operator <span style="font-style: italic;">MOD</span> or <span style="font-style: italic;">DIV</span>, an error will be
<br>generated and the program will refuse to work!
<br><br><h3>CROSS-REFERENCE:<br></h3><br><a style="font-style: italic;" href="KeywordsM.html#MOD">MOD</a> (as an operator or a function) returns the remainder of
<br>a division.
<br><br>Compare the other version of <a style="font-style: italic;" href="KeywordsD.html#DIV">DIV</a>.
<br><hr style="width: 100%; height: 2px;"><h1><a name="DLINE"></a>DLINE</h1><br>Syntax: <span style="font-style: italic;">DLINE</span> [<span style="font-style: italic;">#ch,</span>] [<span style="font-style: italic;">range</span> <sup>*</sup>[<span style="font-style: italic;">,range</span><sup>i</sup>]<sup>*</sup>]<span style="font-style: italic;">(Not SMS)
<br></span><br>Syntax: <span style="font-style: italic;">DLINE</span> [<span style="font-style: italic;">range</span> <sup>*</sup>[<span style="font-style: italic;">,range</span><sup>i</sup>]<sup>*</sup>]<span style="font-style: italic;">(SMS Only)
<br></span>Location: <span style="font-style: italic;">QL ROM
<br></span><br>This command deletes a given range of lines from the
<br>current SuperBASIC program. The  range of lines is as per the
<br><span style="font-style: italic;">LIST</span> command. If an empty range (for example <span style="font-style: italic;">DLINE</span>) is specified,
<br>no action is taken.
<br><br>When the lines have been deleted, except under SMS, the
<br>current  listed  lines  are  re-shown  in  the  given  channel
<br>(default #2), although we cannot see any reason why you would
<br>wish this to happen on another channel!
<br><br>On SMS this command has no effect on the display.
<br><br><h3>NOTE 1:
<br></h3><br><span style="font-style: italic;">DLINE TO</span> is expanded to <span style="font-style: italic;">DLINE 1 TO 32767</span>.
<br><br><h3>NOTE 2:
<br></h3><br>Only Minerva v1.96+ rejects invalid channel parameters.
<br><br><h3>NOTE 3:
<br></h3><br>On Minerva pre v1.98, <span style="font-style: italic;">DLINE</span> to the last line could crash the
<br>QL!
<br><br><h3>CROSS-REFERENCE:<br></h3><br><a style="font-style: italic;" href="KeywordsE.html#EDIT">EDIT</a> and <a style="font-style: italic;" href="KeywordsA.html#AUTO">AUTO</a> allow you to enter lines.
<br><br><a style="font-style: italic;" href="KeywordsL.html#LIST">LIST</a> allows you to view program lines.
<br><hr style="width: 100%; height: 2px;"><h1><a name="DLIST"></a>DLIST</h1><br>Syntax: <span style="font-style: italic;">DLIST</span> [<span style="font-style: italic;">#channel</span>]
Location: <span style="font-style: italic;">Toolkit II
<br></span><br>This command lists all three current default directories
<br>(otherwise returned by the <span style="font-style: italic;">DATAD$</span>, <span style="font-style: italic;">PROGD$</span> and <span style="font-style: italic;">DESTD$</span> functions) to
<br>the specified channel (default #1).
<br><br><h3>Example:
<br></h3><span style="font-style: italic;">DLIST
<br></span><br>possible Output:
<br><br>flp1_Quill_letters_
<br><br>ram1_
<br><br>par
<br><br><h3>NOTE:
<br></h3><br>Some Toolkit II manuals mention a second syntax:
<br><span style="font-style: italic;">DLIST \file
<br></span><br>but it seems as though this was never implemented. This
<br>should not be a problem since programs can read the same
<br>information from the <span style="font-style: italic;">DATAD$</span>, <span style="font-style: italic;">PROGD$</span> and <span style="font-style: italic;">DESTD$</span> functions.
<br><br><h3>CROSS-REFERENCE:<br></h3><br><a style="font-style: italic;" href="KeywordsD.html#DATAD$">DATAD$</a> (<a style="font-style: italic;" href="KeywordsD.html#DATA_USE">DATA_USE</a>), <a style="font-style: italic;" href="KeywordsP.html#PROGD$">PROGD$</a> (<a style="font-style: italic;" href="KeywordsP.html#PROG_USE">PROG_USE</a>), <a style="font-style: italic;" href="KeywordsD.html#DESTD$">DESTD$</a> (<a style="font-style: italic;" href="KeywordsS.html#SPL_USE">SPL_USE</a> or <a style="font-style: italic;" href="KeywordsD.html#DEST_USE">DEST_USE</a>), <a style="font-style: italic;" href="KeywordsD.html#DDOWN">DDOWN</a>, <a style="font-style: italic;" href="KeywordsD.html#DUP
">DUP
</a><br>Compare <a style="font-style: italic;" href="KeywordsD.html#DEVLIST">DEVLIST</a> and <a style="font-style: italic;" href="KeywordsD.html#DEV_LIST">DEV_LIST</a>.
<br><hr style="width: 100%; height: 2px;"><h1><a name="DMEDIUM_DENSITY"></a>DMEDIUM_DENSITY</h1><br>Syntax: <span style="font-style: italic;">DMEDIUM_DENSITY</span> [<span style="font-style: italic;">(#channel)</span>]
<br><br>or <span style="font-style: italic;">DMEDIUM_DENSITY (\file)
<br></span>Location: <span style="font-style: italic;">SMSQ/E v2.73+
<br></span><br>This function returns a number representing the density of
<br>the medium on which the specified <span style="font-style: italic;">file</span> or directory is located,
<br>or to which the specified channel is open.  If no parameter is
<br>specified, it looks to channel #3 (or #1 if #3 is not open).
<br><br>An error will occur if the specified channel is not open or
<br>the given file does not exist.
<br><br>The value returned is:
<br><br>0Non-directory device
<br><br>1Double Density
<br><br>2High Density
<br><br>3Extra Density
<br><br>255Hard disk or ram disk as they have no density.
<br><br><h3>Example:
<br></h3><span style="font-style: italic;">PRINT DMEDIUM_DENSITY(\flp1_)
<br></span><br><h3>CROSS-REFERENCE:<br></h3><br><a style="font-style: italic;" href="KeywordsD.html#DMEDIUM_NAME$">DMEDIUM_NAME$</a> gives the name of the disk attached to the
<br>specified channel.
<br><br><a style="font-style: italic;" href="KeywordsD.html#DMEDIUM_RDONLY">DMEDIUM_RDONLY</a> and <a style="font-style: italic;" href="KeywordsD.html#DMEDIUM_FORMAT">DMEDIUM_FORMAT</a> are also useful.
<br><hr style="width: 100%; height: 2px;"><h1><a name="DMEDIUM_DRIVE$"></a>DMEDIUM_DRIVE$</h1><br>Syntax: <span style="font-style: italic;">DMEDIUM_DRIVE$</span> [<span style="font-style: italic;">(#channel)</span>]
<br><br>or <span style="font-style: italic;">DMEDIUM_DRIVE$ (\file)
<br></span>Location: <span style="font-style: italic;">SMSQ/E v2.73+
<br></span><br>This function returns the three letter code representing
<br>the device connected to the specified channel or file.  If no
<br>parameter is specified then it tries #1, unless channel #3 is
<br>open in which case it will access #3.
<br><br>If an error occurs, for example you specify a channel which
<br>is not open or a file which does not exist, then an error will
<br>occur.  Luckily due to the fact that directories are stored in
<br>files under Level-2 and Level-3 drivers, this means that you
<br>can use <span style="font-style: italic;">PRINT DMEDIUM_DRIVE$(\flp2_)</span> if you wish.
<br><br>If the specified channel is not open to a directory device
<br>then an empty string will be returned.
<br><h3><br>NOTE 1:
<br></h3><br>This function does not appear to work 100%, for example on
<br>Falkenberg hard disk interfaces it returns 'WINq' - however
<br>you can get around this by copying the returned string to
<br>another variable and only looking at the first three letters,
<br>for example:
<br><span style="font-style: italic;">DRV$=DMEDIUM_DRIVE$
<br>IF DRV$&lt;&gt;"":PRINT DRV$( TO 3)
<br></span><br><h3>NOTE 2:
<br><br></h3>This function will ignore  the dev_ device, returning the
<br>three letter name of the device to which dev points, for
<br>example:
<br><br><span style="font-style: italic;">DEV_USE 1,'flp1_quill_'
<br><br>drv$=DMEDIUM_DRIVE$(\DEV1_)
<br><br>IF drv$&lt;&gt;'':PRINT drv$(to 3)
<br></span><br>compare:
<br><br><span style="font-style: italic;">PRINT DMEDIUM_DRIVE$(\DEV1_)
<br><br></span><h3>CROSS-REFERENCE:<br><br></h3><a style="font-style: italic;" href="KeywordsD.html#DMEDIUM_NAME$">DMEDIUM_NAME$</a> allows you to find out the name of the disk in
<br>the specified drive.
<br><hr style="width: 100%; height: 2px;"><h1><a name="DMEDIUM_FORMAT"></a>DMEDIUM_FORMAT</h1><br>Syntax: <span style="font-style: italic;">DMEDIUM_FORMAT</span> [<span style="font-style: italic;">(#channel)</span>]
<br><br>or <span style="font-style: italic;">DMEDIUM_FORMAT (\file)
<br></span>Location: <span style="font-style: italic;">SMSQ/E v2.73+
<br></span><br>This function returns a number representing the operating
<br>system under which the medium (or hard disk partition) on
<br>which the specified <span style="font-style: italic;">file</span> or directory is located (or to which
<br>the specified channel is open) was created.  If no parameter
<br>is specified, it looks to channel #3 (or #1 if #3 is not
<br>open).
<br><br>The values returned currently are:
<br><br>1QDOS / SMSQ / SMSQ/E
<br><br>2DOS / TOS
<br><br><h3>NOTE:
<br></h3><br>This function does not appear to work on Falkenberg hard
<br>disk interfaces where it always returns 255.
<br><br><h3>CROSS-REFERENCE:<br></h3><br><a style="font-style: italic;" href="KeywordsD.html#DIR">DIR</a> will provide this imformation also on Level-3 device
<br>drivers.
<br><br><a style="font-style: italic;" href="KeywordsD.html#DMEDIUM_DENSITY">DMEDIUM_DENSITY</a> allows you to check the medium's density.
<br><br>There is currently no way to format a disk in a format
<br>other than QDOS or SMSQ/E without the ATARI_rext commands
<br>which were available with the ST/QL emulators from Jochen
<br>Merz, or without specialist software (some of which is public
<br>domain).
<br><hr style="width: 100%; height: 2px;"><h1><a name="DMEDIUM_FREE"></a>DMEDIUM_FREE</h1><br>Syntax: <span style="font-style: italic;">DMEDIUM_FREE</span> [<span style="font-style: italic;">(#channel)</span>]
<br><br>or <span style="font-style: italic;">DMEDIUM_FREE (\file)
<br></span>Location: <span style="font-style: italic;">SMSQ/E v2.73+
<br></span><br>This function returns the number of free sectors available
<br>on the medium on which the specified <span style="font-style: italic;">file</span> or directory is
<br>located, or to which the specified channel is open.  If no
<br>parameter is specified, it looks to channel #3 (or #1 if #3 is
<br>not open).
<br><br><h3>CROSS-REFERENCE:<br><br></h3><a style="font-style: italic;" href="KeywordsD.html#DMEDIUM_TOTAL">DMEDIUM_TOTAL</a><h3> </h3>allows you to find out the total number of
<br>sectors available on the related medium.
<a style="font-style: italic;" href="KeywordsD.html#DIR">DIR</a><h3> </h3>can also be used to obtain this information.
<br><br><h3><br><hr style="width: 100%; height: 2px;">DMEDIUM_NAME$<br></h3><br>Syntax: <span style="font-style: italic;">DMEDIUM_NAME$</span> [<span style="font-style: italic;">(#channel)</span>]
<br><br>or <span style="font-style: italic;">DMEDIUM_NAME$ (\file)
<br></span>Location: <span style="font-style: italic;">SMSQ/E v2.73+
<br></span><br>This function returns the name which was given to the
<br>medium on which the specified <span style="font-style: italic;">file</span> or directory is located (or
<br>to which the specified channel is open), when that medium was
<br><span style="font-style: italic;">FORMAT</span>ted.  If no parameter is specified, it looks to channel #3
<br>(or #1 if #3 is not open).
<br><br><h3>Example:
<br></h3><br>A routine to re-format a floppy disk with the same details
<br><br>as previously allocated to that disk (except for the
<br><br>files).  The drive to format (eg. flp1_) can be passed with
<br><br>or without quotes, due to the use of line 120:-
<br><span style="font-style: italic;">100 DEFine PROCedure RE_FORMAT(drv)
<br>110 v$=VER$:IF v$&lt;&gt;'HBA':PRINT #0,'NOT SUPPORTED':PAUSE:RETurn
<br>120 drv$=PARSTR$(drv,1)
<br>130 CH=FOPEN(drv$)
<br>140 IF CH<0:PRINT #0,'File Error - cannot access drive':PAUSE:RETurn
<br>150 IF DMEDIUM_RDONLY(#CH)
<br>160   PRINT #0,'Disk Write Protected, cannot proceed':PAUSE
<br>170   CLOSE #CH:RETurn
<br>180 END IF
<br>190 dname$=DMEDIUM_NAME$(#CH)
<br>200 drv_density=DMEDIUM_DENSITY(#CH)
<br>210 IF DMEDIUM_FORMAT(#CH)&lt;&gt;1
<br>220   PRINT #0,'Not QDOS / SMSQE disk, cannot proceed':PAUSE
<br>230   CLOSE #CH:RETurn
<br>240 END IF
<br>250 IF DMEDIUM_TYPE(#CH)&lt;&gt;1
<br>260   PRINT #0,'This routine only supports floppy disks!!':PAUSE
<br>270   CLOSE #CH:RETurn
<br>280 END IF
<br>290 CLOSE #CH
<br>300 IF LEN(dname$)>10:dname$=dname$(1 TO 10)
<br>310 SELect ON drv_density
<br>320   =1:dname$=dname$&amp;'*D'
<br>330   =2:dname$=dname$&amp;'*H'
<br>340   =3:dname$=dname$&amp;'*E'
<br>350 END SELect
<br>360 FORMAT drv$&amp;dname$
<br>370 END DEFine
<br></span><br><span style="font-style: italic;">RE_FORMAT flp1_</span>or
<br><br><span style="font-style: italic;">RE_FORMAT 'flp2_'
<br></span><br><h3>CROSS-REFERENCE:<br></h3><br>The name of a medium is set with <a style="font-style: italic;" href="KeywordsF.html#FORMAT">FORMAT</a>.  You can read it
<br>with <a style="font-style: italic;" href="KeywordsD.html#DIR">DIR</a> also.
<br><br><h3><br><hr style="width: 100%; height: 2px;">DMEDIUM_RDONLY<br></h3><br>Syntax: <span style="font-style: italic;">DMEDIUM_RDONLY</span> [<span style="font-style: italic;">(#channel)</span>]
<br><br>or <span style="font-style: italic;">DMEDIUM_RDONLY (\file)
<br></span>Location: <span style="font-style: italic;">SMSQ/E v2.73+
<br></span><br>This function returns the value 1 (true) if the the medium
<br>on which the specified <span style="font-style: italic;">file</span> or directory is located (or to which
<br>the specified  channel  is open)  is  write-protected  either
<br>through hardware or software control.  If no parameter is
<br>specified, it looks to channel #3 (or #1 if #3 is not open).
<br><br>If the medium can be written to, the value returned is
<br>zero.
<br><br><h3>NOTE:
<br></h3><br>This function does not appear to work on Falkenberg hard
<br>disk interfaces where it always returns 1.
<br><br><h3>CROSS-REFERENCE:<br></h3><br>See <a style="font-style: italic;" href="KeywordsD.html#DMEDIUM_NAME$">DMEDIUM_NAME$</a> for an example.
<br><hr style="width: 100%; height: 2px;"><h1><a name="DMEDIUM_REMOVE"></a>DMEDIUM_REMOVE</h1><br>Syntax: <span style="font-style: italic;">DMEDIUM_REMOVE</span> [<span style="font-style: italic;">(#channel)</span>]
<br><br>or <span style="font-style: italic;">DMEDIUM_REMOVE (\file)
<br></span>Location: <span style="font-style: italic;">SMSQ/E v2.73+
<br></span><br>This function returns the value 1 (true) if the medium on
<br>which the specified <span style="font-style: italic;">file</span> or directory is located (or to which
<br>the specified channel is open) is a removeable hard disk.
<br>Otherwise it returns 0 (false).  If no parameter is specified,
<br>it looks to channel #3 (or #1 if #3 is not open).
<br><br><h3>NOTE:
<br></h3><br>This function does not appear to work on Falkenberg hard
<br>disk interfaces where it always returns 1.
<br><br><h3>CROSS-REFERENCE:<br></h3><br><a style="font-style: italic;" href="KeywordsD.html#DMEDIUM_RDONLY">DMEDIUM_RDONLY</a>  allows  you  to  check  if  a  disk  is  write-
<br>protected.
<br><br>There do not appear to be any ways in which you can check
<br>if any channels are currently open to the medium (ie. whether
<br>it is safe to remove the disk), except for listing all
<br>currently open channels, see <a style="font-style: italic;" href="KeywordsC.html#CHANNELS">CHANNELS</a>.
<br><br><h3><br><hr style="width: 100%; height: 2px;">DMEDIUM_TOTAL<br></h3><br>Syntax: <span style="font-style: italic;">DMEDIUM_TOTAL</span> [<span style="font-style: italic;">(#channel)</span>]
<br><br>or <span style="font-style: italic;">DMEDIUM_TOTAL (\file)
<br></span>Location: <span style="font-style: italic;">SMSQ/E v2.73+
<br></span><br>This function returns the number of total sectors available
<br>on the medium on which the specified <span style="font-style: italic;">file</span> or directory is
<br>located, or to which the specified channel is open.  If no
<br>parameter is specified, it looks to channel #3 (or #1 if #3 is
<br>not open).
<br><br><h3>CROSS-REFERENCE:<br><br></h3><a style="font-style: italic;" href="KeywordsD.html#DMEDIUM_FREE">DMEDIUM_FREE</a><h3> </h3>allows you to find out the number of sectors which
<br>currently do not contain any data on the related medium.
<a style="font-style: italic;" href="KeywordsD.html#DIR">DIR</a><h3> </h3>can also be used to obtain this information.
<br><br><a style="font-style: italic;" href="KeywordsF.html#FORMAT">FORMAT</a> releases all sectors on a disk, marking any which may
<br>be corrupt as unavailable.
<br><h3><hr style="width: 100%; height: 2px;">DMEDIUM_TYPE<br></h3><br>Syntax: <span style="font-style: italic;">DMEDIUM_TYPE</span> [<span style="font-style: italic;">(#channel)</span>]
<br><br>or <span style="font-style: italic;">DMEDIUM_TYPE (\file)
<br></span>Location: <span style="font-style: italic;">SMSQ/E v2.73+
<br></span><br>This function returns a number representing the type of
<br>drive on which the specified <span style="font-style: italic;">file</span> or directory is located (or to
<br>which the specified channel is open).  If no parameter is
<br>specified, it looks to channel #3 (or #1 if #3 is not open).
<br><br>The values currently returned are:
<br><br>0RAM disk
<br><br>1Floppy disk drive
<br><br>2Hard disk drive
<br><br>3CD-ROM drive
<br><br><h3>NOTE:
<br></h3><br>This function does not appear to work on Falkenberg hard
<br>disk interfaces where it always returns 255.
<br><br><h3>CROSS-REFERENCE:<br></h3><br>See <a style="font-style: italic;" href="KeywordsD.html#DMEDIUM_NAME$">DMEDIUM_NAME$</a> for an example.
<br><hr style="width: 100%; height: 2px;"><h1><a name="DNEXT"></a>DNEXT</h1><br>Syntax: <span style="font-style: italic;">DNEXT subdirectory
<br></span>Location: <span style="font-style: italic;">Toolkit II
<br></span><br>This command allows you to move across a directory tree by
<br>replacing  the  current  sub-directory  with  the  specified
<br><span style="font-style: italic;">subdirectory</span> in the default data device.
<br><br>If the default program device is the same as the default
<br>data device, then this will also be altered by <span style="font-style: italic;">DNEXT</span>.
<br><br>If the default destination device is a directory device
<br>(ie. if it ends with an underscore), <span style="font-style: italic;">DNEXT</span> also alters the last
<br>sub-directory in this (whether or not it points to another
<br>drive, or is further down the directory tree).
<br><br>win1_
<br><br>|
<br><br>+--------+-------+
<br><br>|        |        |
<br><br>C    BASIC   Quill
<br><br>|                 |
<br><br>+---+---+       +-----+-----+
<br><br>|        |       |           |
<br><br>include objects letters  translations
<br><br>     |
<br><br>    secret
<br><br>The above could be a directory tree on a hard disk.
<br><span style="font-style: italic;">DATA_USE win1_C_</span> defines win1_C_ as the default directory device, so
<br><span style="font-style: italic;">WDIR</span> will list all of the files in win1_C_. Assuming that
<br><span style="font-style: italic;">PROGD$='win1_BASIC_'</span> and <span style="font-style: italic;">DESTD$='flp2_C_Include_'</span>, entering <span style="font-style: italic;">DNEXT Quill</span> will
<br>result in the following:
<br><br><span style="font-style: italic;">DATAD$='win1_Quill_'
<br><br>PROGD$='win1_BASIC_'
<br><br>DESTD$='flp2_C_Quill_'
<br></span><br><h3>NOTE 1:
<br></h3><span style="font-style: italic;"><br>DNEXT</span> does not check if there are any files with the given
<br>prefix which exist.
<br><br><h3>NOTE 2:
<br></h3><br><span style="font-style: italic;">DNEXT</span> breaks with error -17 (error in expression) if the
<br>parameter is a resident keyword. So append an underscore to
<br>the directory name, eg. <span style="font-style: italic;">DNEXT NEW_</span>, or specify the parameter
<br>between quote marks (eg. <span style="font-style: italic;">DNEXT 'NEW'</span>).
<br><br><h3>NOTE 3:
<br></h3><br>The default devices cannot exceed 32 characters (plus a
<br>final underscore) - any attempt to extend them beyond this
<br>will result in the error 'Bad Parameter' (error -15).
<br><br><h3>CROSS-REFERENCE:<br></h3><br><a style="font-style: italic;" href="KeywordsD.html#DUP">DUP</a> moves up the tree, <a style="font-style: italic;" href="KeywordsD.html#DDOWN">DDOWN</a> moves down the tree.
<br><br><a style="font-style: italic;" href="KeywordsD.html#DATAD$">DATAD$</a> and <a style="font-style: italic;" href="KeywordsD.html#DLIST">DLIST</a> can be used to find out about the current
<br>sub-directory and default devices respectively.
<br><hr style="width: 100%; height: 2px;"><h1><a name="DO"></a>DO</h1><br>Syntax:<span style="font-style: italic;"> DO</span> [<span style="font-style: italic;">device_</span>] <span style="font-style: italic;">filename
<br></span>Location: <span style="font-style: italic;">Toolkit II
<br></span><br>This command allows you to execute a set of commands stored
<br>in a file (acting as an overlay). It is intended to perform
<br>tasks dictated by a numberless file, which enables you to do
<br>many things whilst releasing memory once the tasks have been
<br>performed.
<br><br><span style="font-style: italic;">DO</span> is actually very similar to the Toolkit II variant <span style="font-style: italic;">MERGE
<br></span>and  will  ensure  that  if  the  given  file  only  contains
<br>numberless lines, the channel is closed afterwards. It does
<br>however work just as well as <span style="font-style: italic;">MERGE</span> on numbered files!
<br><br>A numberless program is basically a set of SuperBASIC lines
<br>which do not have any line numbers. These can therefore best
<br>be entered with the aid of an editor program. Each line is
<br>loaded into  the  QL  with the  relevant  command,  and  then
<br>executed (one line at a time), as if they had been entered
<br>from the command line (#0).
<br><br>This therefore means that although they can call resident
<br>SuperBASIC <span style="font-style: italic;">PROCedure</span>s and <span style="font-style: italic;">FuNction</span>s, you can only have in-line
<br>structures, such as <span style="font-style: italic;">IF...END IF</span> and  <span style="font-style: italic;">SELect ON...END SELect</span>. Once each
<br>line has been executed, it is lost and the memory occupied by
<br>that line released.
<br><br>One advantage for pre JS ROMs is that if you use a
<br>numberless file to link resident keywords, such keywords can
<br>then be used in the same program which <span style="font-style: italic;">MERGE</span>d the numberless
<br>file.    For  example,  if  you  have  a  numberless  file
<br>flp1_resident_bas such as:
<br><br><span style="font-style: italic;">a=RESPR(12000)
<br><br>LBYTES flp1_Toolkit,a: CALL a
<br></span><br>you can then link and use the Toolkit commands in the same
<br>program by including a line such as:
<br><br><span style="font-style: italic;">110 DO flp1_resident_bas
<br></span><br><h3>NOTE:
<br></h3><br>On at least v2.28-v2.49 of Toolkit II, <span style="font-style: italic;">MERGE</span> appears to work
<br>much better than <span style="font-style: italic;">DO</span> at executing numberless files. If <span style="font-style: italic;">DO</span> is
<br>entered as a direct command, none of the numberless lines are
<br>executed (compare <span style="font-style: italic;">MERGE</span> which executes the first line), and if <span style="font-style: italic;">DO
<br></span>is part of a program, only the first line is executed (compare
<br><span style="font-style: italic;">MERGE</span> which executes all of the commands in the numberless
<br>file).
<br><br>This is fixed under SMS.
<br><br><h3>CROSS-REFERENCE:<br></h3><br>Please refer to <a style="font-style: italic;" href="KeywordsM.html#MERGE">MERGE</a>. SMS allows you to <a style="font-style: italic;" href="KeywordsE.html#EXEC">EXEC</a>ute a SuperBASIC
<br>program,  letting  it  run  in  the  background  and  perform
<br>functions on supplied data using pipes or channels (see <a style="font-style: italic;" href="KeywordsE.html#EX">EX</a>).
<br><hr style="width: 100%; height: 2px;"><h1><a name="DOTLIN"></a>DOTLIN</h1><br>Syntax: <span style="font-style: italic;">DOTLIN p1, p2, p3, col, x1, y1, x2, y2
<br></span>Location: <span style="font-style: italic;">HCO
<br></span><br>The command <span style="font-style: italic;">DOTLIN</span> is a variant of <span style="font-style: italic;">LDRAW</span> - it draws a dotted
<br>line in the specified colour <span style="font-style: italic;">col</span> from the absolute co-ordinates
<br><span style="font-style: italic;">(x1,y1)</span>  to  <span style="font-style: italic;">(x2,y2)</span>.    The  three  first  parameters  are  small
<br>non-negative integers which specify after how many pixels the
<br>line is to be broken (they are known as the periods).
<br><br>The line is drawn by plotting the first <span style="font-style: italic;">p1</span> pixels, then
<br>leaving a gap of <span style="font-style: italic;">p2</span> pixels, plotting the next <span style="font-style: italic;">p3</span> pixels and once
<br>again leaving a gap of <span style="font-style: italic;">p2</span> pixels before recommencing the
<br>pattern.
<br><br><h3>Examples:
<br></h3><span style="font-style: italic;">DOTLIN 10,10,10,3,40,40,200,60
<br></span><br>draws a white line from the point (40,40) to the point
<br>(200,60) but only for periods of ten pixels. If a pixel is
<br>represented by an asterisk, this would look like this:
<br><br>**********          **********  ...
<br><br>|-- 10 --||-- 10 --||-- 10 --|  ...
<br><br><span style="font-style: italic;">DOTLIN</span> with the periods 3, 5 and 10:
<br><br>***     **********     ***     **********
<br><br>|3||-5-||---10---||-5-||3||-5-||---10---|
<br><br><h3>CROSS-REFERENCES:
<br></h3><br>All the warnings relevant to <span style="font-style: italic;">SET</span> apply.
<br><hr style="width: 100%; height: 2px;"><h1><a name="DRAW"></a>DRAW</h1><br>Syntax: <span style="font-style: italic;">DRAW x1,y1 TO x2,y2 ,colour
<br></span>Location: <span style="font-style: italic;">Fast PLOT/DRAW Toolkit
<br></span><br>This command draws a line in absolute co-ordinates on the
<br>screen.  Any windows and window attributes are ignored. <span style="font-style: italic;">x1</span> and
<br><span style="font-style: italic;">x2</span> range from 0 to 511, <span style="font-style: italic;">y1</span> and <span style="font-style: italic;">y2</span> from 0 to 255.  <span style="font-style: italic;">DRAW</span> uses the
<br>screen base address defined with <span style="font-style: italic;">SCRBASE</span> (which enables it to
<br>draw on a screen stored in memory as well as the currently
<br>visible screen.  It is therefore compatible with QL emulators
<br>and Minerva's dual screen mode, although it cannot support
<br>higher resolutions).
<br><br>The range for the colour parameter is 0..7, other values
<br>give odd results without being dangerous.
<br><br><h3>Example:
<br></h3><br>Here is a procedure which draws a line given in polar
<br><br>co-ordinates. A point in a polar system is specified by a
<br><br>radius and angle.
<br><span style="font-style: italic;">170 DEFine PROCedure POLAR_DRAW (r1,phi1,r2,phi2,col)
<br>180  REMark less precise but fast version
<br>190  LOCal r,phi,r_old,phi_old,dr,dphi
<br>200  LOCal x1,x2,y1,y2,dist
<br>210  r_old=r1: phi_old=phi1
<br>220  r=r1: phi=phi1
<br>230  x1=1.35*r_old*SIN(phi_old+PI/2)+255
<br>240  y1=r_old*COS(phi_old+PI/2)+127
<br>250  dist=(r1+r2)/2 * (phi1+phi2)/PI
<br>260  IF dist==0 THEN RETurn
<br>270  dr=(r2-r1)/dist: dphi=(phi2-phi1)/dist
<br>280  REPeat Drawing
<br>290    IF r>=r2 AND phi>=phi2 THEN EXIT Drawing
<br>300    r=r_old+dr: phi=phi_old+dphi
<br>310    x2=1.35*r*SIN(phi+PI/2)+255
<br>320    y2=r*COS(phi+PI/2)+127
<br>330    DRAW x1,y1 TO x2,y2 ,col
<br>340    r_old=r: phi_old=phi
<br>350    x1=x2: y1=y2
<br>360  END REPeat Drawing
<br>370 END DEFine POLAR_DRAW
<br></span><br><span style="font-style: italic;">POLAR 0,0 TO 100,8*PI ,7</span> draws an archimedic spiral and these few
<br><br>lines create a polar pattern:
<br><span style="font-style: italic;">10 SCLR 0
<br>20 FOR a=0 TO 50 STEP 10
<br>30   POLAR_DRAW a,0 TO a,2*PI ,7
<br>40   POLAR_DRAW 0,PI*a/25 TO 50,PI*a/25 ,7
<br>50 END FOR a
<br>60 REFRESH
<br></span><br><h3>
<br></h3><br><h3>NOTE:
<br></h3><br><span style="font-style: italic;">DRAW</span> is specific to the resolution of 512x256 pixels. It can
<br>however be used to draw on Minerva's second screen by using
<br>the command <span style="font-style: italic;">SCRBASE SCREEN(#3)</span> (assuming that #3 is open on the
<br>second screen).
<br><br><h3>CROSS-REFERENCE:<br></h3><br><a style="font-style: italic;" href="KeywordsP.html#PLOT">PLOT</a> plots a pixel, <a style="font-style: italic;" href="KeywordsS.html#SCLR">SCLR</a> clears the screen and <a style="font-style: italic;" href="KeywordsR.html#REFRESH">REFRESH</a> makes the
<br>screen pointed to by <a style="font-style: italic;" href="KeywordsS.html#SCRBASE">SCRBASE</a> visible.
<br><br>See also <a style="font-style: italic;" href="KeywordsD.html#DOTLIN">DOTLIN</a> and the other variant of <a style="font-style: italic;" href="KeywordsD.html#DRAW">DRAW</a>.
<br><hr style="width: 100%; height: 2px;"><h1><a name="DRAW"></a>DRAW</h1><br>Syntax: <span style="font-style: italic;">DRAW </span>[<span style="font-style: italic;">#ch,</span>]<span style="font-style: italic;"> x2,y2
<br></span>Location: <span style="font-style: italic;">DRAW (DIY Toolkit - Vol G)
<br></span><br>This command draws a line in absolute co-ordinates on the
<br>screen with reference to the specified window channel (if any
<br>- default #1).
<br><br>The line is drawn from the last point plotted with the <span style="font-style: italic;">PLOT
<br></span>command from the same toolkit, to the point specified by
<br><span style="font-style: italic;">x2,y2</span>.
<br><br>This is quicker than using the SuperBASIC <span style="font-style: italic;">LINE</span> command and
<br>unlike other similar commands, it will support the current <span style="font-style: italic;">INK
<br></span>colour and <span style="font-style: italic;">OVER</span> mode.  &lt;CTRL&gt;&lt;F5&gt; will pause the line drawing
<br>and it will even work in <span style="font-style: italic;">MODE 4</span>, <span style="font-style: italic;">8</span> and <span style="font-style: italic;">12</span> (on the THOR XVI,
<br>provided that you have v1.6+).
<br><br>The main limitation on this command is that the line must
<br>appear fully within the specified window, so <span style="font-style: italic;">x2</span> and <span style="font-style: italic;">y2</span> cannot
<br>exceed the width or height of the specified window (in pixels)
<br>nor be less than zero.
<br><br><h3>NOTE:
<br></h3><br>Although<span style="font-style: italic;"> DRAW</span> will work wherever the screen base is located,
<br>it assumes that a line of pixels takes 128 bytes - it will not
<br>therefore currently work on higher resolutions.
<br><br><h3>CROSS-REFERENCE:<br></h3><br>See the other variant of<a style="font-style: italic;" href="KeywordsD.html#DRAW">DRAW</a>.
<br><br>See also <a style="font-style: italic;" href="KeywordsP.html#PLOT">PLOT</a>.
<br><br><a style="font-style: italic;" href="KeywordsL.html#LINE">LINE</a> is much more flexible.
<br><hr style="width: 100%; height: 2px;"><h1><a name="DROUND"></a>DROUND</h1><br>Syntax: <span style="font-style: italic;">DROUND (d, x)
<br></span>Location: <span style="font-style: italic;">TRIPRODRO
<br></span><br>The function <span style="font-style: italic;">DROUND</span> will return the floating point number <span style="font-style: italic;">x
<br></span>rounded to <span style="font-style: italic;">d</span> decimal digits, counted from the left of the
<br>number.  <span style="font-style: italic;">DROUND</span> rounds the last digit up or down depending on
<br>the next digit (ignoring any others).
<br><br><h3>Example:
<br></h3><span style="font-style: italic;">DROUND(3, 1234.56) = 1230
<br>DROUND(4, 1234.56) = 1235
<br></span><br><h3>CROSS-REFERENCE:<br></h3><br><a style="font-style: italic;" href="KeywordsP.html#PROUND">PROUND</a> rounds to a given precision.
<br><hr style="width: 100%; height: 2px;"><h1><a name="DUP"></a>DUP</h1><br>Syntax: <span style="font-style: italic;">DUP
<br></span>Location: <span style="font-style: italic;">Toolkit II
<br></span><br>This command strips off the last part of the default data
<br>device, thus moving up the directory tree. If the default
<br>program device is the same as the default data device, then
<br>this will also be altered by <span style="font-style: italic;">DUP</span>.  If the default destination
<br>device  is  a  directory  device  (ie.  if  it  ends  with  an
<br>underscore), <span style="font-style: italic;">DUP</span> also alters this (whether or not it points to
<br>another drive).
<br><br>win1_
<br><br>|
<br><br>+--------+-------+
<br><br>|        |        |
<br><br>C    BASIC   Quill
<br><br>|                 |
<br><br>+---+---+       +-----+-----+
<br><br>|        |       |           |
<br><br>include objects letters  translations
<br><br>     |
<br><br>    secret
<br><br>If <span style="font-style: italic;">DATAD$</span> is win1_, <span style="font-style: italic;">DDOWN Quill</span> moves down to win1_Quill_,
<br>whilst <span style="font-style: italic;">DUP</span> will move <span style="font-style: italic;">DATAD$</span> back up to win1_. If <span style="font-style: italic;">DATAD$</span> is
<br>win1_Quill_letters_secret_, three <span style="font-style: italic;">DUP</span>s will change it back to
<br>win1_.
<br><br><h3>NOTE:
<br></h3><br>It is not possible to move beyond the name specifying the
<br>actual device to be used. In the above example, this is the
<br>named root, win1_.
<br><br><h3>CROSS-REFERENCE:<br></h3><br><a style="font-style: italic;" href="KeywordsD.html#DATA_USE">DATA_USE</a> allows you to set the absolute directory root, <a style="font-style: italic;" href="KeywordsD.html#DDOWN">DDOWN
</a>goes down the tree, and <a style="font-style: italic;" href="KeywordsD.html#DNEXT">DNEXT</a> skips from branch to branch.
<br><br><a style="font-style: italic;" href="KeywordsD.html#DATAD$">DATAD$</a> returns the current default data device ie. the device
<br>name plus the current sub-directory.
<br></div>
</body>
</html>
